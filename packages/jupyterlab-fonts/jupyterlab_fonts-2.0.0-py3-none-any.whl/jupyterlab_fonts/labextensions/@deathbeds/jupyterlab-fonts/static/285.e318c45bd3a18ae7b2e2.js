"use strict";(self.webpackChunk_deathbeds_jupyterlab_fonts=self.webpackChunk_deathbeds_jupyterlab_fonts||[]).push([[285,396],{602:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(609),s=n.n(o)()((function(e){return e[1]}));s.push([e.id,".jp-FontsEditor {\n  color: var(--jp-ui-font-color0);\n  overflow-y: auto;\n  background-color: var(--jp-layout-color1);\n}\n\n.jp-FontsEditor-button.jp-mod-styled {\n  font-size: var(--jp-ui-font-size1);\n  background-color: var(--jp-layout-color0);\n  border: solid 1px transparent;\n  white-space: nowrap;\n  flex: 0;\n}\n\n.jp-FontsEditor .lm-CommandPalette-header {\n  margin: 0;\n}\n\n.jp-FontsEditor-enable label {\n  margin: calc(var(--jp-ui-font-size1) / 2) 0 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size1);\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.jp-FontsEditor-button.jp-mod-styled:focus,\n.jp-FontsEditor-button.jp-mod-styled:hover {\n  border-color: var(--jp-border-color1);\n}\n\n.jp-FontsEditor h2 {\n  padding: var(--jp-ui-font-size1);\n  margin: 0;\n  display: flex;\n}\n\n.jp-FontsEditor h2 > label {\n  flex: 1;\n}\n\n.jp-FontsEditor-delete-icon.jp-FontsEditor-button.jp-mod-styled {\n  background-repeat: no-repeat;\n  background-position: center;\n  color: transparent;\n}\n\n.jp-FontsEditor h2 .jp-NotebookIcon {\n  width: var(--jp-ui-font-size2);\n  height: calc(var(--jp-ui-font-size2));\n  display: inline-block;\n  vertical-align: middle;\n  background-repeat: no-repeat;\n}\n\n.jp-FontsEditor-embed {\n  padding: 0;\n  margin: 0;\n}\n\n.jp-FontsEditor-embed li {\n  display: flex;\n  flex-direction: row;\n  list-style: none;\n  align-items: baseline;\n  justify-content: space-between;\n  margin: 0 var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > * {\n  flex: 1;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-embed li > .jp-FontsEditor-size {\n  flex: 0;\n  padding: 0 var(--jp-ui-font-size1);\n  font-size: var(--jp-ui-font-size0);\n  color: var(--jp-ui-font-color2);\n  white-space: nowrap;\n}\n\n.jp-FontsEditor-field {\n  display: flex;\n  margin: 0 var(--jp-ui-font-size1);\n  align-items: baseline;\n}\n\n.jp-FontsEditor-field label {\n  white-space: nowrap;\n  flex: 0;\n  font-size: var(--jp-ui-font-size1);\n  padding-right: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field > div {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  align-items: baseline;\n}\n.jp-FontsEditor-field > div * {\n  display: block;\n  flex: 1;\n  text-align: right;\n  font-size: var(--jp-ui-font-size1);\n}\n\n.jp-FontsEditor-field select {\n  font-weight: bold;\n  border: none;\n  background: transparent;\n  background-image: var(--jp-ui-select-caret);\n  background-repeat: no-repeat;\n  background-position: 99% center;\n  background-size: 18px;\n  text-align: right;\n  text-align-last: right;\n  margin-left: var(--jp-notebook-padding);\n  padding-right: calc(2 * var(--jp-notebook-padding));\n}\n\n.jp-FontsEditor option {\n  text-align: right;\n}\n",""]);const i=s},599:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(609),s=n.n(o)()((function(e){return e[1]}));s.push([e.id,"",""]);const i=s},432:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(609),s=n.n(o)()((function(e){return e[1]}));s.push([e.id,".jp-LicenseViewer-wrapper {\n  display: flex;\n  flex-direction: column;\n}\n\n.jp-LicenseViewer {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  padding: var(--jp-notebook-padding);\n  color: var(--jp-ui-font-color0);\n  height: 100%;\n}\n\n.jp-LicenseViewer h1,\n.jp-LicenseViewer h2 {\n  flex: 0;\n  margin: var(--jp-notebook-padding) 0;\n}\n\n.jp-LicenseViewer h2 {\n  color: var(--jp-ui-font-color1);\n}\n\n.jp-LicenseViewer pre {\n  flex: 1;\n  overflow-y: auto;\n  font-size: 80%;\n}\n",""]);const i=s},609:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(o)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(s[a]=!0)}for(var l=0;l<e.length;l++){var r=[].concat(e[l]);o&&s[r[0]]||(n&&(r[2]?r[2]="".concat(n," and ").concat(r[2]):r[2]=n),t.push(r))}},t}},62:(e,t,n)=>{var o,s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function a(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},o=[],s=0;s<e.length;s++){var l=e[s],r=t.base?l[0]+t.base:l[0],d=n[r]||0,c="".concat(r," ").concat(d);n[r]=d+1;var h=a(c),f={css:l[1],media:l[2],sourceMap:l[3]};-1!==h?(i[h].references++,i[h].updater(f)):i.push({identifier:c,updater:p(f,t),references:1}),o.push(c)}return o}function r(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var i=n.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var a=s(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var d,c=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function h(e,t,n,o){var s=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=c(t,s);else{var i=document.createTextNode(s),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function f(e,t,n){var o=n.css,s=n.media,i=n.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var m=null,u=0;function p(e,t){var n,o,s;if(t.singleton){var i=u++;n=m||(m=r(t)),o=h.bind(null,n,i,!1),s=h.bind(null,n,i,!0)}else n=r(t),o=f.bind(null,n,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var s=a(n[o]);i[s].references--}for(var r=l(e,t),d=0;d<n.length;d++){var c=a(n[d]);0===i[c].references&&(i[c].updater(),i.splice(c,1))}n=r}}}},396:(e,t,n)=>{n.r(t),n.d(t,{CMD:()=>h,CONFIGURED_CLASS:()=>y,CSS:()=>m,DEFAULT:()=>g,FONT_FORMATS:()=>c,FontFormat:()=>d,IFontManager:()=>k,KIND_LABELS:()=>r,PACKAGE_NAME:()=>b,ROOT:()=>f,TEXT_LABELS:()=>p,TEXT_OPTIONS:()=>u,TextKind:()=>o});var o,s=n(797),i=n(62),a=n.n(i),l=n(599);a()(l.Z,{insert:"head",singleton:!1}),l.Z.locals,function(e){e.code="code",e.content="content"}(o||(o={}));const r={code:"Code",content:"Content"};var d;!function(e){e.woff2="woff2",e.woff="woff"}(d||(d={}));const c={woff2:"font/woff2",woff:"font/woff"},h={code:{fontSize:"code-font-size",fontFamily:"code-font-family",lineHeight:"code-line-height"},content:{fontSize:"content-font-size",fontFamily:"content-font-family",lineHeight:"content-line-height"},editFonts:"font-editor:open",customFonts:{disable:"custom-fonts:disable",enable:"custom-fonts:enable"}},f=":root",m={code:{"font-family":"--jp-code-font-family","font-size":"--jp-code-font-size","line-height":"--jp-code-line-height"},content:{"font-family":"--jp-content-font-family","font-size":"--jp-content-font-size1","line-height":"--jp-content-line-height"}},u={"font-size":e=>Array.from(Array(25).keys()).map((e=>`${e+8}px`)),"line-height":e=>Array.from(Array(8).keys()).map((e=>""+(.25*e+1))),"font-family":e=>{let t=Array.from(e.fonts.values()).reduce(((e,t)=>e.concat(t.name)),[]);return t.sort(((e,t)=>e.localeCompare(t))),t}},p={"font-size":"Size","line-height":"Line Height","font-family":"Font"},g={code:{fontSize:"13px",lineHeight:"1",fontFamily:'"Source Code Pro", monospace'}},b="@deathbeds/jupyterlab-fonts",y="jp-fonts-configured",k=new s.Token("@deathbeds/jupyterlab-fonts:IFontManager")},285:(e,t,n)=>{n.r(t),n.d(t,{default:()=>L});var o=n(67),s=n(110),i=n(552),a=n(216),l=n(396),r=n(596);const d={fonts:new r.LabIcon({name:"fonts:fonts",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" baseProfile="tiny" width="24" height="24" viewBox="0 0 24 24">\n  <g class="jp-icon3" fill="#616161">\n    <rect x="1" y="1" width="22" height="22" rx="2" ry="2"/>\n  </g>\n  <g class="jp-icon-accent0 jp-icon-selectable" fill="#fff">\n    <text text-anchor="middle" x="12px" font-family="sans-serif" alignment-baseline="middle" y="17px">Aa</text>\n  </g>\n</svg>\n'}),license:new r.LabIcon({name:"fonts:license",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <defs>\n    <path id="a" d="M24 0v24H0V0h24z" />\n  </defs>\n  <clipPath id="b">\n    <use xlink:href="#a" overflow="visible" />\n  </clipPath>\n  <g class="jp-icon3" fill="#616161">\n    <circle cx="12" cy="12" r="10" fill="rgba(255,255,255,0.5)"></circle>\n  </g>\n  <g class="jp-icon-accent0 jp-icon-selectable" fill="#fff">\n    <path d="M10.08 10.86c.05-.33.16-.62.3-.87s.34-.46.59-.62c.24-.15.54-.22.91-.23.23.01.44.05.63.13.2.09.38.21.52.36s.25.33.34.53.13.42.14.64h1.79c-.02-.47-.11-.9-.28-1.29s-.4-.73-.7-1.01-.66-.5-1.08-.66-.88-.23-1.39-.23c-.65 0-1.22.11-1.7.34s-.88.53-1.2.92-.56.84-.71 1.36S8 11.29 8 11.87v.27c0 .58.08 1.12.23 1.64s.39.97.71 1.35.72.69 1.2.91 1.05.34 1.7.34c.47 0 .91-.08 1.32-.23s.77-.36 1.08-.63.56-.58.74-.94.29-.74.3-1.15h-1.79c-.01.21-.06.4-.15.58s-.21.33-.36.46-.32.23-.52.3c-.19.07-.39.09-.6.1-.36-.01-.66-.08-.89-.23-.25-.16-.45-.37-.59-.62s-.25-.55-.3-.88-.08-.67-.08-1v-.27c0-.35.03-.68.08-1.01zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" clip-path="url(#b)" />\n  </g>\n</svg>\n'})};var c=n(797),h=n(168),f=n(706),m=n(76),u=n(108),p=n.n(u);class g{constructor(){this.fonts=new Map,this._notebookStyles=new Map,this._jss=m.create(p()()),this._fontCache=new Map,this._cacheUpdated=new h.Signal(this),this._globalStyles=document.createElement("style")}get cacheUpdated(){return this._cacheUpdated}registerNotebook(e,t){t?(this._notebookStyles.set(e,document.createElement("style")),e.disposed.connect(this._onDisposed,this),this.hack()):this._onDisposed(e)}_onDisposed(e){var t;this._notebookStyles.has(e)&&(null===(t=this._notebookStyles.get(e))||void 0===t||t.remove(),this._notebookStyles.delete(e),e.disposed.disconnect(this._onDisposed,this))}get stylesheets(){return[this._globalStyles,...Array.from(this._notebookStyles.values())]}notebooks(){return Array.from(this._notebookStyles.keys())}stylesheet(e,t,n=!1){let o=t?this._notebookStyles.get(t):this._globalStyles,s=t?this._nbMetaToStyle(e,t):this._settingsToStyle(e),i=this._jss.createStyleSheet(s).toString();o&&o.textContent!==i&&(o.textContent=i),this.hack()}_nbMetaToStyle(e,t){const n=t.id;let o={"@font-face":[],"@global":{}},s=o["@global"][`.jp-NotebookPanel[id='${n}']`]={};if(e.fonts)for(let t in e.fonts)o["@font-face"]=o["@font-face"].concat(e.fonts[t]);let i=e.styles||{};for(let e in i)if(e===l.ROOT)for(let t in i[e])null!=i&&null!=i[e]&&(s[t]=i[e][t]);else"object"==typeof i[e]?s[`& ${e}`]=i[e]:s[e]=i[e];return o}_settingsToStyle(e){let t=JSON.stringify(e.styles),n=JSON.parse(t),o={};for(let e of Array.from(this.fonts.keys()))if(t.indexOf(`'${e}'`)>-1&&!o[e]){const t=this._fontCache.get(e);null!=t?o[e]=t:new Promise(((t,n)=>{const o=this.fonts.get(e);null!=o?o.faces().then((n=>{this._fontCache.has(e)||(this._fontCache.set(e,n),this._cacheUpdated.emit(void 0),t(void 0))})).catch(n):n()})).catch(console.warn)}return{"@global":n,"@font-face":Object.keys(o).reduce(((e,t)=>{const n=o[t];if(o&&null!=n)return e.concat(n)}),[])}}dispose(){this._globalStyles.remove();for(let e of Array.from(this._notebookStyles.keys()))this._onDisposed(e)}hack(e=!0){e?setTimeout((()=>this.stylesheets.map((e=>{document.body.appendChild(e)}))),0):this.stylesheets.map((e=>e.remove()))}}const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const y={code:"Fonts (Code)",content:"Fonts (Content)"};class k{constructor(e,t,n){this.licensePaneRequested=new h.Signal(this),this._fontFamilyMenus=new Map,this._fontSizeMenus=new Map,this._lineHeightMenus=new Map,this._ready=new c.PromiseDelegate,this._stylist=new g,this._stylist.cacheUpdated.connect(this.settingsUpdate,this),this._commands=e,this._palette=t,this._notebooks=n,this._notebooks.currentChanged.connect(this._onNotebooksChanged,this),this.makeMenus(e),this.makeCommands(),this.hack()}get ready(){return this._ready.promise}get fonts(){return this._stylist.fonts}get enabled(){return!!this.settings&&!!this._settings.get("enabled").composite}set enabled(e){this.settings&&this._settings.set("enabled",e).then().catch(console.warn)}get menu(){return this._menu}get stylesheets(){return this._stylist.stylesheets}get settings(){return this._settings}set settings(e){this._settings&&this._settings.changed.disconnect(this.settingsUpdate,this),this._settings=e,e&&e.changed.connect(this.settingsUpdate,this),this.settingsUpdate()}async dataURISrc(e,t=l.FontFormat.woff2){return await async function(e,t=l.FontFormat.woff2){return`url('data:${l.FONT_FORMATS[t]};charset=utf-8;base64,${function(e){let t,n,o,s="",i=0,a=e.length;for(;i<a;){if(t=255&e.charCodeAt(i++),i===a){s+=b.charAt(t>>2),s+=b.charAt((3&t)<<4),s+="==";break}if(n=e.charCodeAt(i++),i===a){s+=b.charAt(t>>2),s+=b.charAt((3&t)<<4|(240&n)>>4),s+=b.charAt((15&n)<<2),s+="=";break}o=e.charCodeAt(i++),s+=b.charAt(t>>2),s+=b.charAt((3&t)<<4|(240&n)>>4),s+=b.charAt((15&n)<<2|(192&o)>>6),s+=b.charAt(63&o)}return s}(await function(e){return new Promise(((t,n)=>{const o=new XMLHttpRequest;o.open("GET",e,!0),o.overrideMimeType("text/plain; charset=x-user-defined"),o.onreadystatechange=()=>{4===o.readyState&&200===o.status&&t(o.responseText)},o.send()}))}(e))}') format('${t}')`}(e,t)}registerFontFace(e){this._stylist.fonts.set(e.name,e),this.registerFontCommands(e)}getVarName(e,{kind:t}){return null==t?null:l.CSS[t][e]}getTextStyle(e,{kind:t,notebook:n}){if(!n&&!this.settings)return null;try{const o=(null==n?void 0:n.model)?n.model.metadata.get(l.PACKAGE_NAME).styles:this._settings.get("styles").composite;let s=this.getVarName(e,{kind:t});if(null!=o){const e=o[l.ROOT];return null==e?null:e[s]}}catch(e){}return null}async setTextStyle(e,t,{kind:n,notebook:o}){var s,i;if(!o&&!this.settings)return;let a;const r=null==o?void 0:o.model;try{a=r?r.metadata.get(l.PACKAGE_NAME).styles:this._settings.get("styles").user}catch(e){a={}}let d=JSON.parse(JSON.stringify(a||{})),c=d[l.ROOT]=d[l.ROOT]?d[l.ROOT]:{},h=this.getVarName(e,{kind:n});if(c&&(null==t?delete c[h]:c[h]=t),o){let n=(null===(s=o.model)||void 0===s?void 0:s.metadata.get(l.PACKAGE_NAME))||{};switch(n=JSON.parse(JSON.stringify(n)),n.styles=d,e){case"font-family":null!=t&&await this.embedFont(t,n)}this.cleanMetadata(n),null===(i=o.model)||void 0===i||i.metadata.set(l.PACKAGE_NAME,n)}else{Object.keys(d[l.ROOT]||{}).length||delete d[l.ROOT];try{await this._settings.set("styles",d)}catch(e){console.warn(e)}}}cleanMetadata(e){const t=JSON.stringify(e.styles,null,2),n=Object.keys(e.fonts||{});for(let o of n){let n=`'${o}'`;-1===t.indexOf(n)&&(e.fonts&&delete e.fonts[o],e.fontLicenses&&delete e.fontLicenses[o])}}async embedFont(e,t){if(null==e)return;const n=e.replace(/(['"]?)(.*)\1/,"$2"),o=this._stylist.fonts.get(n);if(o)try{const e=await o.faces(),s=t.fonts||{},i=t.fontLicenses||{};s[n]=e,i[n]={spdx:o.license.spdx,name:o.license.name,text:await o.license.text(),holders:o.license.holders},t.fonts=s,t.fontLicenses=i}catch(e){console.warn("error embedding font"),console.warn(e)}}_onNotebooksChanged(){let e=this._stylist.notebooks();this._notebooks.forEach((t=>{-1===e.indexOf(t)&&this._registerNotebook(t)}))}_registerNotebook(e){this._stylist.registerNotebook(e,!0);let t=this._notebookMetaWatcher(e);(null==e?void 0:e.model)&&e.model.metadata.changed.connect(t),e.disposed.connect(this._onNotebookDisposed),t(),this.hack()}_onNotebookDisposed(e){this._stylist.registerNotebook(e,!1)}_notebookMetaWatcher(e){return()=>{this._notebooks.forEach((e=>{if(e.id!=e.id||!e.model)return;const t=e.model.metadata.get(l.PACKAGE_NAME);t&&this._stylist.stylesheet(t,e)}))}}fontSizeOptions(){return Array.from(Array(25).keys()).map((e=>`${e+8}px`))}fontSizeCommands(e){return this.fontSizeOptions().map((t=>`${e}:${t}`))}makeCommands(){[l.TextKind.code,l.TextKind.content].map((e=>{["Increase","Decrease"].map(((t,n)=>{var o;let s=`${l.CMD[e].fontSize}:${t.toLowerCase()}`;this._commands.addCommand(s,{label:`${t} Code Font Size`,execute:async()=>{let t=this.getTextStyle("font-size",{kind:e}),o=parseInt((t||"0").replace(/px$/,""),10)||13;try{await this.setTextStyle("font-size",`${o+(n?-1:1)}px`,{kind:e})}catch(e){console.warn(e)}},isVisible:()=>this.enabled}),null===(o=this._fontSizeMenus.get(e))||void 0===o||o.addItem({command:s}),this._palette.addItem({command:s,category:y[e],rank:0})})),["line-height","font-size","font-family"].forEach((t=>{const n=`${e}-${t}:-reset`;this._commands.addCommand(n,{label:`Default ${e[0].toUpperCase()}${e.slice(1)} ${l.TEXT_LABELS[t]}`,execute:()=>this.setTextStyle(t,null,{kind:e}),isVisible:()=>this.enabled,isToggled:()=>null==this.getTextStyle(t,{kind:e})})})),l.TEXT_OPTIONS["line-height"](this).map((t=>{var n;const o=`${l.CMD[e].lineHeight}:${t}`;this._commands.addCommand(o,{label:`${t}`,isToggled:()=>this.getTextStyle("line-height",{kind:e})===t,isVisible:()=>this.enabled,execute:()=>this.setTextStyle("line-height",t,{kind:e})}),null===(n=this._lineHeightMenus.get(e))||void 0===n||n.addItem({command:o})})),l.TEXT_OPTIONS["font-size"](this).map((t=>{var n;const o=`${l.CMD[e].fontSize}:${t}`;this._commands.addCommand(o,{label:`${t}`,isToggled:()=>this.getTextStyle("font-size",{kind:e})===t,isVisible:()=>this.enabled,execute:()=>this.setTextStyle("font-size",t,{kind:e})}),null===(n=this._fontSizeMenus.get(e))||void 0===n||n.addItem({command:o})}))})),["Enable","Disable"].map(((e,t)=>{const n=`custom-fonts:${e.toLowerCase()}`;this._commands.addCommand(n,{label:`${e} Custom Fonts`,isVisible:()=>this.enabled===!!t,execute:async()=>{if(this._settings)try{await this._settings.set("enabled",!t)}catch(e){console.warn(e)}}}),this._palette.addItem({command:n,category:"Fonts"})}))}fontPropMenu(e,t,n){let o=new f.Menu({commands:e.commands});return o.title.label=l.TEXT_LABELS[n],o.addItem({command:`${t}-${n}:-reset`}),o.addItem({type:"separator"}),e.addItem({type:"submenu",submenu:o}),o}makeMenus(e){this._menu=new f.Menu({commands:e}),this._menu.title.label="Fonts",[l.TextKind.code,l.TextKind.content].map((t=>{const n=new f.Menu({commands:e});n.title.label=t[0].toUpperCase()+t.slice(1),this._menu.addItem({type:"submenu",submenu:n});const o=this.fontPropMenu(n,t,"font-family"),s=this.fontPropMenu(n,t,"line-height"),i=this.fontPropMenu(n,t,"font-size");this._fontFamilyMenus.set(t,o),this._lineHeightMenus.set(t,s),this._fontSizeMenus.set(t,i)})),this._menu.addItem({command:l.CMD.editFonts,args:{global:!0}}),this._menu.addItem({command:l.CMD.customFonts.enable}),this._menu.addItem({command:l.CMD.customFonts.disable})}settingsUpdate(){let e={styles:this._settings.get("styles").composite};this.enabled?this._stylist.stylesheet(e,void 0,!0):this._stylist.hack(!1)}registerFontCommands(e){[l.TextKind.code,l.TextKind.content].forEach((t=>{var n;const o=e.name.replace(/[^a-z\d]/gi,"-").toLowerCase();let s=`${l.CMD[t].fontFamily}:${o}`;this._commands.addCommand(s,{label:e.name,isToggled:()=>`${this.getTextStyle("font-family",{kind:t})}`.indexOf(`'${e.name}'`)>-1,isVisible:()=>this.enabled,execute:async()=>{try{await this.setTextStyle("font-family",`'${e.name}'`,{kind:t})}catch(e){console.warn(e)}}}),null===(n=this._fontFamilyMenus.get(t))||void 0===n||n.addItem({command:s}),this._palette.addItem({command:s,category:y[t]})}))}requestLicensePane(e){this.licensePaneRequested.emit(e)}hack(){this._stylist.hack(),this._ready.resolve(void 0)}}var v=n(129);class _{constructor(){this.widgetRequested=new h.Signal(this)}createNew(e,t){let n=new s.ToolbarButton({icon:d.fonts,onClick:()=>{this.widgetRequested.emit(void 0)},tooltip:"Customize Notebook Fonts"});const o=e=>{e.get(l.PACKAGE_NAME)?n.addClass(l.CONFIGURED_CLASS):n.removeClass(l.CONFIGURED_CLASS)};return e.model&&(e.model.metadata.changed.connect(o),o(e.model.metadata)),e.toolbar.insertItem(9,"fonts",n),new v.DisposableDelegate((()=>{n.dispose()}))}}var x=n(271),w=n(62),C=n.n(w),S=n(602);C()(S.Z,{insert:"head",singleton:!1}),S.Z.locals;const j=x.createElement,E="lm-CommandPalette-header",T="jp-FontsEditor-button jp-mod-styled",F="-";class M extends s.VDomModel{get fonts(){return this._fonts}set fonts(e){this._fonts&&this._fonts.settings&&this._fonts.settings.changed.disconnect(this.onSettingsChange,this),this._fonts=e,e.settings.changed.connect(this.onSettingsChange,this),this.stateChanged.emit(void 0)}onSettingsChange(){this.stateChanged.emit(void 0)}get notebook(){return this._notebook}set notebook(e){var t,n;(null===(t=this._notebook)||void 0===t?void 0:t.model)&&(this._notebook.model.metadata.changed.disconnect(this.onSettingsChange,this),this._notebook.context.pathChanged.disconnect(this.onSettingsChange,this)),this._notebook=e,(null===(n=this._notebook)||void 0===n?void 0:n.model)&&(this._notebook.model.metadata.changed.connect(this.onSettingsChange,this),this._notebook.context.pathChanged.connect(this.onSettingsChange,this)),this.stateChanged.emit(void 0)}get enabled(){return this._fonts.enabled}async setEnabled(e){null==this.notebook&&(await this._fonts.settings.set("enabled",e),this.stateChanged.emit(void 0))}get notebookMetadata(){var e;if(null===(e=this.notebook)||void 0===e?void 0:e.model)return this.notebook.model.metadata.get(l.PACKAGE_NAME)}clearNotebookMetadata(e){var t;let n=this.notebookMetadata;e&&((null==n?void 0:n.fonts)&&delete n.fonts[e],(null==n?void 0:n.fontLicenses)&&delete n.fontLicenses[e]),(null===(t=this.notebook)||void 0===t?void 0:t.model)&&this.notebook.model.metadata.set(l.PACKAGE_NAME,JSON.parse(JSON.stringify(n))),this.stateChanged.emit(void 0)}dispose(){this._fonts&&this._fonts.settings&&this._fonts.settings.changed.disconnect(this.onSettingsChange,this),super.dispose()}}class A extends s.VDomRenderer{constructor(){super(new M),this.addClass("jp-FontsEditor")}render(){return this.model?j("div",{key:"editor"},[...this.header(),...[l.TextKind.code,l.TextKind.content].map((e=>j("section",{key:`${e}-section`,title:l.KIND_LABELS[e]},[j("h3",{key:`${e}-header`,className:E},l.KIND_LABELS[e]),...["font-family","font-size","line-height"].map((t=>this.textSelect(t,e,{key:`${e}-${t}`})))])))]):j("div",{key:"empty"})}fontFaceExtras(e,t){let n,o=`${t}`.slice(1,-1);return e.fonts.fonts.get(o)&&(n=e.fonts.fonts.get(o)),n?[this.licenseButton(e,n)]:[]}licenseButton(e,t){return j("button",{className:T,title:t.license.name,key:t.name,onClick:()=>e.fonts.requestLicensePane(t)},t.license.spdx)}textSelect(e,t,n){const o=this.model,s=o.fonts.getTextStyle(e,{kind:t,notebook:o.notebook||void 0}),i="font-family"===e?this.fontFaceExtras(o,s):[];return j("div",Object.assign({className:"jp-FontsEditor-field",key:"select-field"},n),[j("label",{key:"select-label"},l.TEXT_LABELS[e]),j("div",{key:"select-wrap"},[...i,j("select",{className:"jp-mod-styled",title:`${l.TEXT_LABELS[e]}`,onChange:n=>{let s=n.target.value;s=s===F?null:s,o.fonts.setTextStyle(e,s,Object.assign({kind:t},o.notebook?{notebook:o.notebook}:{})).catch(console.warn)},defaultValue:s||F,key:"select"},[null,...l.TEXT_OPTIONS[e](o.fonts)].map((t=>j("option",{key:`'${t}'`,value:null==t?F:"font-family"===e?`'${t}'`:t},t||F))))])])}deleteButton(e,t){return j("button",{className:T,title:"Delete Embedded Font",key:"delete",onClick:async()=>{(await(0,s.showDialog)({title:"Delete Embedded Font from Notebook",body:`If you dont have ${t} installed, you might not be able to re-embed it`,buttons:[s.Dialog.cancelButton(),s.Dialog.warnButton({label:"DELETE"})]})).button.accept&&e.clearNotebookMetadata(t)}},"Delete")}enabler(e){return j("label",{key:"enable-label"},j("span",{key:"enable-text"},"Enabled"),j("input",{key:"enable-input",type:"checkbox",checked:e.enabled,onChange:async t=>{await e.setEnabled(!!t.currentTarget.checked)}}))}embeddedFont(e,t){var n;if(null==(null===(n=e.notebookMetadata)||void 0===n?void 0:n.fonts)||null==e.notebookMetadata.fontLicenses)return null;const o=e.notebookMetadata.fonts[t],s=e.notebookMetadata.fontLicenses[t],i=(o||[]).reduce(((e,t)=>e+`${t.src}`.length),s.text.length),a=parseInt(""+i/1024,10);return j("li",{key:t},[j("label",{key:"label"},t),this.licenseButton(e,{name:t,license:{name:s.name,spdx:s.spdx,text:async()=>s.text,holders:s.holders},faces:async()=>o||[]}),j("span",{className:"jp-FontsEditor-size",key:"font-kb"},`${a} kb`),this.deleteButton(e,t)])}header(){var e;const t=this.model,n=t.notebook?null===(e=t.notebook.context.contentsModel)||void 0===e?void 0:e.name.replace(/.ipynb$/,""):"Global";this.title.label=n||"Unknown";const o=j("h2",{key:"scope-head"},[j("label",{key:"scope-label"},`Fonts Â» ${n}`),...t.notebook?[j("div",{className:"jp-NotebookIcon",key:"scope-icon"})]:[]]);return null!=t.notebook?[o,j("section",{key:"embed-section"},[j("h3",{className:E,key:"embed-head"},"Embedded fonts"),j("ul",{className:"jp-FontsEditor-embed",key:"embeds"},Object.keys((t.notebookMetadata||{}).fonts||{}).map((e=>this.embeddedFont(t,e))))])]:[o,j("section",{key:"enable-section",className:"jp-FontsEditor-enable"},[j("h3",{className:E,key:"enable-header"},"Enable/Disable All Fonts"),this.enabler(t)])]}}var N=n(432);C()(N.Z,{insert:"head",singleton:!1}),N.Z.locals;class z extends s.VDomRenderer{constructor(e){super(new z.Model(e))}render(){this.addClass("jp-LicenseViewer-wrapper");let e=this.model;if(!e)return x.createElement(x.Fragment,null);const t=e.licenseText?x.createElement("pre",null,e.licenseText):x.createElement(x.Fragment,null);return x.createElement("div",{className:"jp-LicenseViewer"},x.createElement("h1",null,e.font.name),x.createElement("h2",null,e.font.license.name),t)}}!function(e){class t extends s.VDomModel{constructor(e){super(),this.font=e.font}get font(){return this._font}set font(e){this._font=e,this.stateChanged.emit(void 0),this._licenseTextPromise=new Promise(((e,t)=>{this._font.license.text().then((t=>{this._licenseText=t,this.stateChanged.emit(void 0),e(this._licenseText)})).catch((e=>{t(e)}))}))}get licenseText(){return this._licenseText}get licenseTextPromise(){return this._licenseTextPromise}}e.Model=t}(z||(z={}));const O=`${l.PACKAGE_NAME}:fonts`;let $=0;const L={id:O,autoStart:!0,requires:[o.IMainMenu,a.ISettingRegistry,s.ICommandPalette,i.INotebookTracker],provides:l.IFontManager,activate:function(e,t,n,o,s){const i=new k(e.commands,o,s);i.licensePaneRequested.connect(((t,n)=>{let o=new z({font:n});o.id="jp-fonts-license-"+$++,o.title.label=n.name,o.title.closable=!0,o.title.icon=d.license,e.shell.add(o,"main"),e.shell.activateById(o.id)})),t.settingsMenu.addGroup([{type:"submenu",submenu:i.menu}]),e.commands.addCommand(l.CMD.editFonts,{label:"Global Fonts...",execute:t=>{const n=new A,{model:o}=n;if(o.fonts=i,n.title.icon=d.fonts,n.title.closable=!0,(t||{}).global)n.title.label="Global",n.id="font-editor-global";else{const{currentWidget:e}=s;if(null==e)return;o.notebook=e,n.id=`font-editor-${o.notebook.id}`,o.notebook.disposed.connect((()=>n.dispose()))}e.shell.add(n,"main",{mode:"split-right"})}});const a=new _;return a.widgetRequested.connect((async()=>{try{await e.commands.execute(l.CMD.editFonts)}catch(e){console.warn(e)}})),e.docRegistry.addWidgetExtension("Notebook",a),Promise.all([n.load(O),e.restored]).then((async([e])=>{i.settings=e,n.load("@jupyterlab/apputils-extension:themes").then((e=>{e.changed.connect((()=>{setTimeout((()=>i.hack()),100)}))})).catch(console.warn)})).catch((e=>{console.error(e)})),i}}}}]);