Development And Publishing
==========================

Environment Setup
-----------------

conda
~~~~~

To create your environment, run::

    conda env create

To update the environment, run::

    conda env update

pip/virtualenv
~~~~~~~~~~~~~~

Create/activate your virtualenv and then run::

    pip install -r requirements_dev.txt

Formatting, Linting and Testing
-------------------------------

The basics are wrapped with a Makefile::

    make format  # runs black
    make lint  # runs flake8
    make test  # runs pytest

Generating Docs
---------------

Docs for published projects are automatically generated by readthedocs, but
you can also preview them locally by running::

    make build_docs

Then, you can serve them with Python's dev server with::

    make serve_docs

Publishing
----------

Do a Final Check
~~~~~~~~~~~~~~~~

Make sure that formatting looks good and that linting and testing are passing.

Update the Changelog
~~~~~~~~~~~~~~~~~~~~

Update the CHANGELOG.rst file to detail the changes being rolled into the new
version.

Update the Version in setup.py
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This project *used* to use ``vcversioner`` and versioning of the package
would automatically leverage the appropriate git tag, but that is no longer the
case.

I do my best to follow `semver <https://semver.org>` when updating versions.

Add a Git Tag
~~~~~~~~~~~~~

This project uses git tags to tag versions::

    git tag -a {version} -m 'Release {version}'

You don't need to prefix the version with a ``v``.

Build and Publish
~~~~~~~~~~~~~~~~~

To package everything, run::

    make package

To publish::

    make publish

Check on RTD
~~~~~~~~~~~~

RTD should build automatically but can be kicked off manually by logging in.
