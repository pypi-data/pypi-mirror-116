(this.webpackJsonppytest_commander=this.webpackJsonppytest_commander||[]).push([[0],{140:function(e,t,n){"use strict";n.r(t);var s=n(2),a=n.n(s),c=n(72),o=n.n(c),i=n(78),l=n(73),r=n(41),d=n(74),u=n(27),h=n(42),j=n(46),b=n(75),g=n.n(b),v=n(76),f=n.n(v),O=n(21),p=n(4),x=n(3),m="#F3F3F3",T="#D0D0D0",E="25em",L=n(43),R=n.n(L),y=n(141),k=n(142),w=n(10),I=n(11),B=n(1),D=function(e){return R.a.isEmpty(e.childBranches)&&R.a.isEmpty(e.childLeaves)?Object(B.jsx)("div",{className:Object(x.b)(F.navColumn)}):Object(B.jsx)("div",{className:Object(x.b)(F.navColumn),children:Object(B.jsx)(y.a,{children:Object(B.jsx)(N,{childBranches:e.childBranches,childLeaves:e.childLeaves,selection:e.selection,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})})})},N=function(e){var t=Object.keys(e.childBranches).map((function(e){return{shortID:e,branch:!0}})).concat(Object.keys(e.childLeaves).map((function(e){return{shortID:e,branch:!1}}))).sort((function(e,t){return e.shortID.localeCompare(t.shortID)}));return Object(B.jsx)(B.Fragment,{children:t.map((function(t){if(t.branch){var n=e.childBranches[t.shortID];return Object(B.jsx)(C,{node:n,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})}var s=e.childLeaves[t.shortID];return Object(B.jsx)(_,{node:s,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun})}))})},C=function(e){var t="/"+e.selection.concat([e.node.short_id]).map(encodeURIComponent).join("/");return Object(B.jsxs)(k.a,{className:Object(x.b)(U(e.node.status),F.navEntryCommon),children:[Object(B.jsx)("span",{className:Object(x.b)(F.navLabel),children:Object(B.jsx)(O.b,{to:t,children:e.node.short_id})}),Object(B.jsx)(P,{node:e.node,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})]},e.node.short_id)},P=function(e){return"inactive"===e.node.environment_state?Object(B.jsx)(S,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun}):Object(B.jsxs)("span",{className:Object(x.b)(F.buttonsContainer,F.navEntryCommon),children:[Object(B.jsx)(z,{envStatus:e.node.environment_state,handleEnvToggle:e.handleEnvToggle,nodeid:e.node.nodeid}),Object(B.jsx)(S,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun})]})},_=function(e){var t=e.node.short_id,n=t===e.selectedLeafID?t:Object(B.jsx)(O.b,{to:"?selectedLeaf=".concat(encodeURIComponent(t)),children:t});return Object(B.jsxs)(k.a,{className:Object(x.b)(U(e.node.status),F.navEntryCommon),children:[Object(B.jsx)("span",{className:Object(x.b)(F.navLabel),children:n}),Object(B.jsx)(S,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun})]},t)},S=function(e){switch(e.status){case"running":return Object(B.jsx)(w.a,{icon:I.d,className:Object(x.b)(F.inactiveButton),size:"lg",spin:!0});default:return Object(B.jsx)(w.a,{icon:I.c,onClick:function(t){t.stopPropagation(),e.handleTestRun(e.nodeid)},className:Object(x.b)(F.runButton),size:"lg"})}},z=function(e){switch(e.envStatus){case"stopped":return Object(B.jsx)(w.a,{icon:I.f,className:Object(x.b)(F.runButton),onClick:function(t){t.stopPropagation(),e.handleEnvToggle(e.nodeid,!0)},size:"lg"});case"started":return Object(B.jsx)(w.a,{icon:I.g,className:Object(x.b)(F.runButton),onClick:function(t){t.stopPropagation(),e.handleEnvToggle(e.nodeid,!1)},size:"lg"});case"stopping":return Object(B.jsx)(w.a,{icon:I.g,className:Object(x.b)(F.inactiveButton),size:"lg"});default:throw new Error("unexpected environment status "+e.envStatus)}},U=function(e){switch(e){case"passed":return F.navEntryPassed;case"failed":return F.navEntryFailed;default:return F.navEntryDefault}},F=x.a.create({buttonsContainer:{width:"3em"},navColumn:{height:"100%",width:E,position:"fixed","z-index":1,top:0,left:0,"overflow-x":"hidden",padding:"1px",background:m},navLabel:{"text-overflow":"ellipsis","white-space":"nowrap",fontSize:"small","max-width":"80%"},runButton:{cursor:"pointer",color:"black","padding-left":"3px","padding-right":"3px",transition:"color 0.3s ease-out 0s",":hover":{color:m}},inactiveButton:{color:m,"padding-left":"3px","padding-right":"3px"},navEntryPassed:{background:"#c0ffbf"},navEntryFailed:{background:"#ff7a7a"},navEntryDefault:{background:T},navEntryCommon:{display:"flex","justify-content":"space-between","align-items":"center"}}),M=n(143),A=n(144),H=function(e){return e.selectedLeaf?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{children:[Object(B.jsx)("span",{className:Object(x.b)(G.title),children:e.selectedLeaf.nodeid}),Object(B.jsx)("span",{className:Object(x.b)(G.statusIcon),children:$(e.selectedLeaf.status)})]}),Object(B.jsx)("pre",{className:Object(x.b)(G.longrepr),children:e.selectedLeaf.longrepr})]}):Object(B.jsx)(J,{message:"Please select a test."})},J=function(e){return Object(B.jsx)("h1",{className:Object(x.b)(G.message),children:e.message})},$=function(e){switch(e){case"passed":return Object(B.jsx)(w.a,{icon:I.a,color:"green",size:"4x"});case"failed":return Object(B.jsx)(w.a,{icon:I.e,color:"red",size:"4x"});default:return null}},q=function(e){var t=e.selection.length;if(!t)return Object(B.jsx)(M.a,{children:Object(B.jsx)(A.a,{children:Object(B.jsx)(w.a,{icon:I.b})},"home")});var n=e.selection[t-1],s=e.selection.slice(0,t-1);return Object(B.jsxs)(M.a,{children:[Object(B.jsx)(A.a,{children:Object(B.jsx)(O.b,{to:"/",children:Object(B.jsx)(w.a,{icon:I.b})})},"home"),s.map((function(t,n){return Object(B.jsx)(A.a,{children:Object(B.jsx)(O.b,{to:"/"+e.selection.slice(0,n+1).map(encodeURIComponent).join("/"),children:t})},t)})),Object(B.jsx)(A.a,{children:n})]})},G=x.a.create({title:{fontSize:"large","font-weight":"bold","text-overflow":"ellipsis","white-space":"nowrap",padding:"10px"},statusIcon:{float:"right"},longrepr:{padding:"10px"},message:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",minHeight:"80vh",color:T}}),K=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={resultTree:null,loading:!1,socket:null,errorMessage:null},s.handleUpdate=s.handleUpdate.bind(Object(u.a)(s)),s.handleTestRun=s.handleTestRun.bind(Object(u.a)(s)),s.handleEnvToggle=s.handleEnvToggle.bind(Object(u.a)(s)),s}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=f()();this.setState({loading:!0,socket:t},(function(){t.on("update",e.handleUpdate),e.getResultTree(100)}))}},{key:"getResultTree",value:function(e){var t=this;g.a.get("/api/v1/result-tree").then((function(e){t.setState({resultTree:e.data,loading:!1})})).catch((function(n){console.log("API error: "+n),setTimeout((function(){return t.getResultTree(2*e)}),e)}))}},{key:"handleUpdate",value:function(e){console.log("Handling websocket update"),this.setState({resultTree:e})}},{key:"handleTestRun",value:function(e){this.state.socket?this.state.socket.emit("run test",e):console.log("Socket connection not yet established")}},{key:"handleEnvToggle",value:function(e,t){this.state.socket?t?this.state.socket.emit("start env",e):this.state.socket.emit("stop env",e):console.log("Socket connection not yet established")}},{key:"render",value:function(){var e=Q(this.props.url);if(this.state.loading)return Object(B.jsx)(W,{message:"Loading...",selection:e});if(this.state.errorMessage)return Object(B.jsx)(W,{message:this.state.errorMessage,selection:e});try{var t=Y(e,this.state.resultTree),n=t.childBranches,s=t.childLeaves;return Object(B.jsx)(V,{childBranches:n,childLeaves:s,selection:e,handleTestRun:this.handleTestRun,handleEnvToggle:this.handleEnvToggle})}catch(a){if(a instanceof ee)return Object(B.jsx)(W,{message:"404 Page Not Found",selection:e});throw a}}}]),n}(a.a.Component),Q=function(e){if(!e)return[];var t=e.replace(/^\/+|\/+$/g,"");return 0===t.length?[]:t.split("/").map(decodeURIComponent)},V=function(e){var t=X().get("selectedLeaf"),n=t?e.childLeaves[t]:null;return Object(B.jsxs)("div",{children:[Object(B.jsx)(D,{childBranches:e.childBranches,childLeaves:e.childLeaves,selectedLeafID:t,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle}),Object(B.jsxs)("div",{className:Object(x.b)(Z.centrePane),children:[Object(B.jsx)(q,{selection:e.selection}),Object(B.jsx)(H,{selectedLeaf:n})]})]})},W=function(e){return Object(B.jsxs)("div",{children:[Object(B.jsx)(D,{childBranches:{},childLeaves:{},selectedLeafID:null,selection:[],handleTestRun:function(e){},handleEnvToggle:function(e,t){}}),Object(B.jsxs)("div",{className:Object(x.b)(Z.centrePane),children:[Object(B.jsx)(q,{selection:e.selection}),Object(B.jsx)(J,{message:e.message})]})]})},X=function(){return new URLSearchParams(Object(p.e)().search)},Y=function(e,t){if(!t)return{childBranches:{},childLeaves:{}};if(0===e.length)return{childBranches:Object(l.a)({},t.short_id,t),childLeaves:{}};var n=e.slice(1).reduce((function(e,t){return null===e||void 0===e?void 0:e.child_branches[t]}),t);if(n)return{childBranches:n.child_branches,childLeaves:n.child_leaves};throw new ee("Not found",e)},Z=x.a.create({centrePane:{"margin-left":E,padding:"10px 10px"}}),ee=function(e){Object(h.a)(n,e);var t=Object(j.a)(n);function n(e,s){var a;return Object(r.a)(this,n),(a=t.call(this,e)).selection=void 0,a.selection=s,a}return n}(Object(i.a)(Error)),te=function(){return Object(B.jsx)(O.a,{children:Object(B.jsx)(p.a,{path:"/",render:function(e){var t=e.location;return Object(B.jsx)(K,{url:t.pathname})}})})};n(139);o.a.render(Object(B.jsx)(te,{}),document.getElementById("root"))}},[[140,1,2]]]);
//# sourceMappingURL=main.1ebdfd0c.chunk.js.map