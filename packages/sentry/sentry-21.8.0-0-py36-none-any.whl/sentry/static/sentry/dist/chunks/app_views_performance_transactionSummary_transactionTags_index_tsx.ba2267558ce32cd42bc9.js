"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionTags_index_tsx","app_components_sentryDocumentTitle_tsx"],{"./app/components/charts/components/visualMap.tsx":(e,t,n)=>{function a(e){return e}n.d(t,{Z:()=>a}),n("../node_modules/echarts/lib/component/visualMap.js")},"./app/components/charts/transitionChart.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("./app/components/charts/loadingPanel.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends s.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const n=t.prevReloading,a=e.reloading,s=t.prevLoading,o=e.loading;return s!==o?{prevReloading:a,prevLoading:o,key:t.key+1}:o?{prevReloading:a,prevLoading:o,key:t.key}:n&&!a?{prevReloading:a,prevLoading:o,key:t.key+1}:{prevReloading:a,prevLoading:o,key:t.key}}render(){const{height:e,loading:t,reloading:n}=this.props;return t&&!n?(0,r.tZ)(o.Z,{height:e,"data-test-id":"events-request-loading"}):(0,r.tZ)(s.Fragment,{children:this.props.children},String(this.state.key))}}i.displayName="TransitionChart",(0,a.Z)(i,"defaultProps",{height:"200px"});const l=i},"./app/components/charts/transparentLoadingMask.tsx":(e,t,n)=>{n.d(t,{Z:()=>r});var a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(n("../node_modules/react/index.js"),n("./app/components/loadingMask.tsx")),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,a.Z)((({className:e,visible:t,children:n,...a})=>{const r=t?{...a,"data-test-id":"loading-placeholder"}:a;return(0,o.tZ)(s.Z,{className:e,...r,children:n})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/events/searchBar.tsx":(e,t,n)=>{n.d(t,{Z:()=>L});var a,s=n("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/react/index.js")),i=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=n("../node_modules/lodash/assign.js"),c=n.n(l),d=n("../node_modules/lodash/flatten.js"),u=n.n(d),m=n("../node_modules/lodash/isEqual.js"),p=n.n(m),g=n("../node_modules/lodash/memoize.js"),h=n.n(g),y=n("../node_modules/lodash/omit.js"),Z=n.n(y),f=n("./app/actionCreators/tags.tsx"),x=n("./app/components/smartSearchBar/index.tsx"),v=n("./app/constants/index.tsx"),b=n("./app/types/index.tsx"),w=n("./app/utils.tsx"),j=n("./app/utils/discover/fields.tsx"),k=n("./app/utils/measurements/measurements.tsx"),C=n("./app/utils/withApi.tsx"),S=n("./app/utils/withTags.tsx"),_=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=new RegExp("^".concat(v.c$,"|\\").concat(v.ir),"g");class q extends r.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"getEventFieldValues",h()(((e,t,n)=>{const{api:a,organization:s,projectIds:o}=this.props,r=null==o?void 0:o.map(String);return(0,j.h1)(e.key)||(0,j.Xr)(e.key)?Promise.resolve([]):(0,f.Fo)(a,s.slug,e.key,t,r,n,!0).then((e=>u()(e.filter((({name:e})=>(0,w.ri)(e))).map((({name:e})=>e)))),(()=>{throw new Error("Unable to fetch event field values")}))}),(({key:e},t)=>"".concat(e,"-").concat(t)))),(0,o.Z)(this,"prepareQuery",(e=>e.replace(T,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,n;p()(this.props.projectIds,e.projectIds)||null===(t=(n=this.getEventFieldValues.cache).clear)||void 0===t||t.call(n)}getTagList(e){const{fields:t,organization:n,tags:a,omitTags:s}=this.props,o=t?Object.fromEntries(t.filter((e=>!Object.keys(j.wZ).includes(e.field)&&!(0,j.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},r=n.features.includes("performance-view")?Object.assign({},e,j.wZ,o):Z()(j.wZ,j.J8),i=n.features.includes("semver")?Object.assign({},j.jg,r):r,l=c()({},a,i);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},Z()(l,null!=s?s:[])}render(){const{organization:e}=this.props;return(0,_.tZ)(k.Z,{organization:e,children:({measurements:e})=>{const t=this.getTagList(e);return(0,_.tZ)(i.ms,{children:({css:e})=>(0,_.tZ)(x.Z,{...this.props,hasRecentSearches:!0,savedSearchType:b.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:t,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:e(a||(a=(0,s.Z)(["\n                    max-height: 300px;\n                    overflow-y: auto;\n                  "])))})})}})}}q.displayName="SearchBar";const L=(0,C.Z)((0,S.Z)(q))},"./app/components/sentryDocumentTitle.tsx":(e,t,n)=>{n.d(t,{Z:()=>i}),n("../node_modules/react/index.js");var a=n("../node_modules/react-document-title/index.js"),s=n.n(a),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r({title:e,orgSlug:t,projectSlug:n,children:a}){const r=t||n?t&&n?"".concat(e," - ").concat(t," - ").concat(n):t?"".concat(e," - ").concat(t):"".concat(e," - ").concat(n):e;return(0,o.tZ)(s(),{title:"".concat(r," - Sentry"),children:a})}r.displayName="SentryDocumentTitle";const i=r},"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>r,gu:()=>i,b4:()=>l});var a=n("./app/locale.tsx"),s=n("./app/utils/discover/fields.tsx"),o=n("./app/utils/formatters.tsx");function r(e,t=""){switch((0,s.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,o.rl)(e,2);case"duration":return(0,o.g9)(e/1e3,2,!0);default:return e.toString()}}function i(e,t,n=!1){switch((0,s.Px)(t)){case"integer":case"number":return n?(0,o.Du)(e):e.toLocaleString();case"percentage":return(0,o.rl)(e,0);case"duration":return l(e);default:return e.toString()}}function l(e){if(0===e)return"0";if(e>=o.ps){const t=(e/o.ps).toFixed(0);return(0,a.t)("%swk",t)}if(e>=o.x4){const t=(e/o.x4).toFixed(0);return(0,a.t)("%sd",t)}if(e>=o.kr){const t=(e/o.kr).toFixed(0);return(0,a.t)("%shr",t)}if(e>=o.EB){const t=(e/o.EB).toFixed(0);return(0,a.t)("%smin",t)}if(e>=o.sh){const t=(e/o.sh).toFixed(0);return(0,a.t)("%ss",t)}const t=e.toFixed(0);return(0,a.t)("%sms",t)}},"./app/utils/measurements/measurements.tsx":(e,t,n)=>{n.d(t,{Z:()=>d}),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=n("../node_modules/react/index.js"),s=n("./app/utils/performance/vitals/constants.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{name:t.name,key:e}])))}const i=r(s.T),l=r(s.r);function c({organization:e,children:t}){const n=e.features.includes("performance-mobile-vitals")?{...l,...i}:l;return(0,o.tZ)(a.Fragment,{children:t({measurements:n})})}c.displayName="Measurements";const d=c},"./app/utils/withTags.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("./app/stores/tagStore.tsx"),r=n("./app/utils/getDisplayName.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends s.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{tags:o.Z.getAllTags()}),(0,a.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,i.tZ)(e,{tags:null!=t?t:this.state.tags,...n})}}return t.displayName="WithTags",(0,a.Z)(t,"displayName","withTags(".concat((0,r.Z)(e),")")),t}},"./app/views/performance/transactionSummary/transactionTags/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ue});var a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/react/index.js")),r=n("../node_modules/react-router/es/index.js"),i=n("./app/components/acl/feature.tsx"),l=n("./app/components/alert.tsx"),c=n("./app/components/lightWeightNoProjectMessage.tsx"),d=n("./app/components/organizations/globalSelectionHeader/index.tsx"),u=n("./app/components/sentryDocumentTitle.tsx"),m=n("./app/locale.tsx"),p=n("./app/styles/organization.tsx"),g=n("./app/utils/discover/eventView.tsx"),h=n("./app/utils/queryString.tsx"),y=n("./app/utils/tokenizeSearch.tsx"),Z=n("./app/utils/withGlobalSelection.tsx"),f=n("./app/utils/withOrganization.tsx"),x=n("./app/utils/withProjects.tsx"),v=n("./app/views/performance/utils.tsx"),b=n("./app/components/charts/styles.tsx"),w=n("./app/components/events/searchBar.tsx"),j=n("./app/components/loadingIndicator.tsx"),k=n("./app/components/organizations/globalSelectionHeader/getParams.tsx"),C=n("./app/components/questionTooltip.tsx"),S=n("./app/components/radio.tsx"),_=n("./app/styles/space.tsx"),T=n("./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx"),q=n("./app/views/performance/transactionSummary/utils.tsx"),L=n("./app/views/performance/transactionSummary/filter.tsx"),V=n("./app/views/performance/transactionSummary/header.tsx"),B=n("./app/views/performance/transactionSummary/tagExplorer.tsx"),N=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),D=n("./app/components/placeholder.tsx"),z=n("./app/utils/discover/genericDiscoverQuery.tsx"),P=n("./app/utils/withApi.tsx"),F=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function E(e){const{aggregateColumn:t}=e;return function(n){const{eventView:a}=n,s=a.getEventsAPIPayload(n.location);return s.aggregateColumn=t,s.sort=e.sort?e.sort:"-sumdelta",s.tagKey=e.tagKey,s.tagKeyLimit=e.tagKeyLimit,s.numBucketsPerKey=e.numBucketsPerKey,s}}function A(e,t){return e.aggregateColumn!==t.aggregateColumn||e.sort!==t.sort||e.tagKey!==t.tagKey}function M(e){return(0,F.tZ)(z.Z,{route:"events-facets-performance-histogram",getRequestPayload:E(e),shouldRefetchData:A,...e})}M.displayName="TagKeyHistogramQuery";const R=(0,P.Z)(M);n("../node_modules/core-js/modules/es.array.reverse.js");var X=n("../node_modules/react-dom/index.js"),I=n("../node_modules/react-popper/lib/esm/Popper.js"),O=n("../node_modules/@sentry/utils/esm/string.js"),K=n("../node_modules/classnames/index.js"),H=n.n(K),Q=n("../node_modules/lodash/memoize.js"),W=n.n(Q);n("./app/components/charts/components/visualMap.tsx"),n("../node_modules/echarts/lib/chart/heatmap.js"),n("../node_modules/echarts/lib/component/visualMap.js");var Y=n("./app/components/charts/baseChart.tsx");const G=o.forwardRef(((e,t)=>{const{series:n,seriesOptions:a,visualMaps:s,...o}=e;return(0,F.tZ)(Y.Z,{ref:t,options:{visualMap:s},...o,series:n.map((({seriesName:e,data:t,dataArray:n,...s})=>function(e={}){const{data:t,...n}=e;return{data:t,...n,type:"heatmap"}}({...a,...s,name:e,data:n||t.map((({value:e,name:t})=>[t,e]))})))})}));var J=n("./app/components/charts/transitionChart.tsx"),U=n("./app/components/charts/transparentLoadingMask.tsx"),$=n("./app/components/dropdownControl.tsx"),ee=n("./app/components/dropdownMenu.tsx"),te=n("./app/components/panels/index.tsx"),ne=n("./app/components/quickTrace/styles.tsx"),ae=n("./app/components/truncate.tsx"),se=n("./app/utils/discover/charts.tsx"),oe=n("./app/utils/formatters.tsx"),re=n("./app/utils/getDynamicText.tsx");function ie(e,t){return e.query!==t.query}function le(e){return(0,F.tZ)(z.Z,{route:"eventsv2",shouldRefetchData:ie,...e})}le.displayName="TagTransactionsQuery";const ce=(0,P.Z)(le);var de=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),ue=n("./app/views/performance/transactionSummary/transactionTags/utils.tsx");class me{constructor(e){(0,a.Z)(this,"boundingRect",void 0),this.boundingRect=e.getBoundingClientRect()}getBoundingClientRect(){return this.boundingRect}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const pe=W()((()=>{let e=document.getElementById("heatmap-portal");return e||(e=document.createElement("div"),e.setAttribute("id","heatmap-portal"),document.body.appendChild(e)),e})),ge=e=>{const{tableData:t,isLoading:n,organization:a,eventView:s,location:r,tagKey:i,transactionName:l,aggregateColumn:c}=e,d=(0,o.useRef)(null),[u,p]=(0,o.useState)(),[g,y]=(0,o.useState)(),[Z,f]=(0,o.useState)(!1),x=["#D1BAFC","#9282F3","#6056BA","#313087","#021156"],b=new Set,w=t&&t.histogram&&t.histogram.data&&t.histogram.data.length?t.histogram.data:void 0,k=t&&t.tags&&t.tags.data?t.tags.data:void 0,S=w&&(T=w[0],Object.keys(T).find((e=>e.includes("histogram"))));var T;const L=k?k.map((e=>e.tags_value)).reverse():[];let V=0;const B=S&&w?w.map((e=>{const t=e[S],n=(0,v.YL)(t),a=e.tags_value;return b.add(n),V=Math.max(V,e.count),[n,a,e.count]})):null;B&&B.sort(((e,t)=>e[0]===t[0]?t[1]-e[1]:t[0]-e[0]));const N={height:290,animation:!1,colors:x,tooltip:{},yAxis:{type:"category",data:Array.from(L),splitArea:{show:!0},axisLabel:{formatter:e=>(0,O.$G)(e,30)}},xAxis:{boundaryGap:!0,type:"category",splitArea:{show:!0},data:Array.from(b),axisLabel:{show:!0,showMinLabel:!0,showMaxLabel:!0,formatter:e=>(0,se.gu)(e,"Count")},axisLine:{},axisPointer:{show:!1},axisTick:{show:!0,interval:0,alignWithLabel:!0}},grid:{left:(0,_.Z)(3),right:(0,_.Z)(3),top:"25px",bottom:(0,_.Z)(4)}},z=[{min:0,max:V,show:!1,orient:"horizontal",calculable:!0,inRange:{color:x}}],P=[];B&&P.push({seriesName:"Count",dataArray:B,label:{show:!0,formatter:e=>(0,oe.Du)(e.value[2])},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}});const E=w&&(0,ue.oT)(w[0]);return(0,F.BX)(xe,{children:[(0,F.BX)(ve,{children:[(0,m.t)("Heat Map"),(0,F.tZ)(C.Z,{size:"sm",position:"top",title:(0,m.t)("This heatmap shows the frequency for each duration across the most common tag values")})]}),(0,F.BX)(J.Z,{loading:n,reloading:n,children:[(0,F.tZ)(U.Z,{visible:n}),(0,F.tZ)(ee.Z,{onOpen:()=>{f(!0)},onClose:()=>{f(!1)},shouldIgnoreClickOutside:e=>{var t;return!(null===(t=d.current)||void 0===t||!t.getEchartsInstance().getDom().contains(e.target))},children:({isOpen:e,getMenuProps:t,actions:n})=>(0,F.BX)(o.Fragment,{children:[X.createPortal((0,F.tZ)("div",{children:u?(0,F.tZ)(I.ZP,{referenceElement:u,placement:"bottom",children:({ref:n,style:s,placement:i})=>(0,F.tZ)(Ze,{ref:n,style:s,className:"anchor-middle","data-placement":i,children:(0,F.tZ)(fe,{...t({className:H()("dropdown-menu")}),isOpen:e,alignMenu:"right",blendCorner:!1,children:g?(0,F.tZ)(ce,{query:g.getQueryWithAdditionalConditions(),location:r,eventView:g,orgSlug:a.slug,limit:4,referrer:"api.performance.tag-page",children:({isLoading:e,tableData:t})=>{const n=e?null:(0,de.xr)({orgSlug:a.slug,transaction:l,projectID:(0,h.ro)(r.query.project),query:{...g.generateQueryStringObject(),query:g.getQueryWithAdditionalConditions()}});return(0,F.tZ)(o.Fragment,{children:e?(0,F.tZ)(he,{children:(0,F.tZ)(j.Z,{size:40,hideMessage:!0})}):(0,F.BX)("div",{children:[t.data.length?null:(0,F.tZ)(D.Z,{}),[...t.data].slice(0,3).map((e=>{const t=(0,q.vd)(l)(a,e,r.query);return(0,F.tZ)(ne.hP,{width:"small",to:t,children:(0,F.BX)(ye,{children:[(0,F.tZ)(ae.Z,{value:e.id,maxLength:12}),(0,F.tZ)(ne.df,{children:(0,F.tZ)(v.Xr,{milliseconds:e[c],abbreviation:!0})})]})},e.id)})),n&&t.data.length>3?(0,F.tZ)(ne.hP,{width:"small",to:n,children:(0,F.tZ)(ye,{children:(0,m.t)("View all events")})}):null]})})}}):null})})}):null}),pe()),(0,re.Z)({value:(0,F.tZ)(G,{ref:d,visualMaps:z,series:P,onClick:e=>{const t=e.event.event,o=new me(t.target);p(o);const r=s.clone();r.fields=[{field:c}];const[l,d]=e.value;if(E&&w){const t=w[e.dataIndex],n=parseInt("".concat(t[E.histogramField]),10),a=n+E.bucketSize;r.additionalConditions.setFilterValues(c,[">=".concat(n),"<".concat(a)])}r.additionalConditions.setFilterValues(i,[d]),y(r),(0,ue.bZ)(a),Z||n.open()},...N}),fixed:(0,F.tZ)(D.Z,{height:"290px",testId:"skeleton-ui"})})]})})]})]})};ge.displayName="TagsHeatMap";const he=(0,s.Z)("div",{target:"eoy5kj75"})({name:"kxllrv",styles:"width:200px;height:100px;display:flex;align-items:center;justify-content:center"}),ye=(0,s.Z)("div",{target:"eoy5kj74"})({name:"17wn5yb",styles:"width:100%;display:flex;flex-direction:row;justify-content:space-between"}),Ze=(0,s.Z)(ne.DZ,{target:"eoy5kj73"})("z-index:",(e=>e.theme.zIndex.dropdown),";"),fe=(0,s.Z)($.VY,{target:"eoy5kj72"})({name:"17pw1o7",styles:"right:auto;transform:translate(-50%);overflow:visible"}),xe=(0,s.Z)(te.s_,{target:"eoy5kj71"})("padding:",(0,_.Z)(3)," ",(0,_.Z)(3)," 0 ",(0,_.Z)(3),";margin-bottom:0;border-bottom:0;border-bottom-left-radius:0;border-bottom-right-radius:0;"),ve=(0,s.Z)(b.ws,{target:"eoy5kj70"})(""),be=(0,N.b)(ge);var we=n("./app/components/gridEditable/index.tsx"),je=n("./app/components/gridEditable/sortLink.tsx"),ke=n("./app/components/links/link.tsx"),Ce=n("./app/icons/iconAdd.tsx"),Se=n("./app/utils/discover/fields.tsx"),_e=n("./app/views/eventsV2/table/cellAction.tsx");const Te="tags_cursor",qe=[{key:"tagValue",field:"tagValue",name:"Tag Values",width:-1,column:{kind:"field"}},{key:"frequency",field:"frequency",name:"Frequency",width:-1,column:{kind:"field"},canSort:!0},{key:"count",field:"count",name:"Events",width:-1,column:{kind:"field"},canSort:!0},{key:"aggregate",field:"aggregate",name:"Avg Duration",width:-1,column:{kind:"field"},canSort:!0},{key:"action",field:"action",name:"",width:-1,column:{kind:"field"}}];class Le extends o.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{widths:[]}),(0,a.Z)(this,"renderHeadCellWithMeta",((e,t,n)=>(a,s)=>this.renderHeadCell(e,t,a,n[s]))),(0,a.Z)(this,"handleTagValueClick",((e,t,n)=>{const a=(0,h.ro)(e.query.query),s=(0,y.aI)(a||"");s.addFilterValues(t,[n]);const o=s.formatString();r.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(o).trim()}})})),(0,a.Z)(this,"handleCellAction",((e,t,n)=>a=>{const{eventView:s,location:o,organization:i}=this.props;(0,ue.bZ)(i);const l=(0,y.aI)(s.query);l.removeFilter("event.type"),(0,_e.rh)(l,a,{...e,name:n.id},t),r.browserHistory.push({pathname:o.pathname,query:{...o.query,[Te]:void 0,query:l.formatString()}})})),(0,a.Z)(this,"renderBodyCell",((e,t,n)=>{const a=n[t.key],{location:s,eventView:o,organization:r}=e;if("key"===t.key)return n.tags_key;const i=[_e.eX.ADD,_e.eX.EXCLUDE];if("tagValue"===t.key){const e={...n,id:n.tags_key};return(0,F.tZ)(_e.ZP,{column:t,dataRow:e,handleCellAction:this.handleCellAction(t,n.tags_value,e),allowActions:i,children:(0,F.tZ)(B.xS,{row:n})})}if("frequency"===t.key)return(0,F.tZ)(Be,{children:(0,oe.rl)(n.frequency,0)});if("action"===t.key){const e=(0,y.aI)(o.query).hasFilter(n.tags_key);return(0,F.tZ)(ke.Z,{disabled:e,to:"",onClick:()=>{(0,ue.bZ)(r),this.handleTagValueClick(s,n.tags_key,n.tags_value)},children:(0,F.BX)(Ne,{children:[(0,F.tZ)(Ce.N,{isCircled:!0}),(0,m.t)("Add to filter")]})})}if("comparison"===t.key){const e=n.comparison,t=(0,oe.rl)(e-1,0);return e>1?(0,m.t)("+%s slower",t):(0,m.t)("%s faster",t)}return"aggregate"===t.key?(0,F.tZ)(Be,{children:(0,F.tZ)(v.Xr,{abbreviation:!0,milliseconds:n.aggregate})}):"sumdelta"===t.key?(0,F.tZ)(Be,{children:(0,F.tZ)(v.Xr,{abbreviation:!0,milliseconds:n.sumdelta})}):"count"===t.key?(0,F.tZ)(Be,{children:a}):a})),(0,a.Z)(this,"renderBodyCellWithData",(e=>(t,n)=>this.renderBodyCell(e,t,n))),(0,a.Z)(this,"handleResizeColumn",((e,t)=>{const n=[...this.state.widths];n[e]=t.width?Number(t.width):we.z7,this.setState({widths:n})}))}renderHeadCell(e,t,n,a){const{location:s}=this.props,o=(0,Se.qG)(n.key,n.type,t),r={field:n.key,width:n.width},i=e.sortForField(r,t),l=i?i.kind:void 0;return(0,F.tZ)(je.Z,{align:o,title:a.name,direction:l,canSort:!1,generateSortLink:function(){if(!t)return;const n=e.sortOnField(r,t),{sort:a}=n.generateQueryStringObject();return{...s,query:{...s.query,[Te]:void 0,tagSort:a}}},onClick:()=>{}})}render(){const{eventView:e,tagKey:t,location:n,isLoading:a,tableData:s,aggregateColumn:o}=this.props,r=[...qe].map((e=>{const n={...e};return"tagValue"===e.key&&(n.name=t),"aggregate"===e.key&&"measurements.lcp"===o&&(n.name="Avg LCP"),n}));return(0,F.tZ)(Ve,{children:(0,F.tZ)(we.ZP,{isLoading:a,data:s&&s.data?s.data:[],columnOrder:r,columnSortBy:[],grid:{renderHeadCell:this.renderHeadCellWithMeta(e,s?s.meta:{},r),renderBodyCell:this.renderBodyCellWithData(this.props),onResizeColumn:this.handleResizeColumn},location:n})})}}Le.displayName="TagValueTable";const Ve=(0,s.Z)("div",{target:"e1gt1k5a2"})({name:"122h187",styles:">div{border-top-left-radius:0;border-top-right-radius:0;}"}),Be=(0,s.Z)("div",{target:"e1gt1k5a1"})({name:"2qga7i",styles:"text-align:right"}),Ne=(0,s.Z)("div",{target:"e1gt1k5a0"})("display:grid;grid-auto-flow:column;grid-gap:",(0,_.Z)(.5),";justify-content:flex-end;align-items:center;"),De=e=>{const{eventView:t,location:n,organization:a,projects:s,tagKey:r}=e,i=(0,B.e2)(L.f1.None,s,t);return(0,F.tZ)(o.Fragment,{children:r?(0,F.BX)(o.Fragment,{children:[(0,F.tZ)(R,{eventView:t,orgSlug:a.slug,location:n,aggregateColumn:i,tagKeyLimit:8,numBucketsPerKey:20,tagKey:r,sort:"-frequency",children:({isLoading:t,tableData:n})=>(0,F.tZ)(be,{...e,tagKey:r,aggregateColumn:i,tableData:n,isLoading:t})}),(0,F.tZ)(T.Z,{eventView:t,orgSlug:a.slug,location:n,aggregateColumn:i,tagKey:r,limit:8,sort:"-frequency",allTagKeys:!0,children:({isLoading:t,tableData:n})=>(0,F.tZ)(Le,{...e,tagKey:r,aggregateColumn:i,tableData:n,isLoading:t})})]}):(0,F.tZ)(D.Z,{height:"290"})})};De.displayName="TagsDisplay";const ze=(0,N.b)(De),Pe=e=>{const{eventView:t,location:n,organization:a,projects:s,transactionName:r}=e,i=(0,B.e2)(L.f1.None,s,t);return(0,F.BX)(o.Fragment,{children:[(0,F.tZ)(V.Z,{eventView:t,location:n,organization:a,projects:s,transactionName:r,currentTab:V.O.Tags,hasWebVitals:"maybe",handleIncompatibleQuery:()=>{}}),(0,F.tZ)(T.Z,{eventView:t,orgSlug:a.slug,location:n,aggregateColumn:i,limit:20,sort:"-sumdelta",allTagKeys:!0,children:({isLoading:t,tableData:n})=>(0,F.tZ)(Fe,{...e,isLoading:t,tableData:n})})]})};Pe.displayName="TagsPageContent";const Fe=e=>{const{eventView:t,location:n,organization:a,tableData:s,isLoading:i}=e,l=t.clone(),c=s?function(e){const t=[],n=[];return e.data.forEach((e=>{(e.comparison>1?t:n).push(e.tags_key)})),{suspectTags:t,otherTags:n}}(s):null,d=c?c.suspectTags:[],u=c?c.otherTags:[],m=(0,ue.Zn)(n),p=[...d,...u],g=m?p.find((e=>e===m)):void 0,y=p.length?p[0]:void 0,Z=null!=g?g:y,[f,x]=(0,o.useState)(Z),v=e=>{const t=(0,k.Q)({...n.query||{},tagKey:e});r.browserHistory.replace({pathname:n.pathname,query:t}),x(e)};(0,o.useEffect)((()=>{Z&&v(Z)}),[Z]),f&&l.additionalConditions.setFilterValues("has",[f]);const b=(0,h.ro)(n.query.query,"");return(0,F.BX)(Ie,{children:[(0,F.tZ)(Ee,{suspectTags:d,otherTags:u,tagSelected:f,changeTag:e=>v(e),isLoading:i}),(0,F.BX)(Ke,{children:[(0,F.tZ)(Qe,{children:(0,F.tZ)(He,{organization:a,projectIds:l.project,query:b,fields:l.fields,onSearch:e=>{const t=(0,k.Q)({...n.query||{},query:e});r.browserHistory.push({pathname:n.pathname,query:t})}})}),(0,F.tZ)(ze,{...e,tagKey:f})]})]})};Fe.displayName="InnerContent";const Ee=e=>{const{suspectTags:t,otherTags:n,changeTag:a,tagSelected:s,isLoading:o}=e;return(0,F.BX)(Oe,{children:[(0,F.BX)(Xe,{children:[(0,m.t)("Suspect Tags"),(0,F.tZ)(C.Z,{position:"top",title:(0,m.t)("Suspect tags are tags that often correspond to slower transaction"),size:"sm"})]}),o?(0,F.tZ)(Ae,{children:(0,F.tZ)(j.Z,{mini:!0})}):t.length?t.map((e=>(0,F.BX)(Me,{children:[(0,F.tZ)(S.Z,{"aria-label":e,checked:s===e,onChange:()=>a(e)}),(0,F.tZ)(Re,{className:"truncate",children:e})]},e))):(0,F.tZ)("div",{children:(0,m.t)("No tags detected.")}),(0,F.tZ)(q.uI,{}),(0,F.BX)(Xe,{children:[(0,m.t)("Other Tags"),(0,F.tZ)(C.Z,{position:"top",title:(0,m.t)("Other common tags for this transaction"),size:"sm"})]}),o?(0,F.tZ)(Ae,{children:(0,F.tZ)(j.Z,{mini:!0})}):n.length?n.map((e=>(0,F.BX)(Me,{children:[(0,F.tZ)(S.Z,{"aria-label":e,checked:s===e,onChange:()=>a(e)}),(0,F.tZ)(Re,{className:"truncate",children:e})]},e))):(0,F.tZ)("div",{children:(0,m.t)("No tags detected.")})]})};Ee.displayName="TagsSideBar";const Ae=(0,s.Z)("div",{target:"e5m8yi88"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),Me=(0,s.Z)("label",{target:"e5m8yi87"})("cursor:pointer;margin-bottom:",(0,_.Z)(1),";font-weight:normal;display:grid;grid-auto-flow:column;grid-auto-columns:max-content 1fr;align-items:center;grid-gap:",(0,_.Z)(1),";"),Re=(0,s.Z)("span",{target:"e5m8yi86"})({name:"1d3w5wq",styles:"width:100%"}),Xe=(0,s.Z)(b.OT,{target:"e5m8yi85"})("margin-bottom:",(0,_.Z)(2),";"),Ie=(0,s.Z)("div",{target:"e5m8yi84"})("padding:",(0,_.Z)(2),";margin:0;background-color:",(e=>e.theme.background),";flex-grow:1;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){padding:",(0,_.Z)(3)," ",(0,_.Z)(4),";}@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:grid;grid-template-columns:auto 66%;align-content:start;grid-gap:",(0,_.Z)(3),";}@media (min-width: ",(e=>e.theme.breakpoints[2]),"){grid-template-columns:225px minmax(100px, auto);}"),Oe=(0,s.Z)("div",{target:"e5m8yi83"})({name:"sarfoe",styles:"grid-column:1/2"}),Ke=(0,s.Z)("div",{target:"e5m8yi82"})({name:"g99mcu",styles:"grid-column:2/4;max-width:100%"}),He=(0,s.Z)(w.Z,{target:"e5m8yi81"})({name:"1ff36h2",styles:"flex-grow:1"}),Qe=(0,s.Z)("div",{target:"e5m8yi80"})("margin-bottom:",(0,_.Z)(1),";"),We=Pe;class Ye extends o.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{eventView:Je(this.props.location,(0,v.JY)(this.props.location))}),(0,a.Z)(this,"renderNoAccess",(()=>(0,F.tZ)(l.Z,{type:"warning",children:(0,m.t)("You don't have access to this feature")})))}static getDerivedStateFromProps(e,t){return{...t,eventView:Je(e.location,(0,v.JY)(e.location))}}getDocumentTitle(){const e=(0,v.JY)(this.props.location);return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,m.t)("Tags")].join(" — "):[(0,m.t)("Summary"),(0,m.t)("Tags")].join(" — ")}render(){const{organization:e,projects:t,location:n}=this.props,{eventView:a}=this.state,s=(0,v.JY)(n);if(!a||void 0===s)return r.browserHistory.replace({pathname:"/organizations/".concat(e.slug,"/performance/"),query:{...n.query}}),null;const o=1===a.project.length,l=o?t.find((e=>parseInt(e.id,10)===a.project[0])):void 0,p=a.project.map((e=>t.find((t=>parseInt(t.id,10)===e)))).filter((e=>void 0!==e)).map((e=>e.slug));return(0,F.tZ)(u.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,projectSlug:null==l?void 0:l.slug,children:(0,F.tZ)(i.Z,{features:["performance-tag-page"],organization:e,renderDisabled:this.renderNoAccess,children:(0,F.tZ)(d.Z,{lockedMessageSubject:(0,m.t)("transaction"),shouldForceProject:o,forceProject:l,specificProjectSlugs:p,disableMultipleProjectSelection:!0,showProjectSettingsLink:!0,children:(0,F.tZ)(Ge,{children:(0,F.tZ)(c.Z,{organization:e,children:(0,F.tZ)(We,{location:n,eventView:a,transactionName:s,organization:e,projects:t})})})})})})}}Ye.displayName="TransactionTags";const Ge=(0,s.Z)(p.JH,{target:"evcjml0"})({name:"1hcx8jb",styles:"padding:0"});function Je(e,t){if(void 0===t)return;const n=(0,h.ro)(e.query.query,""),a=(0,y.aI)(n),s=g.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:t,fields:["transaction.duration"],query:a.formatString(),projects:[]},e);return s.additionalConditions.setFilterValues("event.type",["transaction"]),s.additionalConditions.setFilterValues("transaction",[t]),s}const Ue=(0,Z.Z)((0,x.Z)((0,f.Z)(Ye)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionTags_index_tsx.8a24e0755d84d7365e350294f0906497.js.map