"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_organizationIntegrations_pluginDetailedView_tsx"],{"./app/views/organizationIntegrations/pluginDetailedView.tsx":(t,e,n)=>{n.r(e),n.d(e,{default:()=>_});var i=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("./app/actionCreators/modal.tsx")),r=n("./app/components/button.tsx"),a=n("./app/components/contextPickerModal.tsx"),l=n("./app/locale.tsx"),c=n("./app/styles/space.tsx"),p=n("./app/utils/withOrganization.tsx"),d=n("./app/views/organizationIntegrations/abstractIntegrationDetailedView.tsx"),g=n("../node_modules/react/index.js"),u=n("./app/actionCreators/indicator.tsx"),h=n("./app/components/acl/access.tsx"),m=n("./app/components/alert.tsx"),b=n("./app/components/confirm.tsx"),j=n("./app/components/idBadge/projectBadge.tsx"),Z=n("./app/components/switchButton.tsx"),f=n("./app/icons/index.tsx"),x=n("./app/utils/withApi.tsx"),I=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class v extends g.Component{constructor(...t){super(...t),(0,i.Z)(this,"pluginUpdate",(async(t,e="POST")=>{const{organization:n,projectItem:i,plugin:s}=this.props;await this.props.api.requestPromise("/projects/".concat(n.slug,"/").concat(i.projectSlug,"/plugins/").concat(s.id,"/"),{method:e,data:t})})),(0,i.Z)(this,"updatePluginEnableStatus",(async t=>{t?await this.pluginUpdate({enabled:t}):await this.pluginUpdate({},"DELETE")})),(0,i.Z)(this,"handleReset",(async()=>{try{(0,u.E3)((0,l.t)("Removing...")),await this.pluginUpdate({reset:!0}),(0,u.S9)((0,l.t)("Configuration was removed")),this.props.onResetConfiguration(this.projectId),this.props.trackIntegrationEvent("integrations.uninstall_completed")}catch(t){(0,u.Iw)((0,l.t)("Unable to remove configuration"))}})),(0,i.Z)(this,"handleUninstallClick",(()=>{this.props.trackIntegrationEvent("integrations.uninstall_clicked")})),(0,i.Z)(this,"toggleEnablePlugin",(async(t,e=!0)=>{try{(0,u.E3)((0,l.t)("Enabling...")),await this.updatePluginEnableStatus(e),(0,u.S9)(e?(0,l.t)("Configuration was enabled."):(0,l.t)("Configuration was disabled.")),this.props.onPluginEnableStatusChange(t,e),this.props.trackIntegrationEvent(e?"integrations.enabled":"integrations.disabled")}catch(t){(0,u.Iw)(e?(0,l.t)("Unable to enable configuration."):(0,l.t)("Unable to disable configuration."))}}))}get projectId(){return this.props.projectItem.projectId}getConfirmMessage(){return(0,I.tZ)(g.Fragment,{children:(0,I.tZ)(m.Z,{type:"error",icon:(0,I.tZ)(f.Gy,{size:"md"}),children:(0,l.t)("Deleting this installation will disable the integration for this project and remove any configurations.")})})}get projectForBadge(){const{projectItem:t}=this.props;return{slug:t.projectSlug,platform:t.projectPlatform?t.projectPlatform:void 0}}render(){const{className:t,plugin:e,organization:n,projectItem:i}=this.props;return(0,I.tZ)(y,{children:(0,I.tZ)(h.Z,{access:["org:integrations"],children:({hasAccess:s})=>(0,I.BX)(E,{className:t,children:[(0,I.tZ)(P,{children:(0,I.tZ)(j.Z,{project:this.projectForBadge})}),(0,I.tZ)("div",{children:(0,I.tZ)(C,{borderless:!0,icon:(0,I.tZ)(f.iC,{}),disabled:!s,to:"/settings/".concat(n.slug,"/projects/").concat(i.projectSlug,"/plugins/").concat(e.id,"/"),"data-test-id":"integration-configure-button",children:(0,l.t)("Configure")})}),(0,I.tZ)("div",{children:(0,I.tZ)(b.Z,{priority:"danger",onConfirming:this.handleUninstallClick,disabled:!s,confirmText:"Delete Installation",onConfirm:()=>this.handleReset(),message:this.getConfirmMessage(),children:(0,I.tZ)(C,{disabled:!s,borderless:!0,icon:(0,I.tZ)(f.Fz,{}),"data-test-id":"integration-remove-button",children:(0,l.t)("Uninstall")})})}),(0,I.tZ)(Z.Z,{isActive:i.enabled,toggle:()=>this.toggleEnablePlugin(i.projectId,!i.enabled),isDisabled:!s})]})})})}}v.displayName="InstalledPlugin";const w=(0,x.Z)(v),y=(0,s.Z)("div",{target:"emrs3rl3"})("padding:",(0,c.Z)(2),";border:1px solid ",(t=>t.theme.border),";border-bottom:none;background-color:",(t=>t.theme.background),";&:last-child{border-bottom:1px solid ",(t=>t.theme.border),";}"),C=(0,s.Z)(r.ZP,{target:"emrs3rl2"})("color:",(t=>t.theme.gray300),";"),E=(0,s.Z)("div",{target:"emrs3rl1"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),P=(0,s.Z)("div",{target:"emrs3rl0"})({name:"b6ci67",styles:"flex:1;box-sizing:border-box;display:flex;flex-direction:row;min-width:0"});class k extends d.Z{constructor(...t){super(...t),(0,i.Z)(this,"handleResetConfiguration",(t=>{const e=this.plugin.projectList.slice(),n=e.findIndex((e=>e.projectId===t));n<0||(e.splice(n,1),this.setState({plugins:[{...this.state.plugins[0],projectList:e}]}))})),(0,i.Z)(this,"handlePluginEnableStatus",((t,e=!0)=>{const n=this.plugin.projectList.slice(),i=n.findIndex((e=>e.projectId===t));i<0||(n[i]={...n[i],enabled:e},this.setState({plugins:[{...this.state.plugins[0],projectList:n}]}))})),(0,i.Z)(this,"handleAddToProject",(()=>{const t=this.plugin,{organization:e,router:n}=this.props;this.trackIntegrationEvent("integrations.plugin_add_to_project_clicked"),o.openModal((i=>(0,I.tZ)(a.Z,{...i,nextPath:"/settings/".concat(e.slug,"/projects/:projectId/plugins/").concat(t.id,"/"),needProject:!0,needOrg:!1,onFinish:t=>{i.closeModal(),n.push(t)}})),{})}))}getEndpoints(){const{orgId:t,integrationSlug:e}=this.props.params;return[["plugins","/organizations/".concat(t,"/plugins/configs/?plugins=").concat(e)]]}get integrationType(){return"plugin"}get plugin(){return this.state.plugins[0]}get description(){return this.plugin.description||""}get author(){var t;return null===(t=this.plugin.author)||void 0===t?void 0:t.name}get resourceLinks(){return this.plugin.resourceLinks||[]}get installationStatus(){return this.plugin.projectList.length>0?"Installed":"Not Installed"}get integrationName(){return"".concat(this.plugin.name).concat(this.plugin.isHidden?" (Legacy)":"")}get featureData(){return this.plugin.featureDescriptions}getTabDisplay(t){return"configurations"===t?"project configurations":"overview"}renderTopButton(t,e){return e?(0,I.tZ)(S,{"data-test-id":"install-button",disabled:t,onClick:this.handleAddToProject,size:"small",priority:"primary",children:(0,l.t)("Add to Project")}):this.renderRequestIntegrationButton()}renderConfigurations(){const t=this.plugin,{organization:e}=this.props;return t.projectList.length?(0,I.tZ)("div",{children:t.projectList.map((n=>(0,I.tZ)(w,{organization:e,plugin:t,projectItem:n,onResetConfiguration:this.handleResetConfiguration,onPluginEnableStatusChange:this.handlePluginEnableStatus,trackIntegrationEvent:this.trackIntegrationEvent},n.projectId)))}):this.renderEmptyConfigurations()}}const S=(0,s.Z)(r.ZP,{target:"e13hh9ci0"})("margin-bottom:",(0,c.Z)(1),";"),_=(0,p.Z)(k)}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationIntegrations_pluginDetailedView_tsx.f4aa7af8f198b847b88e84136ec23d38.js.map