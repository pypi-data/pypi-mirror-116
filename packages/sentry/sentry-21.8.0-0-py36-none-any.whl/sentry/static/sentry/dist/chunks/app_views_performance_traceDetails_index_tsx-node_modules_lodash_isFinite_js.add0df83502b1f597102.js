(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_traceDetails_index_tsx-node_modules_lodash_isFinite_js"],{"./app/utils/performance/quickTrace/traceFullQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{g:()=>p,H:()=>u});var n=r("../node_modules/react/index.js"),s=r("./app/utils/discover/genericDiscoverQuery.tsx"),a=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("./app/utils/withApi.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c({detailed:e,eventId:t,...r}){const n=(0,a.eF)(r);return n.detailed=e?"1":"0",t&&(n.event_id=t),n}function l({children:e}){return(0,o.tZ)(n.Fragment,{children:e({isLoading:!1,error:null,traces:null,type:"full"})})}function d({traceId:e,start:t,end:r,statsPeriod:n,children:i,...d}){if(!e)return(0,o.tZ)(l,{children:i});const p=(0,a._Z)({start:t,end:r,statsPeriod:n});return(0,o.tZ)(s.Z,{route:"events-trace/".concat(e),getRequestPayload:c,beforeFetch:a.VP,eventView:p,...d,children:({tableData:e,...t})=>i({traces:e||null,type:"full",...t})})}l.displayName="EmptyTrace",d.displayName="GenericTraceFullQuery";const p=(0,i.Z)((e=>(0,o.tZ)(d,{...e,detailed:!1}))),u=(0,i.Z)((e=>(0,o.tZ)(d,{...e,detailed:!0})))},"./app/utils/performance/quickTrace/traceMetaQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r("../node_modules/react/index.js"),s=r("./app/utils/discover/genericDiscoverQuery.tsx"),a=r("./app/utils/performance/quickTrace/utils.tsx"),i=r("./app/utils/withApi.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c({traceId:e,start:t,end:r,statsPeriod:i,children:c,...l}){if(!e)return(0,o.tZ)(n.Fragment,{children:c({isLoading:!1,error:null,meta:null})});const d=(0,a._Z)({start:t,end:r,statsPeriod:i});return(0,o.tZ)(s.Z,{route:"events-trace-meta/".concat(e),beforeFetch:a.VP,getRequestPayload:a.eF,eventView:d,...l,children:({tableData:e,...t})=>c({meta:e,...t})})}c.displayName="TraceMetaQuery";const l=(0,i.Z)(c)},"./app/views/performance/breadcrumb.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r("../node_modules/react/index.js"),s=r("./app/components/breadcrumbs.tsx"),a=r("./app/locale.tsx"),i=r("./app/utils/queryString.tsx"),o=r("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),c=r("./app/views/performance/transactionSummary/utils.tsx"),l=r("./app/views/performance/vitalDetail/utils.tsx"),d=r("./app/views/performance/utils.tsx"),p=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class u extends n.Component{getCrumbs(){const e=[],{organization:t,location:r,transactionName:n,vitalName:s,eventSlug:p,traceSlug:u,transactionComparison:h,realUserMonitoring:m}=this.props,g={pathname:(0,d.de)(t),query:{...r.query,transaction:void 0}};if(e.push({to:g,label:(0,a.t)("Performance"),preserveGlobalSelection:!0}),s){const n=(0,l.i4)({orgSlug:t.slug,vitalName:"fcp",projectID:(0,i.ro)(r.query.project),query:r.query});e.push({to:n,label:(0,a.t)("Vital Detail"),preserveGlobalSelection:!0})}else if(n)if(m){const s=(0,o.Pl)({orgSlug:t.slug,transaction:n,projectID:(0,i.ro)(r.query.project),query:r.query});e.push({to:s,label:(0,a.t)("Web Vitals"),preserveGlobalSelection:!0})}else{const s=(0,c.e1)({orgSlug:t.slug,transaction:n,projectID:(0,i.ro)(r.query.project),query:r.query});e.push({to:s,label:(0,a.t)("Transaction Summary"),preserveGlobalSelection:!0})}return n&&p?e.push({to:"",label:(0,a.t)("Event Details")}):h?e.push({to:"",label:(0,a.t)("Compare to Baseline")}):u&&e.push({to:"",label:(0,a.t)("Trace View")}),e}render(){return(0,p.tZ)(s.Z,{crumbs:this.getCrumbs()})}}u.displayName="Breadcrumb";const h=u},"./app/views/performance/traceDetails/index.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Re});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(r("../node_modules/core-js/modules/es.string.trim.js"),r("../node_modules/react/index.js")),a=r("./app/components/lightWeightNoProjectMessage.tsx"),i=r("./app/components/organizations/globalSelectionHeader/getParams.tsx"),o=r("./app/components/sentryDocumentTitle.tsx"),c=r("./app/constants/globalSelectionHeader.tsx"),l=r("./app/locale.tsx"),d=r("./app/styles/organization.tsx"),p=r("./app/utils/discover/eventView.tsx"),u=r("./app/utils/performance/quickTrace/traceFullQuery.tsx"),h=r("./app/utils/performance/quickTrace/traceMetaQuery.tsx"),m=r("./app/utils/queryString.tsx"),g=r("./app/utils/withApi.tsx"),f=r("./app/utils/withOrganization.tsx"),x=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Z=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.unscopables.flat-map.js"),r("../node_modules/core-js/modules/es.array.reduce.js"),r("../node_modules/@sentry/hub/esm/hub.js")),v=r("./app/components/alert.tsx"),y=r("./app/components/assistant/guideAnchor.tsx"),b=r("./app/components/buttonBar.tsx"),w=r("./app/components/discover/discoverFeature.tsx"),T=r("./app/components/discoverButton.tsx"),D=r("./app/components/events/interfaces/spans/anchorLinkManager.tsx"),S=r("./app/components/events/interfaces/spans/dividerHandlerManager.tsx"),C=r("./app/components/events/interfaces/spans/scrollbarManager.tsx"),j=r("./app/components/layouts/thirds.tsx"),_=r("./app/components/links/externalLink.tsx"),P=r("./app/components/links/link.tsx"),I=r("./app/components/loadingError.tsx"),z=r("./app/components/loadingIndicator.tsx"),B=r("./app/components/performance/waterfall/messageRow.tsx"),k=r("./app/components/performance/waterfall/miniHeader.tsx"),O=r("./app/components/performance/waterfall/utils.tsx"),L=r("./app/components/timeSince.tsx"),q=r("./app/icons/index.tsx"),F=r("./app/utils/createFuzzySearch.tsx"),M=r("./app/utils/formatters.tsx"),V=r("./app/utils/getDynamicText.tsx"),N=r("./app/utils/performance/quickTrace/utils.tsx"),E=r("./app/views/performance/breadcrumb.tsx"),H=r("./app/views/performance/transactionDetails/styles.tsx"),R=r("./app/components/events/eventTags/eventTagsPill.tsx"),X=r("./app/components/events/interfaces/spans/header.tsx"),A=r("./app/components/idBadge/projectBadge.tsx"),G=r("./app/components/panels/index.tsx"),Q=r("./app/components/pills.tsx"),U=r("./app/components/searchBar.tsx"),W=r("./app/styles/space.tsx"),$=r("./app/utils.tsx"),J=r("./app/views/performance/transactionSummary/utils.tsx"),Y=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"),K=r("./app/components/events/interfaces/spans/spanDetail.tsx");const ee=(0,n.Z)("div",{target:"euzgho58"})({name:"7whenc",styles:"display:flex;width:100%"}),te=(0,n.Z)(U.Z,{target:"euzgho57"})({name:"1ff36h2",styles:"flex-grow:1"}),re=(0,n.Z)(X.i,{target:"euzgho56"})("position:static;top:auto;border-top:none;border-bottom:1px solid ",(e=>e.theme.border),";"),ne=(0,n.Z)("div",{target:"euzgho55"})("display:grid;grid-template-columns:1fr;grid-gap:",(0,W.Z)(2),";margin-bottom:",(0,W.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){grid-template-columns:minmax(250px, 1fr) minmax(160px, 1fr) 6fr;grid-row-gap:0;}"),se=(0,n.Z)("div",{target:"euzgho54"})("margin-top:",(0,W.Z)(2),";"),ae=(0,n.Z)("div",{target:"euzgho53"})({name:"1wr20zt",styles:"overflow-x:hidden;border-bottom-left-radius:3px;border-bottom-right-radius:3px"}),ie=(0,n.Z)(G.s_,{target:"euzgho52"})({name:"d3v9zr",styles:"overflow:hidden"}),oe=(0,n.Z)(A.Z,{target:"euzgho51"})("margin-right:",(0,W.Z)(.75),";"),ce=(0,n.Z)(Q.Z,{target:"euzgho50"})("padding-top:",(0,W.Z)(1.5),";");function le({location:e,organization:t,transaction:r}){const{tags:n}=r;if(!n||n.length<=0)return null;const s=t.slug,a="/organizations/".concat(s,"/releases/");return(0,Y.BX)("tr",{children:[(0,Y.tZ)("td",{className:"key",children:"Tags"}),(0,Y.tZ)("td",{className:"value",children:(0,Y.tZ)(ce,{children:n.map(((n,i)=>{const{pathname:o,query:c}=(0,J.e1)({orgSlug:s,transaction:r.transaction,projectID:String(r.project_id),query:{...e.query,query:(0,m.os)(e.query.query,n.key,n.value)}});return(0,Y.tZ)(R.Z,{tag:n,projectId:r.project_slug,organization:t,query:c,streamPath:o,releasesPath:a,hasQueryFeature:!1},(0,$.ri)(n.key)?n.key:"tag-pill-".concat(i))}))})})]})}le.displayName="Tags";var de=r("./app/components/count.tsx"),pe=r("./app/components/performance/waterfall/constants.tsx"),ue=r("./app/components/performance/waterfall/row.tsx"),he=r("./app/components/performance/waterfall/rowBar.tsx"),me=r("./app/components/performance/waterfall/rowDivider.tsx"),ge=r("./app/components/performance/waterfall/rowTitle.tsx"),fe=r("./app/components/performance/waterfall/treeConnector.tsx"),xe=r("./app/components/tooltip.tsx"),Ze=r("./app/utils/projects.tsx"),ve=r("../node_modules/react-router/es/index.js"),ye=r("../node_modules/lodash/omit.js"),be=r.n(ye),we=r("./app/components/button.tsx"),Te=r("./app/components/dateTime.tsx"),De=r("./app/components/performance/waterfall/rowDetails.tsx"),Se=r("./app/components/quickTrace/utils.tsx"),Ce=r("./app/utils/discover/urls.tsx"),je=r("./app/utils/performance/vitals/constants.tsx"),_e=r("./app/views/performance/utils.tsx");class Pe extends s.Component{constructor(...e){super(...e),(0,x.Z)(this,"scrollBarIntoView",(e=>t=>{t.preventDefault();const r="#txn-".concat(e);this.props.scrollToHash(r),ve.browserHistory.push({...this.props.location,hash:r})}))}renderTransactionErrors(){const{organization:e,transaction:t}=this.props,{errors:r}=t;return 0===r.length?null:(0,Y.tZ)(v.Z,{system:!0,type:"error",icon:(0,Y.tZ)(q.FC,{size:"md"}),expand:r.map((t=>(0,Y.BX)(De.TV,{children:[(0,Y.tZ)(De._U,{level:t.level}),(0,Y.tZ)(De.wE,{children:t.level}),(0,Y.tZ)(De.St,{children:(0,Y.tZ)(P.Z,{to:(0,Se.F7)(t,e),children:t.title})})]},t.event_id))),children:(0,Y.tZ)(De.CM,{children:(0,l.tn)("An error event occurred in this transaction.","%s error events occurred in this transaction.",r.length)})})}renderGoToTransactionButton(){const{location:e,organization:t,transaction:r}=this.props,n=(0,Ce.JE)({id:r.event_id,project:r.project_slug}),s=(0,_e.DD)(t,n,r.transaction,be()(e.query,Object.values(c.V)));return(0,Y.tZ)(Be,{size:"xsmall",to:s,children:(0,l.t)("View Transaction")})}renderGoToSummaryButton(){const{location:e,organization:t,transaction:r}=this.props,n=(0,J.e1)({orgSlug:t.slug,transaction:r.transaction,query:be()(e.query,Object.values(c.V)),projectID:String(r.project_id)});return(0,Y.tZ)(Be,{size:"xsmall",to:n,children:(0,l.t)("View Summary")})}renderMeasurements(){const{transaction:e}=this.props,{measurements:t={}}=e,r=Object.keys(t).filter((e=>Boolean(je.r["measurements.".concat(e)]))).sort();return r.length<=0?null:(0,Y.tZ)(s.Fragment,{children:r.map((e=>{var r;return(0,Y.tZ)(K.X2,{title:null===(r=je.r["measurements.".concat(e)])||void 0===r?void 0:r.name,children:"".concat(Number(t[e].value.toFixed(3)).toLocaleString(),"ms")},e)}))})}renderTransactionDetail(){const{location:e,organization:t,transaction:r}=this.props,n=Math.min(r.start_timestamp,r.timestamp),a=Math.max(r.start_timestamp,r.timestamp),i="".concat(Number((1e3*(a-n)).toFixed(3)).toLocaleString(),"ms");return(0,Y.tZ)(K.iF,{children:(0,Y.tZ)("table",{className:"table key-value",children:(0,Y.BX)("tbody",{children:[(0,Y.tZ)(K.X2,{title:(0,Y.BX)(Ie,{onClick:this.scrollBarIntoView(r.event_id),children:["Transaction ID",(0,Y.tZ)(ze,{})]}),extra:this.renderGoToTransactionButton(),children:r.event_id}),(0,Y.tZ)(K.X2,{title:"Transaction",extra:this.renderGoToSummaryButton(),children:r.transaction}),(0,Y.tZ)(K.X2,{title:"Transaction Status",children:r["transaction.status"]}),(0,Y.tZ)(K.X2,{title:"Span ID",children:r.span_id}),(0,Y.tZ)(K.X2,{title:"Project",children:r.project_slug}),(0,Y.tZ)(K.X2,{title:"Start Date",children:(0,V.Z)({fixed:"Mar 19, 2021 11:06:27 AM UTC",value:(0,Y.BX)(s.Fragment,{children:[(0,Y.tZ)(Te.Z,{date:1e3*n})," (".concat(n,")")]})})}),(0,Y.tZ)(K.X2,{title:"End Date",children:(0,V.Z)({fixed:"Mar 19, 2021 11:06:28 AM UTC",value:(0,Y.BX)(s.Fragment,{children:[(0,Y.tZ)(Te.Z,{date:1e3*a})," (".concat(a,")")]})})}),(0,Y.tZ)(K.X2,{title:"Duration",children:i}),(0,Y.tZ)(K.X2,{title:"Operation",children:r["transaction.op"]||""}),this.renderMeasurements(),(0,Y.tZ)(le,{location:e,organization:t,transaction:r})]})})})}render(){return(0,Y.BX)(K.wh,{onClick:e=>{e.stopPropagation()},children:[this.renderTransactionErrors(),this.renderTransactionDetail()]})}}Pe.displayName="TransactionDetail";const Ie=(0,n.Z)("a",{target:"eykqe522"})("display:flex;color:",(e=>e.theme.textColor),";:hover{color:",(e=>e.theme.textColor),";}"),ze=(0,n.Z)(q.rS,{target:"eykqe521"})("display:block;color:",(e=>e.theme.gray300),";margin-left:",(0,W.Z)(1),";"),Be=(0,n.Z)(we.ZP,{target:"eykqe520"})("position:absolute;top:",(0,W.Z)(.75),";right:",(0,W.Z)(.5),";"),ke=Pe;class Oe extends s.Component{constructor(...e){super(...e),(0,x.Z)(this,"state",{showDetail:!1}),(0,x.Z)(this,"transactionRowDOMRef",s.createRef()),(0,x.Z)(this,"toggleDisplayDetail",(()=>{const{transaction:e}=this.props;(0,N.Ci)(e)&&this.setState((e=>({showDetail:!e.showDetail})))})),(0,x.Z)(this,"scrollIntoView",(()=>{const e=this.transactionRowDOMRef.current;if(!e)return;const t=e.getBoundingClientRect().top+window.scrollY;this.setState({showDetail:!0},(()=>window.scrollTo(0,t)))}))}getCurrentOffset(){const{transaction:e}=this.props,{generation:t}=e;return Le(t)}renderConnector(e){const{continuingDepths:t,isExpanded:r,isOrphan:n,isLast:s,transaction:a}=this.props,{generation:i}=a,o=(0,N.Ci)(a)?a.event_id:a.traceSlug;if(0===i)return e?(0,Y.tZ)(fe.UV,{style:{right:"16px",height:"10px",bottom:"-5px",top:"auto"},orphanBranch:!1}):null;const c=t.map((({depth:e,isOrphanDepth:t})=>{if(i-e<=1)return null;const r=-1*Le(i-e-1)-1;return(0,Y.tZ)(fe.UV,{style:{left:r},orphanBranch:t},"".concat(o,"-").concat(e))}));return e&&r&&c.push((0,Y.tZ)(fe.UV,{style:{right:"16px",height:"10px",bottom:s?"-".concat(pe.d/2,"px"):"0",top:"auto"},orphanBranch:!1},"".concat(o,"-last"))),(0,Y.tZ)(fe.DN,{isLast:s,hasToggler:e,orphanBranch:n,children:c})}renderToggle(e){const{isExpanded:t,transaction:r,toggleExpandedState:n}=this.props,{children:s,generation:a}=r,i=this.getCurrentOffset();if(s.length<=0)return(0,Y.tZ)(fe.rw,{style:{left:"".concat(i,"px")},children:this.renderConnector(!1)});const o=0===a;return(0,Y.BX)(fe.rw,{style:{left:"".concat(i,"px")},hasToggler:!0,children:[this.renderConnector(!0),(0,Y.BX)(fe.U1,{disabled:o,isExpanded:t,errored:e,onClick:e=>{e.stopPropagation(),o||n()},children:[(0,Y.tZ)(de.Z,{value:s.length}),!o&&(0,Y.tZ)("div",{children:(0,Y.tZ)(fe.Oq,{direction:t?"up":"down"})})]})]})}renderTitle(e){const{generateContentSpanBarRef:t}=e,{organization:r,transaction:n}=this.props,a=this.getCurrentOffset(),i=!!(0,N.Ci)(n)&&n.errors.length>0,o=(0,N.Ci)(n)?(0,Y.BX)(s.Fragment,{children:[(0,Y.tZ)(Ze.Z,{orgId:r.slug,slugs:[n.project_slug],children:({projects:e})=>{const t=e.find((e=>e.slug===n.project_slug));return(0,Y.tZ)(xe.Z,{title:n.project_slug,children:(0,Y.tZ)(oe,{project:t||{slug:n.project_slug},avatarSize:16,hideName:!0})})}}),(0,Y.BX)(ge.rv,{errored:i,children:[(0,Y.BX)("strong",{children:[n["transaction.op"]," — "]}),n.transaction]})]}):(0,Y.BX)(ge.rv,{errored:!1,children:[(0,Y.tZ)("strong",{children:"Trace — "}),n.traceSlug]});return(0,Y.BX)(ge.mw,{ref:t(),children:[this.renderToggle(i),(0,Y.tZ)(ge.Wh,{style:{left:"".concat(a,"px"),width:"100%"},children:o})]})}renderDivider(e){if(this.state.showDetail)return(0,Y.tZ)(me.xN,{showDetail:!0,style:{position:"absolute"}});const{addDividerLineRef:t}=e;return(0,Y.tZ)(me.xN,{ref:t(),style:{position:"absolute"},onMouseEnter:()=>{e.setHover(!0)},onMouseLeave:()=>{e.setHover(!1)},onMouseOver:()=>{e.setHover(!0)},onMouseDown:e.onDragStart,onClick:e=>{e.stopPropagation()}})}renderGhostDivider(e){const{dividerPosition:t,addGhostDividerLineRef:r}=e;return(0,Y.tZ)(me.Hr,{style:{width:"calc(".concat((0,O.yI)(t)," + 0.5px)"),display:"none"},children:(0,Y.tZ)(me.xN,{ref:r(),style:{right:0},className:"hovering",onClick:e=>{e.stopPropagation()}})})}renderErrorBadge(){const{transaction:e}=this.props;return(0,N.Ci)(e)&&e.errors.length?(0,Y.tZ)(me.cS,{}):null}renderRectangle(){const{transaction:e,traceInfo:t,barColor:r}=this.props,{showDetail:n}=this.state,s=Math.abs(t.endTimestamp-t.startTimestamp)||1,a=Math.abs(e.start_timestamp-t.startTimestamp)/s,i=Math.abs(e.timestamp-e.start_timestamp),o=i/s;return(0,Y.tZ)(he.e,{spanBarHatch:!1,style:{backgroundColor:r,left:"min(".concat((0,O.yI)(a||0),", calc(100% - 1px))"),width:(0,O.yI)(o||0)},children:(0,Y.tZ)(he.R,{durationDisplay:(0,O.ud)({left:a,width:o}),showDetail:n,spanBarHatch:!1,children:(0,O.bQ)(i)})})}renderHeader({dividerHandlerChildrenProps:e,scrollbarManagerChildrenProps:t}){const{hasGuideAnchor:r,index:n}=this.props,{showDetail:s}=this.state,{dividerPosition:a}=e;return(0,Y.BX)(ue.Qc,{showDetail:s,children:[(0,Y.tZ)(ue.E5,{"data-test-id":"transaction-row-title","data-type":"span-row-cell",style:{width:"calc(".concat((0,O.yI)(a)," - 0.5px)"),paddingTop:0},showDetail:s,onClick:this.toggleDisplayDetail,children:(0,Y.tZ)(y.Z,{target:"trace_view_guide_row",disabled:!r,children:this.renderTitle(t)})}),(0,Y.BX)(me.kP,{children:[this.renderDivider(e),this.renderErrorBadge()]}),(0,Y.tZ)(ue.E5,{"data-test-id":"transaction-row-duration","data-type":"span-row-cell",showStriping:n%2!=0,style:{width:"calc(".concat((0,O.yI)(1-a)," - 0.5px)"),paddingTop:0},showDetail:s,onClick:this.toggleDisplayDetail,children:(0,Y.tZ)(y.Z,{target:"trace_view_guide_row_details",disabled:!r,children:this.renderRectangle()})}),!s&&this.renderGhostDivider(e)]})}renderDetail(){const{location:e,organization:t,isVisible:r,transaction:n}=this.props,{showDetail:s}=this.state;return(0,Y.tZ)(D.$,{children:({registerScrollFn:a,scrollToHash:i})=>(0,N.Ci)(n)?(a("#txn-".concat(n.event_id),this.scrollIntoView),r&&s?(0,Y.tZ)(ke,{location:e,organization:t,transaction:n,scrollToHash:i}):null):null})}render(){const{isVisible:e,transaction:t}=this.props,{showDetail:r}=this.state;return(0,Y.BX)(ue.X2,{ref:this.transactionRowDOMRef,visible:e,showBorder:r,cursor:(0,N.Ci)(t)?"pointer":"default",children:[(0,Y.tZ)(C.$6,{children:e=>(0,Y.tZ)(S.$,{children:t=>this.renderHeader({dividerHandlerChildrenProps:t,scrollbarManagerChildrenProps:e})})}),this.renderDetail()]})}}function Le(e){return e*(fe.Ll/2)+0}Oe.displayName="TransactionBar";const qe=Oe;class Fe extends s.Component{constructor(...e){super(...e),(0,x.Z)(this,"state",{isExpanded:!0}),(0,x.Z)(this,"toggleExpandedState",(()=>{this.setState((({isExpanded:e})=>({isExpanded:!e})))}))}componentDidUpdate(e,t){t.isExpanded!==this.state.isExpanded&&this.props.updateScrollState()}render(){const{location:e,organization:t,transaction:r,traceInfo:n,continuingDepths:a,isOrphan:i,isLast:o,index:c,isVisible:l,hasGuideAnchor:d,renderedChildren:p,barColor:u}=this.props,{isExpanded:h}=this.state;return(0,Y.BX)(s.Fragment,{children:[(0,Y.tZ)(qe,{location:e,organization:t,index:c,transaction:r,traceInfo:n,continuingDepths:a,isOrphan:i,isLast:o,isExpanded:h,toggleExpandedState:this.toggleExpandedState,isVisible:l,hasGuideAnchor:d,barColor:u}),h&&p]})}}Fe.displayName="TransactionGroup";const Me=(0,C.Iw)(Fe);var Ve=r("./app/views/performance/traceDetails/utils.tsx");class Ne extends s.Component{constructor(...e){super(...e),(0,x.Z)(this,"state",{searchQuery:void 0,filteredTransactionIds:void 0}),(0,x.Z)(this,"traceViewRef",s.createRef()),(0,x.Z)(this,"virtualScrollbarContainerRef",s.createRef()),(0,x.Z)(this,"handleTransactionFilter",(e=>{this.setState({searchQuery:e||void 0},this.filterTransactions)})),(0,x.Z)(this,"filterTransactions",(async()=>{const{traces:e}=this.props,{filteredTransactionIds:t,searchQuery:r}=this.state;if(!r||null===e||e.length<=0)return void(void 0!==t&&this.setState({filteredTransactionIds:void 0}));const n=e.flatMap((e=>(0,N.S2)(e,((e,t)=>{const r=[t["transaction.op"],t.transaction,t.project_slug];return e.push({transaction:t,indexed:r}),e}),[]))),s=(await(0,F.I)(n,{keys:["indexed"],includeMatches:!0,threshold:.6,location:0,distance:100,maxPatternLength:32})).search(r).filter((({matches:e})=>e.length)).map((({item:e})=>e.transaction.event_id)),a=e.flatMap((e=>(0,N.xB)(e,(({event_id:e,span_id:t})=>e.includes(r)||t.includes(r))))).map((e=>e.event_id));this.setState({filteredTransactionIds:new Set([...s,...a])})})),(0,x.Z)(this,"isTransactionVisible",(e=>{const{filteredTransactionIds:t}=this.state;return!t||t.has(e.event_id)}))}renderTraceLoading(){return(0,Y.tZ)(z.Z,{})}renderTraceRequiresDateRangeSelection(){return(0,Y.tZ)(I.Z,{message:(0,l.t)("Trace view requires a date range selection.")})}renderTraceNotFound(){var e,t;const{meta:r}=this.props,n=null!==(e=null==r?void 0:r.transactions)&&void 0!==e?e:0,s=null!==(t=null==r?void 0:r.errors)&&void 0!==t?t:0;return 0===n&&s>0?(0,Y.tZ)(I.Z,{message:(0,l.t)("The trace you are looking contains only errors.")}):(0,Y.tZ)(I.Z,{message:(0,l.t)("The trace you are looking for was not found.")})}renderSearchBar(){return(0,Y.tZ)(ee,{children:(0,Y.tZ)(te,{defaultQuery:"",query:this.state.searchQuery||"",placeholder:(0,l.t)("Search for transactions"),onSearch:this.handleTransactionFilter})})}renderTraceHeader(e){var t,r,n;const{meta:s}=this.props;return(0,Y.BX)(ne,{children:[(0,Y.tZ)(y.Z,{target:"trace_view_guide_breakdown",children:(0,Y.tZ)(H.U,{headingText:(0,l.t)("Event Breakdown"),tooltipText:(0,l.t)("The number of transactions and errors there are in this trace."),bodyText:(0,l._N)("[transactions]  |  [errors]",{transactions:(0,l.tn)("%s Transaction","%s Transactions",null!==(t=null==s?void 0:s.transactions)&&void 0!==t?t:e.transactions.size),errors:(0,l.tn)("%s Error","%s Errors",null!==(r=null==s?void 0:s.errors)&&void 0!==r?r:e.errors.size)}),subtext:(0,l.tn)("Across %s project","Across %s projects",null!==(n=null==s?void 0:s.projects)&&void 0!==n?n:e.projects.size)})}),(0,Y.tZ)(H.U,{headingText:(0,l.t)("Total Duration"),tooltipText:(0,l.t)("The time elapsed between the start and end of this trace."),bodyText:(0,M.g9)(e.endTimestamp-e.startTimestamp,2,!0),subtext:(0,V.Z)({value:(0,Y.tZ)(L.Z,{date:1e3*(e.endTimestamp||0)}),fixed:"5 days ago"})})]})}renderTraceWarnings(){const{traces:e}=this.props,{roots:t,orphans:r}=(null!=e?e:[]).reduce(((e,t)=>((0,Ve.uM)(t)?e.roots++:e.orphans++,e)),{roots:0,orphans:0});let n=null;return 0===t&&r>0?n=(0,Y.tZ)(v.Z,{type:"info",icon:(0,Y.tZ)(q.aU,{size:"sm"}),children:(0,Y.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,l.t)("A root transaction is missing. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):1===t&&r>0?n=(0,Y.tZ)(v.Z,{type:"info",icon:(0,Y.tZ)(q.aU,{size:"sm"}),children:(0,Y.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#orphan-traces-and-broken-subtraces",children:(0,l.t)("This trace has broken subtraces. Transactions linked by a dashed line have been orphaned and cannot be directly linked to the root.")})}):t>1&&(n=(0,Y.tZ)(v.Z,{type:"info",icon:(0,Y.tZ)(q.aU,{size:"sm"}),children:(0,Y.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/trace-view/#multiple-roots",children:(0,l.t)("Multiple root transactions have been found with this trace ID.")})})),n}renderInfoMessage({isVisible:e,numberOfHiddenTransactionsAbove:t}){const r=[];return e&&(1===t?r.push((0,Y.tZ)("span",{children:(0,l._N)("[numOfTransaction] hidden transaction",{numOfTransaction:(0,Y.tZ)("strong",{children:t})})},"stuff")):t>1&&r.push((0,Y.tZ)("span",{children:(0,l._N)("[numOfTransaction] hidden transactions",{numOfTransaction:(0,Y.tZ)("strong",{children:t})})},"stuff"))),r.length<=0?null:(0,Y.tZ)(B.V,{children:r})}renderLimitExceededMessage(e){var t;const{traceEventView:r,organization:n,meta:s}=this.props,a=e.transactions.size,i=null!==(t=null==s?void 0:s.transactions)&&void 0!==t?t:a;if(null===i||a>=i)return null;const o=r.getResultsViewUrlTarget(n.slug);return(0,Y.tZ)(B.V,{children:(0,l._N)("Limited to a view of [count] transactions. To view the full list, [discover].",{count:a,discover:(0,Y.tZ)(w.Z,{children:({hasFeature:e})=>(0,Y.tZ)(P.Z,{disabled:!e,to:o,children:"Open in Discover"})})})})}renderTransaction(e,{continuingDepths:t,isOrphan:r,isLast:n,index:a,numberOfHiddenTransactionsAbove:i,traceInfo:o,hasGuideAnchor:c}){const{location:l,organization:d}=this.props,{children:p,event_id:u}=e,h=e.generation+1,m=this.isTransactionVisible(e),g=p.reduce(((e,n,s)=>{const a=s===p.length-1,i=n.children.length>0,c=this.renderTransaction(n,{continuingDepths:!a&&i?[...t,{depth:h,isOrphanDepth:r}]:t,isOrphan:r,isLast:a,index:e.lastIndex+1,numberOfHiddenTransactionsAbove:e.numberOfHiddenTransactionsAbove,traceInfo:o,hasGuideAnchor:!1});return e.lastIndex=c.lastIndex,e.numberOfHiddenTransactionsAbove=c.numberOfHiddenTransactionsAbove,e.renderedChildren.push(c.transactionGroup),e}),{renderedChildren:[],lastIndex:a,numberOfHiddenTransactionsAbove:m?0:i+1});return{transactionGroup:(0,Y.BX)(s.Fragment,{children:[this.renderInfoMessage({isVisible:m,numberOfHiddenTransactionsAbove:i}),(0,Y.tZ)(Me,{location:l,organization:d,traceInfo:o,transaction:{...e,generation:h},continuingDepths:t,isOrphan:r,isLast:n,index:a,isVisible:m,hasGuideAnchor:c,renderedChildren:g.renderedChildren,barColor:(0,O.hd)(e["transaction.op"])})]},u),lastIndex:g.lastIndex,numberOfHiddenTransactionsAbove:g.numberOfHiddenTransactionsAbove}}renderTraceView(e){var t;const r=null===(t=Z.Gd().getScope())||void 0===t?void 0:t.getTransaction(),n=null==r?void 0:r.startChild({op:"trace.render",description:"trace-view-content"}),{location:s,organization:a,traces:i,traceSlug:o}=this.props;if(null===i||i.length<=0)return this.renderTraceNotFound();const c={index:1,numberOfHiddenTransactionsAbove:0,traceInfo:e,transactionGroups:[]},{transactionGroups:l,numberOfHiddenTransactionsAbove:d}=i.reduce(((e,t,r)=>{const n=r===i.length-1,s=t.children.length>0,a=!n&&null!==i[r+1].parent_span_id,o=this.renderTransaction(t,{...e,isOrphan:!(0,Ve.uM)(t),isLast:n,continuingDepths:!n&&s?[{depth:0,isOrphanDepth:a}]:[],hasGuideAnchor:0===r});return e.index=o.lastIndex+1,e.numberOfHiddenTransactionsAbove=o.numberOfHiddenTransactionsAbove,e.transactionGroups.push(o.transactionGroup),e}),c),p=(0,Y.tZ)(se,{children:(0,Y.tZ)(S.z,{interactiveLayerRef:this.traceViewRef,children:(0,Y.tZ)(S.$,{children:({dividerPosition:t})=>(0,Y.tZ)(C.zt,{dividerPosition:t,interactiveLayerRef:this.virtualScrollbarContainerRef,children:(0,Y.BX)(ie,{children:[(0,Y.BX)(re,{children:[(0,Y.tZ)(C.$6,{children:({virtualScrollbarRef:e,scrollBarAreaRef:r,onDragStart:n,onScroll:s})=>(0,Y.BX)(k.cs,{ref:this.virtualScrollbarContainerRef,style:{width:"calc(".concat((0,O.yI)(t)," - 0.5px)")},onScroll:s,children:[(0,Y.tZ)("div",{style:{width:0,height:"1px"},ref:r}),(0,Y.tZ)(k.Qk,{"data-type":"virtual-scrollbar",ref:e,onMouseDown:n,children:(0,Y.tZ)(k.v6,{})})]})}),(0,Y.tZ)(k._i,{})]}),(0,Y.BX)(ae,{ref:this.traceViewRef,children:[(0,Y.tZ)(D.z,{children:(0,Y.tZ)(Me,{location:s,organization:a,traceInfo:e,transaction:{traceSlug:o,generation:0,"transaction.duration":e.endTimestamp-e.startTimestamp,children:i,start_timestamp:e.startTimestamp,timestamp:e.endTimestamp},continuingDepths:[],isOrphan:!1,isLast:!1,index:0,isVisible:!0,hasGuideAnchor:!1,renderedChildren:l,barColor:(0,O.hd)("")})}),this.renderInfoMessage({isVisible:!0,numberOfHiddenTransactionsAbove:d}),this.renderLimitExceededMessage(e)]})]})})})})});return null==n||n.finish(),p}renderContent(){const{dateSelected:e,isLoading:t,error:r,traces:n}=this.props;if(e){if(t)return this.renderTraceLoading();if(null!==r||null===n||n.length<=0)return this.renderTraceNotFound();{const e=(0,Ve.Rg)(n);return(0,Y.BX)(s.Fragment,{children:[this.renderTraceWarnings(),this.renderTraceHeader(e),this.renderSearchBar(),this.renderTraceView(e)]})}}return this.renderTraceRequiresDateRangeSelection()}render(){const{organization:e,location:t,traceEventView:r,traceSlug:n}=this.props;return(0,Y.BX)(s.Fragment,{children:[(0,Y.BX)(j.h4,{children:[(0,Y.BX)(j.oB,{children:[(0,Y.tZ)(E.Z,{organization:e,location:t,traceSlug:n}),(0,Y.tZ)(j.Dx,{"data-test-id":"trace-header",children:(0,l.t)("Trace ID: %s",n)})]}),(0,Y.tZ)(j.kP,{children:(0,Y.tZ)(b.ZP,{gap:1,children:(0,Y.tZ)(T.Z,{to:r.getResultsViewUrlTarget(e.slug),children:"Open in Discover"})})})]}),(0,Y.tZ)(j.uT,{children:(0,Y.tZ)(j.or,{fullWidth:!0,children:this.renderContent()})})]})}}Ne.displayName="TraceDetailsContent";const Ee=Ne;class He extends s.Component{getDocumentTitle(){return[(0,l.t)("Trace Details"),(0,l.t)("Performance")].join(" - ")}getTraceSlug(){const{traceSlug:e}=this.props.params;return"string"==typeof e?e.trim():""}getDateSelection(){const{location:e}=this.props,t=(0,i.Q)(e.query,{allowAbsolutePageDatetime:!0});return{start:(0,m.ro)(t.start),end:(0,m.ro)(t.end),statsPeriod:(0,m.ro)(t.statsPeriod)}}getTraceEventView(){const e=this.getTraceSlug(),{start:t,end:r,statsPeriod:n}=this.getDateSelection();return p.ZP.fromSavedQuery({id:void 0,name:"Events with Trace ID ".concat(e),fields:["title","event.type","project","timestamp"],orderby:"-timestamp",query:"trace:".concat(e),projects:[c.mP],version:2,start:t,end:r,range:n})}renderContent(){const{location:e,organization:t,params:r}=this.props,n=this.getTraceSlug(),{start:s,end:a,statsPeriod:i}=this.getDateSelection(),o=Boolean(i||s&&a),c=({isLoading:s,error:a,traces:i,meta:c})=>(0,Y.tZ)(Ee,{location:e,organization:t,params:r,traceSlug:n,traceEventView:this.getTraceEventView(),dateSelected:o,isLoading:s,error:a,traces:i,meta:c});return o?(0,Y.tZ)(u.H,{location:e,orgSlug:t.slug,traceId:n,start:s,end:a,statsPeriod:i,children:r=>(0,Y.tZ)(h.Z,{location:e,orgSlug:t.slug,traceId:n,start:s,end:a,statsPeriod:i,children:e=>c({isLoading:r.isLoading||e.isLoading,error:r.error||e.error,traces:r.traces,meta:e.meta})})}):c({isLoading:!1,error:"date selection not specified",traces:null,meta:null})}render(){const{organization:e}=this.props;return(0,Y.tZ)(o.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,children:(0,Y.tZ)(Xe,{children:(0,Y.tZ)(a.Z,{organization:e,children:this.renderContent()})})})}}He.displayName="TraceSummary";const Re=(0,f.Z)((0,g.Z)(He)),Xe=(0,n.Z)(d.JH,{target:"eqzhpg90"})({name:"1hcx8jb",styles:"padding:0"})},"./app/views/performance/transactionDetails/styles.tsx":(e,t,r)=>{"use strict";r.d(t,{U:()=>l});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(r("../node_modules/react/index.js"),r("./app/components/charts/styles.tsx")),a=r("./app/components/featureBadge.tsx"),i=r("./app/components/questionTooltip.tsx"),o=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({headingText:e,tooltipText:t,bodyText:r,subtext:n,badge:s}){return(0,c.BX)(d,{children:[(0,c.BX)(p,{children:[e,(0,c.tZ)(i.Z,{position:"top",size:"sm",containerDisplayMode:"block",title:t}),s&&(0,c.tZ)(h,{type:s})]}),(0,c.tZ)(u,{children:r}),(0,c.tZ)(m,{children:n})]})}l.displayName="MetaData";const d=(0,n.Z)("div",{target:"eqz9f144"})({name:"4ks2md",styles:"height:78px"}),p=(0,n.Z)(s.OT,{target:"eqz9f143"})({name:"ti75j2",styles:"margin:0"}),u=(0,n.Z)("div",{target:"eqz9f142"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";padding:",(0,o.Z)(.5)," 0;max-height:32px;"),h=(0,n.Z)(a.Z,{target:"eqz9f141"})({name:"ti75j2",styles:"margin:0"}),m=(0,n.Z)("div",{target:"eqz9f140"})("color:",(e=>"error"===e.type?e.theme.error:e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";")},"./app/views/performance/transactionSummary/transactionVitals/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{Pl:()=>s,oZ:()=>a,eH:()=>i,L0:()=>o,jb:()=>c});var n=r("./app/utils/performance/histogram/utils.tsx");function s({orgSlug:e,transaction:t,projectID:r,query:n}){return{pathname:function({orgSlug:e}){return"/organizations/".concat(e,"/performance/summary/vitals/")}({orgSlug:e}),query:{transaction:t,project:r,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}function a(e,t){const r=(0,n.te)(e);return!e.length||t>=e[e.length-1].bin+r?null:t<e[0].bin?-1:Math.floor((t-e[0].bin)/r)}function i(e){if(e.length<2)return null;for(let t=0;t<e.length;t++){const r=e[t];for(let n=t+1;n<e.length;n++){const s=e[n];if(r.bin!==s.bin&&r.count!==s.count)return{point1:{x:t,y:Math.min(r.count,s.count)},point2:{x:n,y:Math.max(r.count,s.count)}}}}return{point1:{x:0,y:0},point2:{x:1,y:1}}}function o(e,t){const r=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point1.x,t.point1.y]);if(isNaN(null==r?void 0:r[0])||isNaN(null==r?void 0:r[1]))return null;const n=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point2.x,t.point2.y]);return isNaN(null==n?void 0:n[0])||isNaN(null==n?void 0:n[1])?null:{point1:{x:r[0],y:r[1]},point2:{x:n[0],y:n[1]}}}function c(e,t,r){if(t.point1.x===t.point2.x||t.point1.y===t.point2.y||r.point1.x===r.point2.x||r.point1.y===r.point2.y)return null;const n=(e.x-t.point1.x)/(t.point2.x-t.point1.x),s=(e.y-t.point1.y)/(t.point2.y-t.point1.y);return{x:r.point1.x+(r.point2.x-r.point1.x)*n,y:r.point1.y+(r.point2.y-r.point1.y)*s}}},"./app/views/performance/vitalDetail/utils.tsx":(e,t,r)=>{"use strict";r.d(t,{eE:()=>o,MN:()=>c,SP:()=>l,fL:()=>d,Np:()=>p,i4:()=>u,iF:()=>h,Ve:()=>m,q4:()=>g,jo:()=>f,il:()=>x,a7:()=>Z,vk:()=>v}),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js");var n=r("./app/icons/index.tsx"),s=r("./app/utils/discover/fields.tsx"),a=r("./app/utils/queryString.tsx"),i=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o={[s.Zl.FP]:3e3,[s.Zl.FCP]:3e3,[s.Zl.LCP]:4e3,[s.Zl.FID]:300,[s.Zl.CLS]:.25},c={[s.Zl.FP]:1e3,[s.Zl.FCP]:1e3,[s.Zl.LCP]:2500,[s.Zl.FID]:100,[s.Zl.CLS]:.1};let l;!function(e){e.POOR="Poor",e.MEH="Meh",e.GOOD="Good"}(l||(l={}));const d={[l.POOR]:"red300",[l.MEH]:"yellow300",[l.GOOD]:"green300"},p={[l.POOR]:(0,i.tZ)(n.zC,{color:d[l.POOR]}),[l.MEH]:(0,i.tZ)(n.FC,{color:d[l.MEH]}),[l.GOOD]:(0,i.tZ)(n.DL,{color:d[l.GOOD],isCircled:!0})};function u({orgSlug:e,vitalName:t,projectID:r,query:n}){return{pathname:function({orgSlug:e}){return"/organizations/".concat(e,"/performance/vitaldetail/")}({orgSlug:e}),query:{vitalName:t,project:r,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:n.query}}}function h(e){const t=(0,a.ro)(e.query.vitalName);return Object.values(s.Zl).find((e=>e===t))||s.Zl.LCP}function m(e){const t=o[e];return"compare_numeric_aggregate(".concat((0,s.LY)("p75(".concat(e,")")),",greater,").concat(t,")")}function g(e){const t=c[e];return"compare_numeric_aggregate(".concat((0,s.LY)("p75(".concat(e,")")),",greater,").concat(t,")")}const f={[s.Zl.FCP]:"First Contentful Paint",[s.Zl.CLS]:"Cumulative Layout Shift",[s.Zl.FID]:"First Input Delay",[s.Zl.LCP]:"Largest Contentful Paint"},x={[s.Zl.FCP]:"First Contentful Paint (FCP) measures the amount of time the first content takes to render in the viewport. Like FP, this could also show up in any form from the document object model (DOM), such as images, SVGs, or text blocks.",[s.Zl.CLS]:"Cumulative Layout Shift (CLS) is the sum of individual layout shift scores for every unexpected element shift during the rendering process. Imagine navigating to an article and trying to click a link before the page finishes loading. Before your cursor even gets there, the link may have shifted down due to an image rendering. Rather than using duration for this Web Vital, the CLS score represents the degree of disruptive and visually unstable shifts.",[s.Zl.FID]:"First Input Delay measures the response time when the user tries to interact with the viewport. Actions maybe include clicking a button, link or other custom Javascript controller. It is key in helping the user determine if a page is usable or not.",[s.Zl.LCP]:"Largest Contentful Paint (LCP) measures the render time for the largest content to appear in the viewport. This may be in any form from the document object model (DOM), such as images, SVGs, or text blocks. It’s the largest pixel area in the viewport, thus most visually defining. LCP helps developers understand how long it takes to see the main content on the page."},Z={[s.Zl.FCP]:"FCP",[s.Zl.CLS]:"CLS",[s.Zl.FID]:"FID",[s.Zl.LCP]:"LCP"};function v(e){let t=-1/0;for(const{data:r}of e)for(const e of r)t=Math.max(t,e.value);return t}},"../node_modules/lodash/isFinite.js":(e,t,r)=>{var n=r("../node_modules/lodash/_root.js").isFinite;e.exports=function(e){return"number"==typeof e&&n(e)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_traceDetails_index_tsx-node_modules_lodash_isFinite_js.e6491271db6fa01ab7c617f0f657f35c.js.map