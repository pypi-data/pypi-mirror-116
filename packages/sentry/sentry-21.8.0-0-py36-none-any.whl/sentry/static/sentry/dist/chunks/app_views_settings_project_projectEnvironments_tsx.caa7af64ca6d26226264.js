"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_project_projectEnvironments_tsx","app_components_sentryDocumentTitle_tsx"],{"./app/components/sentryDocumentTitle.tsx":(e,t,n)=>{n.d(t,{Z:()=>r}),n("../node_modules/react/index.js");var s=n("../node_modules/react-document-title/index.js"),o=n.n(s),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a({title:e,orgSlug:t,projectSlug:n,children:s}){const a=t||n?t&&n?"".concat(e," - ").concat(t," - ").concat(n):t?"".concat(e," - ").concat(t):"".concat(e," - ").concat(n):e;return(0,i.tZ)(o(),{title:"".concat(a," - Sentry"),children:s})}a.displayName="SentryDocumentTitle";const r=a},"./app/utils/environment.tsx":(e,t,n)=>{function s(e){return e.name?encodeURIComponent(e.name):e.displayName?encodeURIComponent(e.displayName):"none"}function o(e){return e.name||e.displayName||"(No Environment)"}n.d(t,{z:()=>s,G:()=>o})},"./app/utils/recreateRoute.tsx":(e,t,n)=>{n.d(t,{Z:()=>a});var s=n("../node_modules/lodash/findLastIndex.js"),o=n.n(s),i=n("./app/utils/replaceRouterParams.tsx");function a(e,t){var n,s;const{routes:a,params:r,location:c,stepBack:d}=t,p=a.map((({path:e})=>e||""));let m,l;"string"!=typeof e?(l=a.indexOf(e)+1,m=o()(p.slice(0,l),(e=>"/"===e[0]))):m=o()(p,(e=>"/"===e[0]));let h=p.slice(m,l);void 0!==d&&(h=h.slice(0,d));const u=null!==(n=null==c?void 0:c.search)&&void 0!==n?n:"",v=null!==(s=null==c?void 0:c.hash)&&void 0!==s?s:"",x="".concat(h.join("")).concat("string"!=typeof e?"":e).concat(u).concat(v);return(0,i.Z)(x,r)}},"./app/views/settings/project/permissionAlert.tsx":(e,t,n)=>{n.d(t,{Z:()=>d}),n("../node_modules/react/index.js");var s=n("./app/components/acl/access.tsx"),o=n("./app/components/alert.tsx"),i=n("./app/icons/index.tsx"),a=n("./app/locale.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=({access:e=["project:write"],...t})=>(0,r.tZ)(s.Z,{access:e,children:({hasAccess:e})=>!e&&(0,r.tZ)(o.Z,{type:"warning",icon:(0,r.tZ)(i.FC,{size:"xs"}),...t,children:(0,a.t)("These settings can only be edited by users with the organization owner, manager, or admin role.")})});c.displayName="PermissionAlert";const d=c},"./app/views/settings/project/projectEnvironments.tsx":(e,t,n)=>{n.r(t),n.d(t,{ProjectEnvironments:()=>f,default:()=>N});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),a=n("./app/actionCreators/indicator.tsx"),r=n("./app/components/acl/access.tsx"),c=n("./app/components/button.tsx"),d=n("./app/components/links/listLink.tsx"),p=n("./app/components/loadingIndicator.tsx"),m=n("./app/components/navTabs.tsx"),l=n("./app/components/panels/index.tsx"),h=n("./app/components/sentryDocumentTitle.tsx"),u=n("./app/constants/index.tsx"),v=n("./app/locale.tsx"),x=n("./app/styles/space.tsx"),Z=n("./app/utils/environment.tsx"),g=n("./app/utils/recreateRoute.tsx"),j=n("./app/utils/withApi.tsx"),y=n("./app/views/settings/components/emptyMessage.tsx"),w=n("./app/views/settings/components/settingsPageHeader.tsx"),b=n("./app/views/settings/project/permissionAlert.tsx"),_=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class f extends i.Component{constructor(...e){super(...e),(0,s.Z)(this,"state",{project:null,environments:null,isLoading:!0}),(0,s.Z)(this,"toggleEnv",((e,t)=>{const{orgId:n,projectId:s}=this.props.params;this.props.api.request("/projects/".concat(n,"/").concat(s,"/environments/").concat((0,Z.z)(e),"/"),{method:"PUT",data:{name:e.name,isHidden:t},success:()=>{(0,a.S9)((0,v._N)("Updated [environment]",{environment:(0,Z.G)(e)}))},error:()=>{(0,a.Iw)((0,v._N)("Unable to update [environment]",{environment:(0,Z.G)(e)}))},complete:this.fetchData.bind(this)})}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){this.props.location.pathname.endsWith("hidden/")!==e.location.pathname.endsWith("hidden/")&&this.fetchData()}fetchData(){const e=this.props.location.pathname.endsWith("hidden/");this.state.isLoading||this.setState({isLoading:!0});const{orgId:t,projectId:n}=this.props.params;this.props.api.request("/projects/".concat(t,"/").concat(n,"/environments/"),{query:{visibility:e?"hidden":"visible"},success:e=>{this.setState({environments:e,isLoading:!1})}})}fetchProjectDetails(){const{orgId:e,projectId:t}=this.props.params;this.props.api.request("/projects/".concat(e,"/").concat(t,"/"),{success:e=>{this.setState({project:e})}})}renderEmpty(){const e=this.props.location.pathname.endsWith("hidden/")?(0,v.t)("You don't have any hidden environments."):(0,v.t)("You don't have any environments yet.");return(0,_.tZ)(y.Z,{children:e})}renderAllEnvironmentsSystemRow(){return this.props.location.pathname.endsWith("hidden/")?null:(0,_.tZ)(E,{name:u.UZ,environment:{id:u.UZ,name:u.UZ,displayName:u.UZ},isSystemRow:!0})}renderEnvironmentList(e){const t=this.props.location.pathname.endsWith("hidden/"),n=t?(0,v.t)("Show"):(0,v.t)("Hide");return(0,_.BX)(i.Fragment,{children:[this.renderAllEnvironmentsSystemRow(),e.map((e=>(0,_.tZ)(E,{name:e.name,environment:e,isHidden:t,onHide:this.toggleEnv,actionText:n,shouldShowAction:!0},e.id)))]})}renderBody(){const{environments:e,isLoading:t}=this.state;return t?(0,_.tZ)(p.Z,{}):(0,_.tZ)(l.N,{children:null!=e&&e.length?this.renderEnvironmentList(e):this.renderEmpty()})}render(){const{routes:e,params:t,location:n}=this.props,s=n.pathname.endsWith("hidden/"),o=(0,g.Z)("",{routes:e,params:t,stepBack:-1});return(0,_.BX)("div",{children:[(0,_.tZ)(h.Z,{title:(0,v.t)("Environments"),projectSlug:t.projectId}),(0,_.tZ)(w.Z,{title:(0,v.t)("Manage Environments"),tabs:(0,_.BX)(m.Z,{underlined:!0,children:[(0,_.tZ)(d.Z,{to:o,index:!0,isActive:()=>!s,children:(0,v.t)("Environments")}),(0,_.tZ)(d.Z,{to:"".concat(o,"hidden/"),index:!0,isActive:()=>s,children:(0,v.t)("Hidden")})]})}),(0,_.tZ)(b.Z,{}),(0,_.BX)(l.s_,{children:[(0,_.tZ)(l.V9,{children:s?(0,v.t)("Hidden"):(0,v.t)("Active Environments")}),this.renderBody()]})]})}}function E({environment:e,name:t,onHide:n,shouldShowAction:s=!1,isSystemRow:o=!1,isHidden:a=!1,actionText:c=""}){return(0,_.BX)(S,{children:[(0,_.tZ)(A,{children:o?(0,v.t)("All Environments"):t}),(0,_.tZ)(r.Z,{access:["project:write"],children:({hasAccess:t})=>(0,_.tZ)(i.Fragment,{children:s&&n&&(0,_.tZ)(I,{size:"xsmall",disabled:!t,onClick:()=>n(e,!a),children:c})})})]})}f.displayName="ProjectEnvironments",E.displayName="EnvironmentRow";const S=(0,o.Z)(l.Lv,{target:"e1heia562"})({name:"1tz8p38",styles:"align-items:center;justify-content:space-between"}),A=(0,o.Z)("div",{target:"e1heia561"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),I=(0,o.Z)(c.ZP,{target:"e1heia560"})("margin-left:",(0,x.Z)(.5),";"),N=(0,j.Z)(f)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_projectEnvironments_tsx.e2c1293b10b0836ea5e1eaac065dbe07.js.map