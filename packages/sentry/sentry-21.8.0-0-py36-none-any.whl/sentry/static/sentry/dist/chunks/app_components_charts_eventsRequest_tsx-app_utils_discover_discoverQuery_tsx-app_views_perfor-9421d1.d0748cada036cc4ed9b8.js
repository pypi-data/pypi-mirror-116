(self.webpackChunk=self.webpackChunk||[]).push([["app_components_charts_eventsRequest_tsx-app_utils_discover_discoverQuery_tsx-app_views_perfor-9421d1"],{"./app/actionCreators/events.tsx":(e,t,s)=>{"use strict";s.d(t,{lI:()=>l,eV:()=>c,JE:()=>d}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/lodash/pick.js"),r=s.n(a),i=s("./app/components/charts/utils.tsx"),n=s("./app/utils/getPeriod.tsx"),o=s("./app/utils/performance/constants.tsx");const l=(e,{organization:t,project:s,environment:a,team:r,period:o,start:l,end:c,interval:d,includePrevious:u,query:p,yAxis:m,field:h,topEvents:v,orderby:g,partial:f,withoutZerofill:x})=>{const y=(0,i.Sw)(u,o),Z=Object.fromEntries(Object.entries({interval:d,project:s,environment:a,team:r,query:p,yAxis:m,field:h,topEvents:v,orderby:g,partial:f?"1":void 0,withoutZerofill:x?"1":void 0}).filter((([,e])=>void 0!==e))),j=(0,n.X)({period:o,start:l,end:c},{shouldDoublePeriod:y});return e.requestPromise("/organizations/".concat(t.slug,"/events-stats/"),{query:{...Z,...j}})};async function c(e,t,s){const a={...r()(s,Object.values(o.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:a})}async function d(e,t,s){const a={...r()(s,Object.values(o.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:a}).then((e=>e.count))}},"./app/components/charts/components/markLine.tsx":(e,t,s)=>{"use strict";function a(e){return{symbol:["none","none"],...e}}s.d(t,{Z:()=>a}),s("../node_modules/echarts/lib/component/markLine.js")},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>x});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.reduce.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/isEqual.js"),n=s.n(i),o=s("../node_modules/lodash/omitBy.js"),l=s.n(o),c=s("./app/actionCreators/events.tsx"),d=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/charts/loadingPanel.tsx"),p=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=["api","children","organization","loading"],g=e=>l()(e,((e,t)=>v.includes(t)));class f extends r.PureComponent{constructor(...e){super(...e),(0,a.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,a.Z)(this,"unmounting",!1),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:s,name:a,hideError:r,...i}=this.props;let n=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1}))),s)(0,d.Iw)((0,m.t)("%s has an invalid date range. Please try a more recent date range.",a),{append:!0}),this.setState({errored:!0});else try{e.clear(),n=await(0,c.lI)(e,i)}catch(e){r||(e&&e.responseJSON&&e.responseJSON.detail?(0,d.Iw)(e.responseJSON.detail):(0,d.Iw)((0,m.t)("Error loading chart data"))),this.setState({errored:!0})}this.unmounting||this.setState({reloading:!1,timeseriesData:n,fetchedWithPrevious:i.includePrevious})}})),(0,a.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:a}=this.props,r=t||(0,p.Sw)(a,s),i=Math.floor(e.length/2);return{current:r?e.slice(i):e,previous:r?e.slice(0,i):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){n()(g(e),g(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e,t=(e=>1e3*e)){return e.map((([e,s],a)=>({name:t(e,s,a),value:s.reduce(((e,{count:t})=>e+t),0)})))}transformPreviousPeriodData(e,t){var s;return t?{seriesName:null!==(s=this.props.previousSeriesName)&&void 0!==s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,a)=>1e3*e[a][0]))}:null}transformAggregatedTimeseries(e,t=""){return{seriesName:t,data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{count:t})=>e+t),0)})))}]}processData(e){if(!e)return{};const{data:t,totals:s}=e,{includeTransformedData:a,includeTimeAggregation:r,timeAggregationSeriesName:i}=this.props,{current:n,previous:o}=this.getData(t);return{data:a?this.transformTimeseriesData(n,this.props.currentSeriesName):[],allData:t,originalData:n,totals:s,originalPreviousData:o,previousData:a?this.transformPreviousPeriodData(n,o):null,timeAggregatedData:r?this.transformAggregatedTimeseries(n,i||""):{},timeframe:e.start&&e.end?{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{timeseriesData:a,reloading:r,errored:i}=this.state,n=this.props.loading||null===a;if(t&&n)return(0,h.tZ)(u.Z,{"data-test-id":"events-request-loading"});if((0,p.Xe)(a)){let t;return e({loading:n,reloading:r,errored:i,results:Object.keys(a).map((e=>{const s=a[e];s.start&&s.end&&!t&&(t={start:1e3*s.start,end:1e3*s.end});const r=this.transformTimeseriesData(s.data,e)[0];return[s.order||0,r]})).sort(((e,t)=>e[0]-t[0])).map((e=>e[1])),timeframe:t,...s})}const{data:o,allData:l,originalData:c,totals:d,originalPreviousData:m,previousData:v,timeAggregatedData:g,timeframe:f}=this.processData(a);return e({loading:n,reloading:r,errored:i,timeseriesData:o,allTimeseriesData:l,originalTimeseriesData:c,timeseriesTotals:d,originalPreviousTimeseriesData:m,previousTimeseriesData:v,timeAggregatedData:g,timeframe:f,...s})}}f.displayName="EventsRequest",(0,a.Z)(f,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const x=f},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/react/index.js"),s("./app/components/loadingMask.tsx")),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const n=(0,a.Z)((({className:e,visible:t,children:s,...a})=>{const n=t?{...a,"data-test-id":"loading-placeholder"}:a;return(0,i.tZ)(r.Z,{className:e,...n,children:s})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/discover/discoverFeature.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c}),s("../node_modules/react/index.js");var a=s("./app/components/acl/feature.tsx"),r=s("./app/components/acl/featureDisabled.tsx"),i=s("./app/components/hovercard.tsx"),n=s("./app/locale.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({children:e}){const t=(0,n.t)("Requires discover feature.");return(0,o.tZ)(a.Z,{hookName:"feature-disabled:open-discover",features:["organizations:discover-basic"],renderDisabled:e=>(0,o.tZ)(i.ZP,{body:(0,o.tZ)(r.Z,{features:e.features,hideHelpToggle:!0,message:t,featureName:t}),children:e.children(e)}),children:({hasFeature:t})=>e({hasFeature:t})})}l.displayName="DiscoverFeature";const c=l},"./app/components/discoverButton.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o}),s("../node_modules/react/index.js");var a=s("./app/components/button.tsx"),r=s("./app/components/discover/discoverFeature.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n({children:e,...t}){return(0,i.tZ)(r.Z,{children:({hasFeature:s})=>(0,i.tZ)(a.ZP,{disabled:!s,...t,children:e})})}n.displayName="DiscoverButton";const o=n},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l}),s("../node_modules/react/index.js");var a=s("./app/utils/withApi.tsx"),r=s("./app/utils/discover/genericDiscoverQuery.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function o(e){return(0,i.tZ)(r.Z,{route:"eventsv2",shouldRefetchData:n,...e})}o.displayName="DiscoverQuery";const l=(0,a.Z)(o)},"./app/utils/getPeriod.tsx":(e,t,s)=>{"use strict";s.d(t,{X:()=>o}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/moment/moment.js"),r=s.n(a),i=s("./app/constants/index.tsx"),n=s("./app/utils/dates.tsx");const o=({period:e,start:t,end:s},{shouldDoublePeriod:a}={})=>{if(e||t||s||(e=i.GY),e){if(!a)return{statsPeriod:e};const[,t,s]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(s)}}if(!t||!s)throw new Error("start and end required");const o=(0,n.v5)(t),l=(0,n.v5)(s);if(a){const e=r()(s).diff(r()(t)),a=r()(t).subtract(e);return{start:(0,n.v5)(a),end:l}}return{start:o,end:l}}},"./app/views/performance/transactionSummary/transactionVitals/constants.tsx":(e,t,s)=>{"use strict";s.d(t,{sE:()=>n,GW:()=>o,PE:()=>d,QB:()=>u}),s("../node_modules/core-js/modules/es.array.reverse.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.array.reduce.js");var a=s("./app/utils/discover/fields.tsx"),r=s("./app/utils/performance/vitals/constants.tsx"),i=s("./app/utils/theme.tsx");const n=100,o=.75,l=[{vitals:[a.Zl.FP,a.Zl.FCP,a.Zl.LCP],min:0},{vitals:[a.Zl.FID],min:0,precision:2},{vitals:[a.Zl.CLS],min:0,precision:2}],c=[...i.ZP.charts.getColorPalette(l.reduce(((e,{vitals:t})=>e+t.length),0)-1)].reverse(),d=l.map((e=>({...e,colors:c.splice(0,e.vitals.length)}))),u=l.reduce(((e,{vitals:t})=>(t.forEach((t=>{const s=r.r[t].slug;e.push("".concat(s,"Start")),e.push("".concat(s,"End"))})),e)),[])},"./app/views/performance/transactionSummary/transactionVitals/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>De});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/core-js/modules/es.array.reduce.js"),s("../node_modules/react/index.js")),n=s("../node_modules/react-router/es/index.js"),o=s("./app/components/acl/feature.tsx"),l=s("./app/components/alert.tsx"),c=s("./app/components/lightWeightNoProjectMessage.tsx"),d=s("./app/components/organizations/globalSelectionHeader/index.tsx"),u=s("./app/components/sentryDocumentTitle.tsx"),p=s("./app/locale.tsx"),m=s("./app/styles/organization.tsx"),h=s("./app/utils/discover/eventView.tsx"),v=s("./app/utils/discover/fields.tsx"),g=s("./app/utils/performance/vitals/constants.tsx"),f=s("./app/utils/queryString.tsx"),x=s("./app/utils/tokenizeSearch.tsx"),y=s("./app/utils/withGlobalSelection.tsx"),Z=s("./app/utils/withOrganization.tsx"),j=s("./app/utils/withProjects.tsx"),b=s("./app/views/performance/utils.tsx"),w=s("./app/views/performance/transactionSummary/transactionVitals/constants.tsx"),D=s("./app/components/button.tsx"),P=s("./app/components/dropdownControl.tsx"),_=s("./app/components/events/searchBar.tsx"),S=s("./app/components/layouts/thirds.tsx"),z=s("./app/components/organizations/globalSelectionHeader/getParams.tsx"),V=s("./app/styles/space.tsx"),k=s("./app/utils/analytics.tsx"),N=s("./app/utils/performance/histogram/index.tsx"),C=s("./app/utils/performance/histogram/constants.tsx"),q=s("./app/views/performance/transactionSummary/header.tsx"),T=s("./app/components/panels/index.tsx"),F=s("./app/utils/performance/histogram/histogramQuery.tsx"),E=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),R=(s("../node_modules/core-js/modules/es.symbol.description.js"),s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js")),L=s("../node_modules/lodash/isEqual.js"),O=s.n(L),A=s("../node_modules/lodash/throttle.js"),I=s.n(A),B=s("./app/components/charts/barChart.tsx"),W=s("./app/components/charts/barChartZoom.tsx"),M=s("./app/components/charts/components/markLine.tsx"),Q=s("./app/components/charts/transparentLoadingMask.tsx"),G=s("./app/components/discoverButton.tsx"),H=s("./app/components/placeholder.tsx"),J=s("./app/utils/formatters.tsx"),X=s("./app/utils/getDynamicText.tsx"),Y=s("./app/utils/performance/histogram/utils.tsx"),K=s("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),U=s("./app/views/performance/landing/vitalsCards.tsx"),$=s("./app/views/performance/vitalDetail/utils.tsx"),ee=s("./app/components/charts/styles.tsx");const te=(0,r.Z)(T.Lv,{target:"e1l3pu0z5"})({name:"1slq3zi",styles:"display:grid;grid-template-columns:325px minmax(100px, auto);padding:0"}),se=(0,r.Z)("div",{target:"e1l3pu0z4"})("padding:",(0,V.Z)(3),";"),ae=(0,r.Z)(se,{target:"e1l3pu0z3"})("position:relative;border-right:1px solid ",(e=>e.theme.border),";grid-column:1/1;display:flex;flex-direction:column;justify-content:space-between;"),re=(0,r.Z)(ee.OT,{target:"e1l3pu0z2"})({name:"cfjpzu",styles:"margin:0px"}),ie=(0,r.Z)("div",{target:"e1l3pu0z1"})("font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";"),ne=(0,r.Z)("div",{target:"e1l3pu0z0"})({name:"5r9nha",styles:"font-size:32px"});var oe=s("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),le=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class ce extends i.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{refDataRect:null,refPixelRect:null}),(0,a.Z)(this,"trackOpenInDiscoverClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,k.ec)({eventKey:"performance_views.vitals.open_in_discover",eventName:"Performance Views: Open vitals in discover",organization_id:e.id,vital:t.slug})})),(0,a.Z)(this,"trackOpenAllEventsClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,k.ec)({eventKey:"performance_views.vitals.open_all_events",eventName:"Performance Views: Open vitals in all events",organization_id:e.id,vital:t.slug})})),(0,a.Z)(this,"handleRendered",I()(((e,t)=>{const{chartData:s}=this.props,{refDataRect:a}=this.state;if(null===a||s.length<1)return;const r=null===a?null:(0,oe.L0)(t,a);null===r||O()(r,this.state.refPixelRect)||this.setState({refPixelRect:r})}),200,{leading:!0})),(0,a.Z)(this,"handleDataZoomCancelled",(()=>{}))}static getDerivedStateFromProps(e,t){const{isLoading:s,error:a,chartData:r}=e;if(s||null===a)return{...t};const i=(0,oe.eH)(r);return null===t.refDataRect||null!==i&&!O()(i,t.refDataRect)?{...t,refDataRect:i}:{...t}}get summary(){var e;const{summaryData:t}=this.props;return null!==(e=null==t?void 0:t.p75)&&void 0!==e?e:null}get failureRate(){var e,t;const{summaryData:s}=this.props,a=null!==(e=null==s?void 0:s.poor)&&void 0!==e?e:0,r=null!==(t=null==s?void 0:s.total)&&void 0!==t?t:0;return r<=0?0:a/r}getFormattedStatNumber(){const{vitalDetails:e}=this.props,t=this.summary,{type:s}=e;return null===t?"—":"duration"===s?(0,J.g9)(t/1e3,2,!0):(0,J.$1)(t,2)}renderSummary(){var e;const{vitalDetails:t,eventView:s,organization:a,min:r,max:i,dataFilter:n}=this.props,{slug:o,name:l,description:c}=t,d=a.features.includes("performance-events-page"),u="measurements.".concat(o),m=s.withColumns([{kind:"field",field:"transaction"},{kind:"function",function:["percentile",u,w.GW.toString(),void 0]},{kind:"function",function:["count","","",void 0]}]).withSorts([{kind:"desc",field:(0,v.LY)("percentile(".concat(u,",").concat(w.GW.toString(),")"))}]),h=(0,x.aI)(null!==(e=m.query)&&void 0!==e?e:"");return h.addFilterValues("has",[u]),void 0===r&&void 0===i||(void 0!==r&&h.addFilterValues(u,[">=".concat(r)]),void 0!==i&&h.addFilterValues(u,["<=".concat(i)])),m.query=h.formatString(),(0,le.BX)(ae,{children:[(0,le.tZ)(de,{children:(0,le.tZ)(re,{children:"".concat(l," (").concat(o.toUpperCase(),")")})}),(0,le.tZ)(ne,{children:(0,X.Z)({value:this.getFormattedStatNumber(),fixed:"—"})}),(0,le.tZ)(ie,{children:c}),(0,le.tZ)("div",{children:d?(0,le.tZ)(D.ZP,{size:"small",to:m.withColumns([{kind:"field",field:u}]).withSorts([{kind:"desc",field:u}]).getPerformanceTransactionEventsViewUrlTarget(a.slug,{showTransactions:"all"===n?K.q3.p100:K.q3.p75,webVital:u}),onClick:this.trackOpenAllEventsClicked,children:(0,p.t)("View All Events")}):(0,le.tZ)(G.Z,{size:"small",to:m.getResultsViewUrlTarget(a.slug),onClick:this.trackOpenInDiscoverClicked,children:(0,p.t)("Open in Discover")})})]})}renderHistogram(){const{theme:e,location:t,isLoading:s,chartData:a,summaryData:r,error:i,colors:n,vital:o,vitalDetails:l,precision:c=0}=this.props,{slug:d}=l,u=this.getSeries(),p={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},m=u.data.map((e=>e.value)),h={type:"value",max:m.length?Math.max(...m):void 0,axisLabel:{color:e.chartLabel,formatter:J.Du}},v=[u];if(!s&&!i){const e=this.getBaselineSeries();null!==e&&v.push(e)}const g=s||i||null===r?{}:{[o]:r};return(0,le.tZ)(W.Z,{minZoomWidth:10**-c*w.sE,location:t,paramStart:"".concat(d,"Start"),paramEnd:"".concat(d,"End"),xAxisIndex:[0],buckets:(0,Y._W)(a),onDataZoomCancelled:this.handleDataZoomCancelled,children:e=>(0,le.BX)(ue,{children:[(0,le.tZ)(Q.Z,{visible:s}),(0,le.tZ)(pe,{children:(0,le.tZ)(U.JO,{isLoading:s,data:g,vital:o,showBar:!1,showStates:!1,showVitalPercentNames:!1,showDurationDetail:!1})}),(0,X.Z)({value:(0,le.tZ)(B.Z,{series:v,xAxis:p,yAxis:h,colors:n,onRendered:this.handleRendered,grid:{left:(0,V.Z)(3),right:(0,V.Z)(3),top:(0,V.Z)(3),bottom:(0,V.Z)(1.5)},stacked:!0,...e}),fixed:(0,le.tZ)(H.Z,{testId:"skeleton-ui",height:"200px"})})]})})}bucketWidth(){const{chartData:e}=this.props;return e.length>=2?e[1].bin-e[0].bin:0}getSeries(){const{theme:e,chartData:t,precision:s,vitalDetails:a,vital:r}=this.props,i=(0,Y.GT)(t,{precision:0===s?void 0:s,type:a.type,additionalFieldsFn:t=>({itemStyle:{color:e[this.getVitalsColor(r,t)]}})});return{seriesName:(0,p.t)("Count"),data:i}}getVitalsColor(e,t){const s=$.eE[e],a=$.MN[e];return t>=s?$.fL[$.SP.POOR]:t>=a?$.fL[$.SP.MEH]:$.fL[$.SP.GOOD]}getBaselineSeries(){const{theme:e,chartData:t}=this.props,s=this.summary;if(null===s||null===this.state.refPixelRect)return null;const a=(0,oe.oZ)(t,s);if(null===a||-1===a)return null;const r=(0,oe.jb)({x:a-.5,y:0},this.state.refDataRect,this.state.refPixelRect);if(null===r)return null;const i=(0,oe.jb)({x:a-.5,y:Math.max(...t.map((e=>e.count)))||1},this.state.refDataRect,this.state.refPixelRect);if(null===i)return null;const n=(0,M.Z)({animationDuration:200,data:[[r,i]],label:{show:!1},lineStyle:{color:e.textColor,type:"solid"}});return n.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">','<span class="tooltip-label">',"<strong>".concat((0,p.t)("p75"),"</strong>"),"</span>","</div>",'<div class="tooltip-arrow"></div>'].join("")},{seriesName:(0,p.t)("p75"),data:[],markLine:n}}render(){return(0,le.BX)(te,{children:[this.renderSummary(),this.renderHistogram()]})}}ce.displayName="VitalCard";const de=(0,r.Z)("div",{target:"e1yeyzg42"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),ue=(0,r.Z)("div",{target:"e1yeyzg41"})({name:"bjn8wh",styles:"position:relative"}),pe=(0,r.Z)("div",{target:"e1yeyzg40"})("position:absolute;top:",(0,V.Z)(2),";right:",(0,V.Z)(3),";z-index:2;"),me=(0,R.b)(ce);class he extends i.Component{renderVitalCard(e,t,s,a,r,i,n,o,l){const{location:c,organization:d,eventView:u,dataFilter:p}=this.props,m=g.r[e],h=void 0!==n||void 0!==o;return(0,le.tZ)(F.Z,{location:c,orgSlug:d.slug,eventView:u,numBuckets:w.sE,fields:h?[e]:[],min:n,max:o,precision:l,dataFilter:p,children:v=>{var g,f;const x=h?v.isLoading:t,y=h?null!==v.error:s,Z=h&&null!==(g=null===(f=v.histograms)||void 0===f?void 0:f[e])&&void 0!==g?g:r;return(0,le.tZ)(me,{location:c,isLoading:x,error:y,vital:e,vitalDetails:m,summaryData:a,chartData:Z,colors:i,eventView:u,organization:d,min:n,max:o,precision:l,dataFilter:p})}})}renderVitalGroup(e,t){const{location:s,organization:a,eventView:r,dataFilter:n}=this.props,{vitals:o,colors:l,min:c,max:d,precision:u}=e,p=o.reduce(((e,t)=>{const a=g.r[t].slug;return e[t]={start:(0,f.ro)(s.query["".concat(a,"Start")]),end:(0,f.ro)(s.query["".concat(a,"End")])},e}),{});return(0,le.tZ)(F.Z,{location:s,orgSlug:a.slug,eventView:r,numBuckets:w.sE,fields:o,min:c,max:d,precision:u,dataFilter:n,children:e=>{const s=t.isLoading||e.isLoading,a=null!==t.error||null!==e.error;return(0,le.tZ)(i.Fragment,{children:o.map(((r,n)=>{var o,c,d,m,h;const v=null!==(o=null==t||null===(c=t.vitalsData)||void 0===c?void 0:c[r])&&void 0!==o?o:null,g=null!==(d=null===(m=e.histograms)||void 0===m?void 0:m[r])&&void 0!==d?d:[],{start:f,end:x}=null!==(h=p[r])&&void 0!==h?h:{};return(0,le.tZ)(i.Fragment,{children:this.renderVitalCard(r,s,a,v,g,[l[n]],ve(f,u),ve(x,u),u)},r)}))})}})}render(){const{location:e,organization:t,eventView:s}=this.props,a=w.PE.reduce(((e,{vitals:t})=>e.concat(t)),[]);return(0,le.tZ)(T.s_,{children:(0,le.tZ)(E.Z,{eventView:s,orgSlug:t.slug,location:e,vitals:a,children:e=>(0,le.tZ)(i.Fragment,{children:w.PE.map((t=>(0,le.tZ)(i.Fragment,{children:this.renderVitalGroup(t,e)},t.vitals.join(""))))})})})}}function ve(e,t){if(void 0!==e)return void 0===t||0===t?parseInt(e,10):parseFloat(e)}he.displayName="VitalsPanel";const ge=he;class fe extends i.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{incompatibleAlertNotice:null}),(0,a.Z)(this,"handleSearch",(e=>{const{location:t}=this.props,s=(0,z.Q)({...t.query||{},query:e});delete s.cursor,n.browserHistory.push({pathname:t.pathname,query:s})})),(0,a.Z)(this,"handleIncompatibleQuery",((e,t)=>{const s=e((()=>this.setState({incompatibleAlertNotice:null})));this.setState({incompatibleAlertNotice:s})}))}render(){const{transactionName:e,location:t,eventView:s,projects:a,organization:r}=this.props,{incompatibleAlertNotice:n}=this.state,o=(0,f.ro)(t.query.query,"");return(0,le.BX)(i.Fragment,{children:[(0,le.tZ)(q.Z,{eventView:s,location:t,organization:r,projects:a,transactionName:e,currentTab:q.O.RealUserMonitoring,hasWebVitals:"yes",handleIncompatibleQuery:this.handleIncompatibleQuery}),(0,le.tZ)(N.Z,{location:t,zoomKeys:w.QB,children:({activeFilter:e,handleFilterChange:a,handleResetView:i,isZoomed:l})=>(0,le.BX)(S.uT,{children:[n&&(0,le.tZ)(S.or,{fullWidth:!0,children:n}),(0,le.BX)(S.or,{fullWidth:!0,children:[(0,le.BX)(ye,{children:[(0,le.tZ)(xe,{organization:r,projectIds:s.project,query:o,fields:s.fields,onSearch:this.handleSearch}),(0,le.tZ)(P.ZP,{buttonProps:{prefix:(0,p.t)("Outliers")},label:e.label,children:C.d.map((({label:t,value:s})=>(0,le.tZ)(P.hP,{onSelect:e=>{(0,k.ec)({eventKey:"performance_views.vitals.filter_changed",eventName:"Performance Views: Change vitals filter",organization_id:r.id,value:e}),a(e)},eventKey:s,isActive:s===e.value,children:t},s)))}),(0,le.tZ)(D.ZP,{onClick:()=>{(0,k.ec)({eventKey:"performance_views.vitals.reset_view",eventName:"Performance Views: Reset vitals view",organization_id:r.id}),i()},disabled:!l,"data-test-id":"reset-view",children:(0,p.t)("Reset View")})]}),(0,le.tZ)(ge,{organization:r,location:t,eventView:s,dataFilter:e.value})]})]})})]})}}fe.displayName="VitalsContent";const xe=(0,r.Z)(_.Z,{target:"ekvr84z1"})({name:"1ff36h2",styles:"flex-grow:1"}),ye=(0,r.Z)("div",{target:"ekvr84z0"})("display:grid;grid-gap:",(0,V.Z)(2),";grid-template-columns:auto max-content max-content;align-items:center;margin-bottom:",(0,V.Z)(3),";"),Ze=fe;class je extends i.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{eventView:we(this.props.location,(0,b.JY)(this.props.location))}),(0,a.Z)(this,"renderNoAccess",(()=>(0,le.tZ)(l.Z,{type:"warning",children:(0,p.t)("You don't have access to this feature")})))}static getDerivedStateFromProps(e,t){return{...t,eventView:we(e.location,(0,b.JY)(e.location))}}getDocumentTitle(){const e=(0,b.JY)(this.props.location);return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,p.t)("Vitals")].join(" — "):[(0,p.t)("Summary"),(0,p.t)("Vitals")].join(" — ")}render(){const{organization:e,projects:t,location:s}=this.props,{eventView:a}=this.state,r=(0,b.JY)(s);if(!a||void 0===r)return n.browserHistory.replace({pathname:"/organizations/".concat(e.slug,"/performance/"),query:{...s.query}}),null;const i=1===a.project.length,l=i?t.find((e=>parseInt(e.id,10)===a.project[0])):void 0,m=a.project.map((e=>t.find((t=>parseInt(t.id,10)===e)))).filter((e=>void 0!==e)).map((e=>e.slug));return(0,le.tZ)(u.Z,{title:this.getDocumentTitle(),orgSlug:e.slug,projectSlug:null==l?void 0:l.slug,children:(0,le.tZ)(o.Z,{features:["performance-view"],organization:e,renderDisabled:this.renderNoAccess,children:(0,le.tZ)(d.Z,{lockedMessageSubject:(0,p.t)("transaction"),shouldForceProject:i,forceProject:l,specificProjectSlugs:m,disableMultipleProjectSelection:!0,showProjectSettingsLink:!0,children:(0,le.tZ)(be,{children:(0,le.tZ)(c.Z,{organization:e,children:(0,le.tZ)(Ze,{location:s,eventView:a,transactionName:r,organization:e,projects:t})})})})})})}}je.displayName="TransactionVitals";const be=(0,r.Z)(m.JH,{target:"e5s4h7q0"})({name:"1hcx8jb",styles:"padding:0"});function we(e,t){if(void 0===t)return;const s=(0,f.ro)(e.query.query,""),a=(0,x.aI)(s);a.setFilterValues("event.type",["transaction"]).setFilterValues("transaction.op",["pageload"]).setFilterValues("transaction",[t]),Object.keys(a.filters).forEach((e=>{(0,v.h1)(e)&&a.removeFilter(e)}));const r=w.PE.reduce(((e,t)=>e.concat(t.vitals)),[]);return h.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:t,fields:[...r.map((e=>"percentile(".concat(e,", ").concat(w.GW,")"))),...r.map((e=>"count_at_least(".concat(e,", 0)"))),...r.map((e=>"count_at_least(".concat(e,", ").concat(g.r[e].poorThreshold,")")))],query:a.formatString(),projects:[]},e)}const De=(0,y.Z)((0,j.Z)((0,Z.Z)(je)))},"../node_modules/lodash/throttle.js":(e,t,s)=>{var a=s("../node_modules/lodash/debounce.js"),r=s("../node_modules/lodash/isObject.js");e.exports=function(e,t,s){var i=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(s)&&(i="leading"in s?!!s.leading:i,n="trailing"in s?!!s.trailing:n),a(e,t,{leading:i,maxWait:t,trailing:n})}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsRequest_tsx-app_utils_discover_discoverQuery_tsx-app_views_perfor-9421d1.8b18c3a6197fe0df3553f695d1d8164d.js.map