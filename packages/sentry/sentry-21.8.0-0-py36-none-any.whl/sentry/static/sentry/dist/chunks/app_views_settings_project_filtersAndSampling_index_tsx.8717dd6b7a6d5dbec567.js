(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_project_filtersAndSampling_index_tsx"],{"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>a}),n("../node_modules/react/index.js");var s=n("../node_modules/react-document-title/index.js"),i=n.n(s),o=n("./app/components/asyncComponent.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends o.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(i(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/components/forms/controls/textarea.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=n("../node_modules/react/index.js"),o=n("../node_modules/react-autosize-textarea/lib/index.js"),r=n("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),a=n("./app/styles/input.tsx"),l=n("./app/styles/space.tsx"),d=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const c=i.forwardRef((function({autosize:e,rows:t,maxRows:n,...s},i){return e?(0,d.tZ)(o.Z,{...s,async:!0,ref:i,rows:t||2,maxRows:n}):(0,d.tZ)("textarea",{ref:i,...s})}));c.displayName="TextAreaControl";const p=(0,s.Z)(c,{shouldForwardProp:e=>["autosize","rows","maxRows"].includes(e)||(0,r.Z)(e),target:"elxy32p0"})(a.T,";min-height:40px;padding:calc(",(0,l.Z)(1)," - 1px) ",(0,l.Z)(1),";line-height:1.5em;",(e=>e.autosize&&"\n      height: auto;\n      padding: calc(".concat((0,l.Z)(1)," - 2px) ").concat((0,l.Z)(1),";\n      line-height: 1.6em;\n    ")),";")},"./app/views/settings/components/forms/numberField.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n("./app/views/settings/components/forms/inputField.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){return(0,i.tZ)(s.Z,{...e,type:"number"})}o.displayName="NumberField"},"./app/views/settings/components/forms/radioField.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("./app/views/settings/components/forms/controls/radioGroup.tsx"),r=n("./app/views/settings/components/forms/inputField.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class l extends i.Component{constructor(...e){super(...e),(0,s.Z)(this,"onChange",((e,t,n,s)=>{t(e,s),n(e,s)}))}render(){return(0,a.tZ)(r.Z,{...this.props,field:({onChange:e,onBlur:t,value:n,disabled:s,orientInline:i,...r})=>(0,a.tZ)(o.Z,{choices:r.choices,disabled:s,orientInline:i,value:""===n?null:n,label:r.label,onChange:(n,s)=>this.onChange(n,e,t,s)})})}}l.displayName="RadioField";const d=l},"./app/views/settings/components/forms/textareaField.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l}),n("../node_modules/react/index.js");var s=n("../node_modules/lodash/omit.js"),i=n.n(s),o=n("./app/views/settings/components/forms/controls/textarea.tsx"),r=n("./app/views/settings/components/forms/inputField.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({monospace:e,rows:t,autosize:n,...s}){return(0,a.tZ)(r.Z,{...s,field:s=>(0,a.tZ)(o.Z,{monospace:e,rows:t,autosize:n,...i()(s,["onKeyDown","children"])})})}l.displayName="TextareaField"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>d}),n("../node_modules/react/index.js");var s=n("./app/components/acl/access.tsx"),i=n("./app/components/alert.tsx"),o=n("./app/icons/index.tsx"),r=n("./app/locale.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=({access:e=["org:write"],...t})=>(0,a.tZ)(s.Z,{access:e,children:({hasAccess:e})=>!e&&(0,a.tZ)(i.Z,{type:"warning",icon:(0,a.tZ)(o.FC,{size:"sm"}),...t,children:(0,r.t)("These settings can only be edited by users with the organization owner or manager role.")})});l.displayName="PermissionAlert";const d=l},"./app/views/settings/project/filtersAndSampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Mt});var s=n("./app/components/acl/access.tsx"),i=n("./app/components/acl/feature.tsx"),o=n("./app/components/acl/featureDisabled.tsx"),r=n("./app/components/panels/index.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),p=n("../node_modules/lodash/partition.js"),u=n.n(p),h=n("./app/actionCreators/indicator.tsx"),m=n("./app/actionCreators/modal.tsx"),g=n("./app/components/alert.tsx"),E=n("./app/components/links/externalLink.tsx");let R,_,y,S,x;!function(e){e.TRACE="trace",e.TRANSACTION="transaction",e.ERROR="error"}(R||(R={})),function(e){e.NOT="not",e.OR="or",e.AND="and"}(_||(_={})),function(e){e.GLOB_MATCH="glob",e.EQUAL="eq",e.CUSTOM="custom"}(y||(y={})),function(e){e.TRACE_RELEASE="trace.release",e.TRACE_ENVIRONMENT="trace.environment",e.TRACE_USER_ID="trace.user.id",e.TRACE_USER_SEGMENT="trace.user.segment",e.EVENT_RELEASE="event.release",e.EVENT_ENVIRONMENT="event.environment",e.EVENT_USER_ID="event.user.id",e.EVENT_USER_SEGMENT="event.user.segment",e.EVENT_LOCALHOST="event.is_local_ip",e.EVENT_WEB_CRAWLERS="event.web_crawlers",e.EVENT_BROWSER_EXTENSIONS="event.has_bad_browser_extensions",e.EVENT_IP_ADDRESSES="event.client_ip",e.EVENT_LEGACY_BROWSER="event.legacy_browser",e.EVENT_ERROR_MESSAGES="event.error_messages",e.EVENT_CSP="event.csp"}(S||(S={})),function(e){e.IE_PRE_9="ie_pre_9",e.IE9="ie9",e.IE10="ie10",e.IE11="ie11",e.SAFARI_PRE_6="safari_pre_6",e.OPERA_PRE_15="opera_pre_15",e.OPERA_MINI_PRE_8="opera_mini_pre_8",e.ANDROID_PRE_4="android_pre_4"}(x||(x={}));var b=n("./app/utils/withProject.tsx"),Z=n("./app/views/asyncView.tsx"),f=n("./app/views/settings/components/settingsPageHeader.tsx"),T=n("./app/views/settings/components/text/textBlock.tsx"),w=n("./app/views/settings/organization/permissionAlert.tsx"),A=n("../node_modules/lodash/isEqual.js"),v=n.n(A),N=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),C=(n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/lodash/omit.js")),I=n.n(C),j=n("./app/components/button.tsx"),O=n("./app/components/buttonBar.tsx"),D=n("./app/styles/space.tsx"),k=n("./app/utils.tsx"),L=n("./app/views/settings/components/forms/numberField.tsx"),V=n("./app/views/settings/components/forms/radioField.tsx"),M=n("./app/icons/index.tsx"),B=n("./app/views/settings/components/forms/selectField.tsx"),P=n("./app/views/settings/components/forms/textareaField.tsx"),U=n("../node_modules/lodash/intersection.js"),z=n.n(U),F=n("../node_modules/lodash/uniq.js"),W=n.n(F),X=n("../node_modules/lodash/xor.js"),G=n.n(X),H=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function q({selectedRowsCount:e,columnsCount:t,isPageSelected:n,isAllSelected:s,onSelectAllRows:i,onUnselectAllRows:o,bulkLimit:r,allRowsCount:l,className:d}){if(l&&l<=e||!n)return null;const{noticeText:p,actionText:u}=function(e,t){return(0,k.ri)(e)?t&&e>t?{noticeText:(0,a._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,a._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,a._N)("Selected all [count] items.",{count:e}),actionText:(0,a._N)("Select all [count] items.",{count:e})}:{noticeText:(0,a.t)("Selected all items across all pages."),actionText:(0,a.t)("Select all items across all pages.")}}(l,r);return(0,H.tZ)(Y,{columnsCount:t,className:d,children:s?(0,H.BX)(c.Fragment,{children:[p," ",(0,H.tZ)(K,{priority:"link",onClick:o,children:(0,a.t)("Cancel selection.")})]}):(0,H.BX)(c.Fragment,{children:[(0,a.tn)("%s item on this page selected.","%s items on this page selected.",e)," ",(0,H.tZ)(K,{priority:"link",onClick:i,children:u})]})})}q.displayName="BulkNotice";const Y=(0,N.Z)((({columnsCount:e,...t})=>(0,H.tZ)(r.aU,{...t})),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),K=(0,N.Z)(j.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),Q=q;class J extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:G()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?W()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:z()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:z()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;v()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:i}=this.props,{selectedIds:o,isAllSelected:r}=this.state,a=e.length>0&&e.every((e=>o.includes(e)));return t({selectedIds:o,isAllSelected:r,isPageSelected:a,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,H.tZ)(Q,{allRowsCount:s,selectedRowsCount:o.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:a,isAllSelected:r,bulkLimit:i})})}}J.displayName="BulkController";const $=J;var ee=n("./app/components/switchButton.tsx"),te=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),ne=n("./app/utils/theme.tsx");const se=(0,te.iv)("[role='document']{overflow:initial;}@media (min-width: ",ne.ZP.breakpoints[0],"){width:100%;max-width:700px;}",""),ie={[x.IE_PRE_9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer Version 8 and lower")},[x.IE9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer Version 9")},[x.IE10]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer Version 10")},[x.IE11]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer Version 11")},[x.SAFARI_PRE_6]:{icon:"safari",title:(0,a.t)("Safari Version 5 and lower")},[x.OPERA_PRE_15]:{icon:"opera",title:(0,a.t)("Opera Version 14 and lower")},[x.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,a.t)("Opera Mini Version 8 and lower")},[x.ANDROID_PRE_4]:{icon:"android",title:(0,a.t)("Android Version 3 and lower")}};let oe;function re(e){switch(e){case S.EVENT_LEGACY_BROWSER:return(0,a.t)("Match all selected legacy browsers below");case S.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Match all browser extensions");case S.EVENT_LOCALHOST:return(0,a.t)("Match all localhosts");case S.EVENT_WEB_CRAWLERS:return(0,a.t)("Match all web crawlers");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,a.t)("ex. 4711 (Multiline)");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,a.t)("ex. paid, common (Multiline)");case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,a.t)("ex. prod or dev (Multiline)");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,a.t)("ex. 1* or [I3].[0-9].* (Multiline)");case S.EVENT_IP_ADDRESSES:return(0,a.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case S.EVENT_CSP:return(0,a.t)("ex. file://* or example.com (Multiline)");case S.EVENT_ERROR_MESSAGES:return(0,a.t)("ex. TypeError* (Multiline)");default:return""}}function ae({browser:e,isEnabled:t,onToggle:n}){const{icon:s,title:i}=ie[e];return(0,H.BX)(c.Fragment,{children:[(0,H.BX)(de,{children:[(0,H.tZ)(ce,{className:"icon-".concat(s)}),i]}),(0,H.tZ)(pe,{children:(0,H.tZ)(ee.Z,{size:"lg",isActive:t,toggle:n})})]})}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(oe||(oe={})),ae.displayName="Browser";const le=ae,de=(0,N.Z)("div",{target:"e1ocjrk92"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,D.Z)(1),";align-items:center;font-size:",(e=>e.theme.fontSizeLarge),";"),ce=(0,N.Z)("div",{target:"e1ocjrk91"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"}),pe=(0,N.Z)("div",{target:"e1ocjrk90"})({name:"5ej25d",styles:"display:flex;justify-content:flex-end;align-items:center"}),ue=Object.values(x);function he({onChange:e,selectedLegacyBrowsers:t=[]}){return(0,H.tZ)($,{pageIds:ue,defaultSelectedIds:t,allRowsCount:ue.length,onChange:function({selectedIds:t}){e(t)},columnsCount:0,children:({selectedIds:e,onRowToggle:t,onPageRowsToggle:n,isPageSelected:s})=>(0,H.tZ)(ge,{headers:["",(0,H.tZ)(ee.Z,{size:"lg",isActive:s,toggle:()=>{n(!s)}},"switch")],children:ue.map((n=>(0,H.tZ)(le,{browser:n,isEnabled:e.includes(n),onToggle:()=>{t(n)}},n)))})})}he.displayName="LegacyBrowsersField";const me=he,ge=(0,N.Z)(r.KB,{target:"e1xiq2l70"})({name:"wuodl4",styles:"grid-template-columns:1fr max-content;grid-column:1/-2"});function Ee({conditions:e,categoryOptions:t,onAdd:n,onDelete:s,onChange:i}){const o=t.filter((t=>!e.find((e=>e.category===t[0]))));return(0,H.BX)(Se,{children:[e.map((({match:e,legacyBrowsers:n,category:r},l)=>{const d=t.find((e=>e[0]===r)),c=d?[d,...o]:o,p=r===S.EVENT_LEGACY_BROWSER,u=r===S.EVENT_BROWSER_EXTENSIONS||r===S.EVENT_LOCALHOST||r===S.EVENT_WEB_CRAWLERS||p;return(0,H.BX)(xe,{children:[(0,H.BX)(ye,{children:[(0,H.tZ)(B.Z,{label:(0,a.t)("Category"),name:"category-".concat(l),value:r,onChange:e=>i(l,"category",e),choices:c,inline:!1,hideControlState:!0,showHelpInTooltip:!0,required:!0,stacked:!0}),(0,H.tZ)(P.Z,{label:(0,a.t)("Matches"),placeholder:re(r),name:"match-".concat(l),value:u?"":e,onChange:e=>i(l,"match",e),disabled:u,inline:!1,rows:1,autosize:!0,hideControlState:!0,showHelpInTooltip:!0,flexibleControlStateSize:!0,required:!0,stacked:!0}),(0,H.tZ)(be,{children:(0,H.tZ)(j.ZP,{onClick:s(l),size:"small",children:(0,a.t)("Delete Condition")})})]}),(0,H.tZ)(_e,{onClick:s(l),children:(0,H.tZ)(M.Fz,{"aria-label":(0,a.t)("Delete Condition")})}),p&&(0,H.tZ)(me,{selectedLegacyBrowsers:n,onChange:e=>{i(l,"legacyBrowsers",e)}})]},l)})),!!o.length&&(0,H.tZ)(Ze,{icon:(0,H.tZ)(M.N_,{isCircled:!0}),onClick:n,size:"small",children:(0,a.t)("Add Condition")})]})}Ee.displayName="ConditionFields";const Re=Ee,_e=(0,N.Z)("div",{target:"e1gxha3e5"})("height:40px;margin-top:24px;cursor:pointer;display:none;align-items:center;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;}"),ye=(0,N.Z)("div",{target:"e1gxha3e4"})("display:grid;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:1fr 1fr;grid-gap:",(0,D.Z)(2),";}"),Se=(0,N.Z)("div",{target:"e1gxha3e3"})(">*{:not(:first-child){label{display:none;}",_e,"{margin-top:0;}",ye,"{@media (max-width: ",(e=>e.theme.breakpoints[0]),"){border-top:1px solid ",(e=>e.theme.border),";padding-top:",(0,D.Z)(2),";margin-top:",(0,D.Z)(2),";}}}}"),xe=(0,N.Z)("div",{target:"e1gxha3e2"})("display:grid;grid-template-columns:1fr;grid-gap:",(0,D.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:1fr max-content;}"),be=(0,N.Z)("div",{target:"e1gxha3e1"})("display:flex;justify-content:flex-end;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:none;}"),Ze=(0,N.Z)(j.ZP,{target:"e1gxha3e0"})("margin:",(0,D.Z)(2)," 0;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){margin-top:0;}"),fe=[[oe.ALL,(0,a.t)("Apply to all")],[oe.MATCH_CONDITIONS,(0,a.t)("Match custom conditions")]];class Te extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",this.getDefaultState()),(0,d.Z)(this,"handleChange",((e,t)=>{this.setState((n=>({...n,[e]:t})))})),(0,d.Z)(this,"handleChangeTransaction",(e=>{this.setState((t=>({transaction:e,conditions:e===oe.ALL?[]:t.conditions})))})),(0,d.Z)(this,"handleSubmit",(()=>{throw new Error("Not implemented")})),(0,d.Z)(this,"handleAddCondition",(()=>{const{conditions:e}=this.state,t=this.getCategoryOptions();if(!e.length)return void this.setState({conditions:[{category:t[0][0],match:""}]});const n=t.find((t=>!e.find((e=>e.category===t[0]))));n&&this.setState({conditions:[...e,{category:n[0],match:""}]})})),(0,d.Z)(this,"handleChangeCondition",((e,t,n)=>{const s=[...this.state.conditions];s[e][t]=n,this.setState({conditions:s})})),(0,d.Z)(this,"handleDeleteCondition",(e=>()=>{const t=[...this.state.conditions];t.splice(e,1),t.length?this.setState({conditions:t}):this.setState({conditions:t,transaction:oe.ALL})}))}componentDidUpdate(e,t){t.transaction!==oe.ALL||this.state.transaction===oe.ALL||this.state.conditions.length||this.handleAddCondition()}getDefaultState(){const{rule:e}=this.props;if(e){const{condition:t,sampleRate:n}=e,{inner:s}=t;return{transaction:s.length?oe.MATCH_CONDITIONS:oe.ALL,conditions:s.map((({name:e,value:t})=>Array.isArray(t)?t.every((e=>!!ie[e]))?{category:e,legacyBrowsers:t}:{category:e,match:t.join("\n")}:{category:e})),sampleRate:100*n,errors:{}}}return{transaction:oe.ALL,conditions:[],errors:{}}}getNewCondition(e){if(e.category===S.EVENT_BROWSER_EXTENSIONS||e.category===S.EVENT_WEB_CRAWLERS||e.category===S.EVENT_LOCALHOST)return{op:y.EQUAL,name:e.category,value:!0};var t;if(e.category===S.EVENT_LEGACY_BROWSER)return{op:y.CUSTOM,name:e.category,value:null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]};const n=e.match.split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===S.EVENT_IP_ADDRESSES||e.category===S.EVENT_ERROR_MESSAGES||e.category===S.EVENT_CSP?{op:y.CUSTOM,name:e.category,value:n}:e.category===S.EVENT_RELEASE||e.category===S.TRACE_RELEASE?{op:y.GLOB_MATCH,name:e.category,value:n}:e.category===S.TRACE_USER_ID||e.category===S.EVENT_USER_ID?{op:y.EQUAL,name:e.category,value:n,options:{ignoreCase:!1}}:{op:y.EQUAL,name:e.category,value:n,options:{ignoreCase:!0}}}getSuccessMessage(){const{rule:e}=this.props;return e?(0,a.t)("Successfully edited dynamic sampling rule"):(0,a.t)("Successfully added dynamic sampling rule")}clearError(e){this.setState((t=>({errors:I()(t.errors,e)})))}convertErrorXhrResponse(e){switch(e.type){case"sampleRate":this.setState((t=>({errors:{...t.errors,sampleRate:e.message}})));break;default:(0,h.Iw)(e.message)}}async submitRules(e,t){const{organization:n,project:s,api:i,onSubmitSuccess:o,closeModal:r}=this.props;try{o(await i.requestPromise("/projects/".concat(n.slug,"/").concat(s.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}}),this.getSuccessMessage()),r()}catch(e){this.convertErrorXhrResponse(function(e,t){var n,s,i;const o=null!==(n=null===(s=e.responseJSON)||void 0===s||null===(i=s.dynamicSampling)||void 0===i?void 0:i.rules[t])&&void 0!==n?n:{},[r,l]=Object.entries(o)[0];return"sampleRate"===r&&"Ensure this value is less than or equal to 1."===(Array.isArray(l)?l[0]:l)?{type:"sampleRate",message:(0,a.t)("Ensure this value is a floating number between 0 and 100")}:{type:"unknown",message:(0,a.t)("An internal error occurred while saving dynamic sampling rule")}}(e,t))}}getModalTitle(){return""}geTransactionFieldDescription(){return{label:""}}getExtraFields(){return null}getCategoryOptions(){throw new Error("Not implemented")}render(){const{Header:e,Body:t,closeModal:n,Footer:s}=this.props,{sampleRate:i,conditions:o,transaction:r,errors:l}=this.state,d=this.geTransactionFieldDescription(),p=this.getCategoryOptions(),u=!(0,k.ri)(i)||!!o.length&&!!o.find((e=>{var t;return e.category===S.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==S.EVENT_LOCALHOST&&e.category!==S.EVENT_BROWSER_EXTENSIONS&&e.category!==S.EVENT_WEB_CRAWLERS&&!e.match}));return(0,H.BX)(c.Fragment,{children:[(0,H.tZ)(e,{closeButton:!0,children:(0,H.tZ)("h4",{children:this.getModalTitle()})}),(0,H.tZ)(t,{children:(0,H.BX)(Ae,{children:[this.getExtraFields(),(0,H.tZ)(V.Z,{...d,name:"transaction",choices:fe,onChange:this.handleChangeTransaction,value:r,inline:!1,hideControlState:!0,showHelpInTooltip:!0,stacked:!0,required:!0}),r!==oe.ALL&&(0,H.tZ)(Re,{conditions:o,categoryOptions:p,onAdd:this.handleAddCondition,onChange:this.handleChangeCondition,onDelete:this.handleDeleteCondition}),(0,H.tZ)(L.Z,{label:(0,a.t)("Sampling Rate"),name:"sampleRate",onChange:e=>{this.handleChange("sampleRate",(0,k.ri)(e)?Number(e):void 0),l.sampleRate&&this.clearError("sampleRate")},placeholder:"%",value:i||void 0,inline:!1,hideControlState:!l.sampleRate,error:l.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,H.tZ)(s,{children:(0,H.BX)(O.ZP,{gap:1,children:[(0,H.tZ)(j.ZP,{onClick:n,children:(0,a.t)("Cancel")}),(0,H.tZ)(j.ZP,{priority:"primary",onClick:this.handleSubmit,disabled:u,children:(0,a.t)("Save Rule")})]})})]})}}Te.displayName="Form";const we=Te,Ae=(0,N.Z)("div",{target:"epq0r1l0"})("display:grid;grid-gap:",(0,D.Z)(1),";"),ve=class extends we{constructor(...e){super(...e),(0,d.Z)(this,"handleSubmit",(()=>{const{sampleRate:e,conditions:t,transaction:n}=this.state;if(!e)return;const{rule:s,errorRules:i,transactionRules:o}=this.props,r={id:0,type:R.ERROR,condition:{op:_.AND,inner:n===oe.ALL?[]:t.map(this.getNewCondition)},sampleRate:e/100},a=s?[...i.map((e=>v()(e,s)?r:e)),...o]:[...i,r,...o],l=a.findIndex((e=>e===r));this.submitRules(a,l)}))}getDefaultState(){return{...super.getDefaultState()}}getModalTitle(){const{rule:e}=this.props;return e?(0,a.t)("Edit Error Sampling Rule"):(0,a.t)("Add Error Sampling Rule")}geTransactionFieldDescription(){return{label:(0,a.t)("Errors"),help:(0,a.t)("This determines if the rule applies to all errors or only errors that match custom conditions.")}}getCategoryOptions(){return[[S.EVENT_RELEASE,(0,a.t)("Releases")],[S.EVENT_ENVIRONMENT,(0,a.t)("Environments")],[S.EVENT_USER_ID,(0,a.t)("User Id")],[S.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[S.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[S.EVENT_LOCALHOST,(0,a.t)("Localhost")],[S.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browsers")],[S.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[S.EVENT_IP_ADDRESSES,(0,a.t)("IP Addresses")],[S.EVENT_CSP,(0,a.t)("Content Security Policy")],[S.EVENT_ERROR_MESSAGES,(0,a.t)("Error Messages")]]}};var Ne=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),Ce=n("./app/components/checkboxFancy/checkboxFancy.tsx"),Ie=n("./app/components/tooltip.tsx"),je=n("./app/views/settings/components/forms/field/index.tsx");const Oe="https://docs.sentry.io/product/data-management-settings/filtering/",De=(0,Ne.b)(class extends we{constructor(...e){super(...e),(0,d.Z)(this,"handleDeleteCondition",(e=>()=>{const t=[...this.state.conditions];t.splice(e,1),t.length?this.setState({conditions:t}):this.setState({conditions:t,transaction:oe.ALL,isTracingDisabled:!1})})),(0,d.Z)(this,"handleSubmit",(()=>{const{tracing:e,sampleRate:t,conditions:n,transaction:s}=this.state;if(!t)return;const{rule:i,errorRules:o,transactionRules:r}=this.props,a={id:0,type:e?R.TRACE:R.TRANSACTION,condition:{op:_.AND,inner:s===oe.ALL?[]:n.map(this.getNewCondition)},sampleRate:t/100},l=i?r.map((e=>v()(e,i)?a:e)):[...r,a],[d,c]=u()(l,(e=>e.type===R.TRACE)),p=[...o,...d,...c],h=p.findIndex((e=>e===a));this.submitRules(p,h)}))}componentDidUpdate(e,t){t.transaction!==this.state.transaction&&this.setIsTracingDisabled(this.state.transaction!==oe.ALL),super.componentDidUpdate(e,t)}setIsTracingDisabled(e){this.setState({isTracingDisabled:e})}getDefaultState(){const{rule:e}=this.props;if(e){const{condition:t}=e,{inner:n}=t;return{...super.getDefaultState(),tracing:e.type===R.TRACE,isTracingDisabled:!!n.length}}return{...super.getDefaultState(),tracing:!0}}getModalTitle(){const{rule:e}=this.props;return e?(0,a.t)("Edit Transaction Sampling Rule"):(0,a.t)("Add Transaction Sampling Rule")}geTransactionFieldDescription(){return{label:(0,a.t)("Transactions"),help:(0,a.t)("This determines if the rule applies to all transactions or only transactions that match custom conditions.")}}getCategoryOptions(){const{tracing:e}=this.state;return e?[[S.TRACE_RELEASE,(0,a.t)("Releases")],[S.TRACE_ENVIRONMENT,(0,a.t)("Environments")],[S.TRACE_USER_ID,(0,a.t)("User Id")],[S.TRACE_USER_SEGMENT,(0,a.t)("User Segment")]]:[[S.EVENT_RELEASE,(0,a.t)("Releases")],[S.EVENT_ENVIRONMENT,(0,a.t)("Environments")],[S.EVENT_USER_ID,(0,a.t)("User Id")],[S.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[S.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[S.EVENT_LOCALHOST,(0,a.t)("Localhost")],[S.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browsers")],[S.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[S.EVENT_IP_ADDRESSES,(0,a.t)("IP Addresses")],[S.EVENT_CSP,(0,a.t)("Content Security Policy")],[S.EVENT_ERROR_MESSAGES,(0,a.t)("Error Messages")]]}getExtraFields(){const{theme:e}=this.props,{tracing:t,isTracingDisabled:n}=this.state;return(0,H.tZ)(je.Z,{label:(0,a.t)("Tracing"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0,children:(0,H.tZ)(Ie.Z,{title:(0,a.t)("This field can only be edited if there are no match conditions"),disabled:!n,popperStyle:(0,te.iv)("@media (min-width: ",e.breakpoints[0],"){max-width:370px;}",""),children:(0,H.BX)(ke,{onClick:n?void 0:()=>this.handleChange("tracing",!t),children:[(0,H.tZ)(Le,{isChecked:t,isDisabled:n}),(0,a._N)("Include all related transactions by trace ID. This can span across multiple projects. All related errors will remain. [link:Learn more about tracing].",{link:(0,H.tZ)(E.Z,{href:Oe,onClick:e=>e.stopPropagation()})})]})})})}}),ke=(0,N.Z)("div",{target:"e1utn7k11"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,D.Z)(1),";cursor:",(e=>e.onClick?"pointer":"not-allowed"),";"),Le=(0,N.Z)(Ce.Z,{target:"e1utn7k10"})("margin-top:",(0,D.Z)(.5),";");var Ve=n("./app/styles/overflowEllipsis.tsx"),Me=n("../node_modules/react-dom/index.js"),Be=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),Pe=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function Ue({value:e,dragging:t,index:n,transform:s,listeners:i,sorting:o,transition:r,forwardRef:a,attributes:l,renderItem:d,wrapperStyle:c,innerWrapperStyle:p}){return(0,H.tZ)(Xe,{ref:a,style:{...c,transition:r,"--translate-x":s?"".concat(Math.round(s.x),"px"):void 0,"--translate-y":s?"".concat(Math.round(s.y),"px"):void 0,"--scale-x":null!=s&&s.scaleX?"".concat(s.scaleX):void 0,"--scale-y":null!=s&&s.scaleY?"".concat(s.scaleY):void 0},children:(0,H.tZ)(Ge,{style:p,children:d({dragging:Boolean(t),sorting:Boolean(o),listeners:i,transform:s,transition:r,value:e,index:n,attributes:l})})})}Ue.displayName="Item";const ze=Ue,Fe="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",We="".concat(Fe,", ").concat("0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)"),Xe=(0,N.Z)("div",{target:"e1puudz31"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",We,";--box-shadow-picked-up:",Fe,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),Ge=(0,N.Z)("div",{target:"e1puudz30"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",We,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function He({id:e,index:t,renderItem:n,disabled:s,wrapperStyle:i,innerWrapperStyle:o}){const{attributes:r,isSorting:a,isDragging:l,listeners:d,setNodeRef:c,overIndex:p,transform:u,transition:h}=(0,Pe.nB)({id:e,disabled:s});return(0,H.tZ)(ze,{forwardRef:c,value:e,sorting:a,renderItem:n,index:t,transform:u,transition:h,listeners:d,attributes:r,wrapperStyle:i({id:e,index:t,isDragging:l,isSorting:a}),innerWrapperStyle:o({id:e,index:t,isDragging:l,isSorting:a,overIndex:p,isDragOverlay:!1})})}He.displayName="SortableItem";const qe=He;class Ye extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{}),(0,d.Z)(this,"handleChangeActive",(e=>{this.setState({activeId:e})}))}render(){const{activeId:e}=this.state,{items:t,onUpdateItems:n,renderItem:s,disabled:i,wrapperStyle:o,innerWrapperStyle:r}=this.props,a=t.indexOf.bind(t),l=e?a(e):-1;return(0,H.BX)(Be.LB,{onDragStart:({active:e})=>{e&&this.handleChangeActive(e.id)},onDragEnd:({over:e})=>{if(this.handleChangeActive(void 0),e){const s=a(e.id);l!==s&&n({activeIndex:l,overIndex:s,reorderedItems:(0,Pe.Rp)(t,l,s)})}},onDragCancel:()=>this.handleChangeActive(void 0),children:[(0,H.tZ)(Pe.Fo,{items:t,strategy:Pe.qw,children:t.map(((e,t)=>(0,H.tZ)(qe,{id:e,index:t,renderItem:s,disabled:i,wrapperStyle:o,innerWrapperStyle:r},e)))}),(0,Me.createPortal)((0,H.tZ)(Be.y9,{children:e?(0,H.tZ)(ze,{value:t[l],renderItem:s,wrapperStyle:o({id:t[l],index:l,isDragging:!0,isSorting:!1}),innerWrapperStyle:r({id:t[l],index:l,isSorting:null!==e,isDragging:!0,overIndex:-1,isDragOverlay:!0})}):null}),document.body)]})}}Ye.displayName="DraggableList",(0,d.Z)(Ye,"defaultProps",{disabled:!1,wrapperStyle:()=>({}),innerWrapperStyle:()=>({})});const Ke=Ye;var Qe=n("./app/icons/iconGrabbable.tsx");const Je=e=>"\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: center;\n  }\n  @media (max-width: ".concat(e.breakpoints[0],") {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\ngrid-template-columns: 2fr 1.5fr 1fr;\n@media (min-width: ").concat(e.breakpoints[0],") {\n  grid-template-columns: 0.5fr 1.5fr 2fr 1.5fr 1fr;\n}\n@media (min-width: ").concat(e.breakpoints[2],") {\n  grid-template-columns: 0.5fr 2fr 2.5fr 2fr 1.5fr;\n}\n@media (min-width: ").concat(e.breakpoints[3],") {\n  grid-template-columns: 0.5fr 2fr 3fr 2fr 1fr;\n}\n");var $e=n("./app/components/actions/menuItemActionLink.tsx"),et=n("./app/components/confirm.tsx"),tt=n("./app/components/dropdownLink.tsx");const nt=(0,a.t)("Are you sure you wish to delete this dynamic sampling rule?"),st=(0,a.t)("You do not have permission to delete dynamic sampling rules."),it=(0,a.t)("You do not have permission to edit dynamic sampling rules.");function ot({disabled:e,onEditRule:t,onDeleteRule:n,onOpenMenuActions:s,isMenuActionsOpen:i}){return(0,H.BX)(c.Fragment,{children:[(0,H.BX)(at,{gap:1,children:[(0,H.tZ)(j.ZP,{label:(0,a.t)("Edit Rule"),size:"small",onClick:t,icon:(0,H.tZ)(M.yl,{}),disabled:e,title:e?it:void 0}),(0,H.tZ)(et.Z,{priority:"danger",message:nt,onConfirm:n,disabled:e,children:(0,H.tZ)(j.ZP,{label:(0,a.t)("Delete Rule"),size:"small",icon:(0,H.tZ)(M.Fz,{}),title:e?st:void 0})})]}),(0,H.BX)(lt,{caret:!1,customTitle:(0,H.tZ)(j.ZP,{label:(0,a.t)("Actions"),icon:(0,H.tZ)(M.YR,{size:"sm"}),size:"xsmall",onClick:s}),isOpen:i,anchorRight:!0,children:[(0,H.tZ)($e.Z,{shouldConfirm:!1,icon:(0,H.tZ)(M.Dj,{size:"xs"}),title:(0,a.t)("Edit"),onClick:e?e=>{null==e||e.stopPropagation()}:t,disabled:e,children:(0,H.tZ)(Ie.Z,{disabled:!e,title:it,containerDisplayMode:"block",children:(0,a.t)("Edit")})}),(0,H.tZ)($e.Z,{onAction:n,message:nt,icon:(0,H.tZ)(M.Dj,{size:"xs"}),title:(0,a.t)("Delete"),disabled:e,priority:"danger",shouldConfirm:!0,children:(0,H.tZ)(Ie.Z,{disabled:!e,title:st,containerDisplayMode:"block",children:(0,a.t)("Delete")})})]})]})}ot.displayName="Actions";const rt=ot,at=(0,N.Z)(O.ZP,{target:"e1a3egcn1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:grid;}"),lt=(0,N.Z)(tt.Z,{target:"e1a3egcn0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:none;}");var dt=n("../node_modules/@sentry/minimal/esm/index.js");function ct(e){switch(e){case S.TRACE_ENVIRONMENT:case S.EVENT_ENVIRONMENT:return(0,a.t)("Environment");case S.TRACE_RELEASE:case S.EVENT_RELEASE:return(0,a.t)("Release");case S.EVENT_USER_ID:case S.TRACE_USER_ID:return(0,a.t)("User Id");case S.EVENT_USER_SEGMENT:case S.TRACE_USER_SEGMENT:return(0,a.t)("User Segment");case S.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Browser Extensions");case S.EVENT_LOCALHOST:return(0,a.t)("Localhost");case S.EVENT_WEB_CRAWLERS:return(0,a.t)("Web Crawlers");case S.EVENT_LEGACY_BROWSER:return(0,a.t)("Legacy Browsers");default:return dt.Tb(new Error("Unknown dynamic sampling condition inner name")),null}}const pt=function({condition:e}){function t(e){return Array.isArray(e)?(0,H.tZ)(c.Fragment,{children:[...e].map(((t,n)=>(0,H.BX)(c.Fragment,{children:[(0,H.tZ)(mt,{children:t}),n!==e.length-1&&(0,H.tZ)(gt,{children:","})]},t)))}):(0,H.tZ)(mt,{children:String(e)})}switch(e.op){case _.AND:{const{inner:n}=e;return n.length?(0,H.tZ)(ut,{children:n.map((({value:e,name:n},s)=>(0,H.BX)("div",{children:[(0,H.tZ)(ht,{children:ct(n)}),t(e)]},s)))}):(0,H.tZ)(ht,{children:(0,a.t)("All")})}default:return dt.Tb(new Error("Unknown dynamic sampling condition operator")),null}},ut=(0,N.Z)("div",{target:"e5dv9sd3"})("display:grid;grid-gap:",(0,D.Z)(1.5),";"),ht=(0,N.Z)("span",{target:"e5dv9sd2"})("margin-right:",(0,D.Z)(1),";"),mt=(0,N.Z)("span",{target:"e5dv9sd1"})("word-break:break-all;white-space:pre-wrap;color:",(e=>e.theme.gray300),";"),gt=(0,N.Z)(mt,{target:"e5dv9sd0"})("padding-right:",(0,D.Z)(.5),";");function Et({sampleRate:e}){return(0,H.tZ)(_t,{children:"".concat(100*e,"%")})}Et.displayName="SampleRate";const Rt=Et,_t=(0,N.Z)("div",{target:"e17oa8sb0"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),yt=function({type:e}){switch(e){case R.ERROR:return(0,H.tZ)(St,{children:(0,a.t)("Errors only")});case R.TRANSACTION:return(0,H.tZ)(xt,{children:(0,a.t)("Individual transactions")});case R.TRACE:return(0,H.tZ)(xt,{children:(0,a.t)("Transaction traces")});default:return dt.Tb(new Error("Unknown dynamic sampling rule type")),null}},St=(0,N.Z)("div",{target:"enki2wy1"})("color:",(e=>e.theme.pink300),";white-space:pre-wrap;"),xt=(0,N.Z)(St,{target:"enki2wy0"})("color:",(e=>e.theme.linkColor),";");class bt extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{isMenuActionsOpen:!1}),(0,d.Z)(this,"handleChangeMenuAction",(()=>{this.setState((e=>({isMenuActionsOpen:!e.isMenuActionsOpen})))}))}componentDidMount(){this.checkMenuActionsVisibility()}componentDidUpdate(){this.checkMenuActionsVisibility()}checkMenuActionsVisibility(){const{dragging:e,sorting:t}=this.props,{isMenuActionsOpen:n}=this.state;(e||t)&&n&&this.setState({isMenuActionsOpen:!1})}render(){const{rule:e,onEditRule:t,onDeleteRule:n,disabled:s,listeners:i,grabAttributes:o}=this.props,{type:r,condition:l,sampleRate:d}=e,{isMenuActionsOpen:c}=this.state;return(0,H.BX)(ft,{children:[(0,H.tZ)(wt,{children:(0,H.tZ)(Ie.Z,{title:s?(0,a.t)("You do not have permission to reorder dynamic sampling rules."):void 0,children:(0,H.tZ)(vt,{...i,disabled:s,...o,children:(0,H.tZ)(Qe.L,{})})})}),(0,H.tZ)(Tt,{children:(0,H.tZ)(yt,{type:r})}),(0,H.tZ)(Tt,{children:(0,H.tZ)(pt,{condition:l})}),(0,H.tZ)(At,{children:(0,H.tZ)(Rt,{sampleRate:d})}),(0,H.tZ)(Tt,{children:(0,H.tZ)(rt,{onEditRule:t,onDeleteRule:n,disabled:s,onOpenMenuActions:this.handleChangeMenuAction,isMenuActionsOpen:c})})]})}}bt.displayName="Rule";const Zt=bt,ft=(0,N.Z)("div",{target:"el3sh2r4"})("display:grid;align-items:center;",(e=>Je(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}"),Tt=(0,N.Z)("div",{target:"el3sh2r3"})("display:flex;align-items:center;padding:",(0,D.Z)(2),";cursor:default;"),wt=(0,N.Z)(Tt,{target:"el3sh2r2"})({name:"m8x70k",styles:"cursor:inherit;[role='button']{cursor:grab;}"}),At=(0,N.Z)(Tt,{target:"el3sh2r1"})({name:"1gtpzmm",styles:"text-align:center;justify-content:center"}),vt=(0,N.Z)("div",{target:"el3sh2r0"})((e=>e.disabled&&"\n    color: ".concat(e.theme.disabled,";\n    cursor: not-allowed;\n  ")),";outline:none;");class Nt extends c.PureComponent{constructor(...e){super(...e),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(({activeIndex:e,overIndex:t,reorderedItems:n})=>{const{rules:s}=this.state,i=n.map((e=>s.find((t=>String(t.id)===e)))).filter((e=>!!e)),o=s[e].type,r=s[t].type;o!==R.TRACE||r!==R.TRANSACTION?o!==R.TRANSACTION||r!==R.TRACE?this.setState({rules:i}):(0,h.Iw)((0,a.t)("Individual transactions rules cannot be above transaction traces rules")):(0,h.Iw)((0,a.t)("Transaction traces rules cannot be under individual transactions rules"))}))}componentDidMount(){this.getRules()}componentDidUpdate(e){v()(e.rules,this.props.rules)?v()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,emptyMessage:s}=this.props,{rules:i}=this.state;return(0,H.tZ)(It,{headers:["",(0,a.t)("Type"),(0,a.t)("Conditions"),(0,a.t)("Rate"),""],isEmpty:!i.length,emptyMessage:s,children:(0,H.tZ)(Ke,{disabled:n,items:i.map((e=>String(e.id))),onUpdateItems:this.handleUpdateRules,wrapperStyle:({isDragging:e,isSorting:t,index:n})=>e?{cursor:"grabbing"}:t?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:i.length-n,cursor:"default"},renderItem:({value:s,listeners:o,attributes:r,dragging:a,sorting:l})=>{const d=i.find((e=>String(e.id)===s));return d?(0,H.tZ)(Zt,{rule:d,onEditRule:e(d),onDeleteRule:t(d),disabled:n,listeners:o,grabAttributes:r,dragging:a,sorting:l}):null}})})}}Nt.displayName="Rules";const Ct=Nt,It=(0,N.Z)(r.KB,{target:"e15ewxcp0"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>Je(e.theme)),">*{",Ve.Z,";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}");function jt({rules:e,onAddRule:t,onEditRule:n,onDeleteRule:s,disabled:i,onUpdateRules:o,isErrorPanel:l}){const d=l?(0,a.t)("error"):(0,a.t)("transaction");return(0,H.BX)(r.s_,{children:[(0,H.tZ)(Ct,{rules:e,onEditRule:n,onDeleteRule:s,disabled:i,onUpdateRules:o,emptyMessage:(0,a.t)("There are no %s rules to display",d)}),(0,H.tZ)(Dt,{children:(0,H.BX)(O.ZP,{gap:1,children:[(0,H.tZ)(j.ZP,{href:Oe,external:!0,children:(0,a.t)("Read the docs")}),(0,H.tZ)(j.ZP,{priority:"primary",onClick:t,disabled:i,title:i?(0,a.t)("You do not have permission to add dynamic sampling rules."):void 0,children:(0,a.t)("Add %s rule",d)})]})})]})}jt.displayName="RulesPanel";const Ot=jt,Dt=(0,N.Z)(r.jH,{target:"e1lsth6w0"})("padding:",(0,D.Z)(1)," ",(0,D.Z)(2),";display:flex;align-items:center;justify-content:flex-end;");class kt extends Z.Z{constructor(...e){super(...e),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,h.S9)(t)})),(0,d.Z)(this,"handleOpenErrorRule",(e=>()=>{const{organization:t,project:n}=this.props,{errorRules:s,transactionRules:i}=this.state;return(0,m.openModal)((o=>(0,H.tZ)(ve,{...o,api:this.api,organization:t,project:n,rule:e,errorRules:s,transactionRules:i,onSubmitSuccess:this.successfullySubmitted})),{modalCss:se})})),(0,d.Z)(this,"handleOpenTransactionRule",(e=>()=>{const{organization:t,project:n}=this.props,{errorRules:s,transactionRules:i}=this.state;return(0,m.openModal)((o=>(0,H.tZ)(De,{...o,api:this.api,organization:t,project:n,rule:e,errorRules:s,transactionRules:i,onSubmitSuccess:this.successfullySubmitted})),{modalCss:se})})),(0,d.Z)(this,"handleAddRule",(e=>()=>{"errorRules"!==e?this.handleOpenTransactionRule()():this.handleOpenErrorRule()()})),(0,d.Z)(this,"handleEditRule",(e=>()=>{e.type!==R.ERROR?this.handleOpenTransactionRule(e)():this.handleOpenErrorRule(e)()})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{errorRules:t,transactionRules:n}=this.state,s=[...e.type===R.ERROR?t.filter((t=>t.id!==e.id)):t,...e.type!==R.ERROR?n.filter((t=>t.id!==e.id)):n];this.submitRules(s,(0,a.t)("Successfully deleted dynamic sampling rule"),(0,a.t)("An error occurred while deleting dynamic sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{var t;if(!e.length)return;const{errorRules:n,transactionRules:s}=this.state;(null===(t=e[0])||void 0===t?void 0:t.type)!==R.ERROR?this.submitRules([...n,...e]):this.submitRules([...e,...s])}))}getTitle(){return(0,a.t)("Filters & Sampling")}getDefaultState(){return{...super.getDefaultState(),errorRules:[],transactionRules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails","/projects/".concat(e.slug,"/").concat(t.slug,"/")]]}componentDidMount(){this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[],[i,o]=u()(s,(e=>e.type===R.ERROR));this.setState({errorRules:i,transactionRules:o})}async submitRules(e,t,n){const{organization:s,project:i}=this.props;try{const n=await this.api.requestPromise("/projects/".concat(s.slug,"/").concat(i.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,h.Iw)(n)}}renderBody(){const{errorRules:e,transactionRules:t}=this.state,{hasAccess:n}=this.props,s=!n;return[...e,...t].some((e=>e.condition.op!==_.AND))?(0,H.tZ)(g.Z,{type:"error",children:(0,a.t)("A condition operator has been found that is not yet supported.")}):(0,H.BX)(c.Fragment,{children:[(0,H.tZ)(f.Z,{title:this.getTitle()}),(0,H.tZ)(w.Z,{}),(0,H.tZ)(T.Z,{children:(0,a._N)("Manage the inbound data you want to store. To change the sampling rate or rate limits, [link:update your SDK configuration]. The rules added below will apply on top of your SDK configuration. Any new rule may take a few minutes to propagate.",{link:(0,H.tZ)(E.Z,{href:Oe})})}),(0,H.tZ)(Ot,{rules:e,disabled:s,onAddRule:this.handleAddRule("errorRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules,isErrorPanel:!0}),(0,H.tZ)(T.Z,{children:(0,a.t)("Rules for traces should precede rules for individual transactions.")}),(0,H.tZ)(Ot,{rules:t,disabled:s,onAddRule:this.handleAddRule("transactionRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules})]})}}const Lt=(0,b.Z)(kt),Vt=({organization:e,...t})=>(0,H.tZ)(i.Z,{features:["filters-and-sampling"],organization:e,renderDisabled:()=>(0,H.tZ)(o.Z,{alert:r.aU,features:e.features,featureName:(0,a.t)("Filters & Sampling")}),children:(0,H.tZ)(s.Z,{organization:e,access:["project:write"],children:({hasAccess:n})=>(0,H.tZ)(Lt,{...t,hasAccess:n,organization:e})})});Vt.displayName="Index";const Mt=(0,l.Z)(Vt)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),i=n("../node_modules/lodash/_arrayIncludes.js"),o=n("../node_modules/lodash/_arrayIncludesWith.js"),r=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,p=i,u=!0,h=e.length,m=[],g=t.length;if(!h)return m;n&&(t=r(t,a(n))),d?(p=o,u=!1):t.length>=200&&(p=l,u=!1,t=new s(t));e:for(;++c<h;){var E=e[c],R=null==n?E:n(E);if(E=d||0!==E?E:0,u&&R==R){for(var _=g;_--;)if(t[_]===R)continue e;m.push(E)}else p(t,R,d)||m.push(E)}return m}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),i=n("../node_modules/lodash/_arrayIncludes.js"),o=n("../node_modules/lodash/_arrayIncludesWith.js"),r=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?o:i,p=e[0].length,u=e.length,h=u,m=Array(u),g=1/0,E=[];h--;){var R=e[h];h&&t&&(R=r(R,a(t))),g=d(R.length,g),m[h]=!n&&(t||p>=120&&R.length>=120)?new s(h&&R):void 0}R=e[0];var _=-1,y=m[0];e:for(;++_<p&&E.length<g;){var S=R[_],x=t?t(S):S;if(S=n||0!==S?S:0,!(y?l(y,x):c(E,x,n))){for(h=u;--h;){var b=m[h];if(!(b?l(b,x):c(e[h],x,n)))continue e}y&&y.push(x),E.push(S)}}return E}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),i=n("../node_modules/lodash/_baseFlatten.js"),o=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var r=e.length;if(r<2)return r?o(e[0]):[];for(var a=-1,l=Array(r);++a<r;)for(var d=e[a],c=-1;++c<r;)c!=a&&(l[a]=s(l[a]||d,e[c],t,n));return o(i(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),i=n("../node_modules/lodash/_baseIntersection.js"),o=n("../node_modules/lodash/_baseRest.js"),r=n("../node_modules/lodash/_castArrayLikeObject.js"),a=o((function(e){var t=s(e,r);return t.length&&t[0]===e[0]?i(t):[]}));e.exports=a},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),i=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_baseXor.js"),r=n("../node_modules/lodash/isArrayLikeObject.js"),a=i((function(e){return o(s(e,r))}));e.exports=a}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_filtersAndSampling_index_tsx.ae15b8f04b991020652e9955ade1ce91.js.map