"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_projectIssueGrouping_index_tsx"],{"./app/utils/routeTitle.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});const n=function(e,t,s=!0,n){const o="".concat(e," - ").concat(t),i=n?"".concat(o," - ").concat(n):o;return s?"".concat(i," - Sentry"):i}},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>a}),s("../node_modules/react/index.js");var n=s("../node_modules/react-document-title/index.js"),o=s.n(n),i=s("./app/components/asyncComponent.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(o(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/components/forms/formPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=s("../node_modules/react/index.js"),i=s("./app/components/panels/index.tsx"),r=s("./app/utils/sanitizeQuerySelector.tsx"),a=s("./app/views/settings/components/forms/fieldFromConfig.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class l extends o.Component{render(){const{title:e,fields:t,access:s,disabled:n,additionalFieldProps:o,renderFooter:l,renderHeader:p,...c}=this.props;return(0,d.BX)(i.s_,{id:"string"==typeof e?(0,r.m)(e):void 0,children:[e&&(0,d.tZ)(i.V9,{children:e}),(0,d.BX)(i.N,{children:["function"==typeof p&&p({title:e,fields:t}),t.map((e=>{if("function"==typeof e)return e();const{defaultValue:t,...i}=e;return!0===n&&(i.disabled=!0,i.disabledReason=void 0),(0,d.tZ)(a.Z,{access:s,disabled:n,...c,...o,field:i,highlighted:this.props.highlighted==="#".concat(e.name)},e.name)})),"function"==typeof l&&l({title:e,fields:t})]})]})}}l.displayName="FormPanel",(0,n.Z)(l,"defaultProps",{additionalFieldProps:{}})},"./app/views/settings/components/forms/jsonForm.tsx":(e,t,s)=>{s.d(t,{Z:()=>m});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/@sentry/minimal/esm/index.js"),a=s("../node_modules/scroll-to-element/index.js"),d=s.n(a),l=s("./app/utils.tsx"),p=s("./app/utils/sanitizeQuerySelector.tsx"),c=s("./app/views/settings/components/forms/formPanel.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends o.Component{constructor(...e){var t;super(...e),(0,n.Z)(this,"state",{highlighted:null===(t=this.props.location)||void 0===t?void 0:t.hash})}componentDidMount(){this.scrollToHash()}UNSAFE_componentWillReceiveProps(e){if(this.props.location.hash!==e.location.hash){const t=e.location.hash;this.scrollToHash(t),this.setState({highlighted:t})}}scrollToHash(e){var t;const s=e||(null===(t=this.props.location)||void 0===t?void 0:t.hash);if(s)try{d()((0,p.m)(decodeURIComponent(s)),{align:"middle",offset:-100})}catch(e){r.Tb(e)}}shouldDisplayForm(e){const t=e.filter((e=>"function"!=typeof e&&(0,l.ri)(null==e?void 0:e.visible)));if(e.length===t.length){const{additionalFieldProps:e,...s}=this.props;return!t.every((t=>"function"==typeof t.visible?!t.visible({...s,...e}):!t.visible))}return!0}renderForm({fields:e,formPanelProps:t,title:s}){return this.shouldDisplayForm(e)||null!=t&&t.renderFooter||null!=t&&t.renderHeader?(0,u.tZ)(c.Z,{title:s,fields:e,...t}):null}render(){const{access:e,fields:t,title:s,forms:n,disabled:i,features:r,additionalFieldProps:a,renderFooter:d,renderHeader:l,location:p,...c}=this.props,g={access:e,disabled:i,features:r,additionalFieldProps:a,renderFooter:d,renderHeader:l,highlighted:this.state.highlighted};return(0,u.BX)("div",{...c,children:[void 0!==n&&n.map(((e,t)=>(0,u.tZ)(o.Fragment,{children:this.renderForm({formPanelProps:g,...e})},t))),void 0===n&&void 0!==t&&this.renderForm({fields:t,formPanelProps:g,title:s})]})}}g.displayName="JsonForm";const m=(0,i.withRouter)(g)},"./app/views/settings/projectIssueGrouping/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),i=s("./app/actions/projectActions.tsx"),r=s("./app/components/acl/feature.tsx"),a=s("./app/components/links/externalLink.tsx"),d=s("./app/data/forms/projectIssueGrouping.tsx"),l=s("./app/locale.tsx"),p=s("./app/utils/routeTitle.tsx"),c=s("./app/views/asyncView.tsx"),u=s("./app/views/settings/components/forms/form.tsx"),g=s("./app/views/settings/components/forms/jsonForm.tsx"),m=s("./app/views/settings/components/settingsPageHeader.tsx"),h=s("./app/views/settings/components/text/textBlock.tsx"),f=s("./app/actionCreators/indicator.tsx"),x=s("./app/components/alert.tsx"),Z=s("./app/components/button.tsx"),v=s("./app/components/confirm.tsx"),y=s("./app/components/panels/index.tsx"),j=s("./app/utils/handleXhrErrorResponse.tsx"),b=s("./app/utils/marked.tsx"),w=s("./app/views/settings/components/forms/field/index.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function C({groupingConfigs:e,organization:t,projectId:s,project:n,onUpgrade:r,api:a}){const d=t.access.includes("project:write"),{updateNotes:p,riskLevel:c,latestGroupingConfig:u}=function(e,t){const s={};let n="",o=0,i=null;if(t.forEach((t=>{s[t.id]=t,t.latest&&e.groupingConfig!==t.id&&(n=t.changelog,i=t,o=t.risk)})),i){var r;let t=null!==(r=i.base)&&void 0!==r?r:"";for(;t!==e.groupingConfig;){var a;const e=s[t];if(!e)break;o=Math.max(o,e.risk),n=e.changelog+"\n"+n,t=null!==(a=e.base)&&void 0!==a?a:""}}return{updateNotes:n,riskLevel:o,latestGroupingConfig:i}}(n,e),{riskNote:g,alertType:m}=function(e){switch(e){case 0:return{riskNote:(0,l.t)("This upgrade has the chance to create some new issues."),alertType:"info"};case 1:return{riskNote:(0,l.t)("This upgrade will create some new issues."),alertType:"warning"};case 2:return{riskNote:(0,_.tZ)("strong",{children:(0,l.t)("The new grouping strategy is incompatible with the current and will create entirely new issues.")}),alertType:"error"};default:return{riskNote:void 0,alertType:void 0}}}(c),C=!u,F={};if(u){const e=Math.floor((new Date).getTime()/1e3),t=7776e3;F.groupingConfig=u.id,F.secondaryGroupingConfig=n.groupingConfig,F.secondaryGroupingExpiry=e+t}return e?(0,_.BX)(y.s_,{id:"upgrade-grouping",children:[(0,_.tZ)(y.V9,{children:(0,l.t)("Upgrade Grouping")}),(0,_.tZ)(y.N,{children:(0,_.tZ)(w.Z,{label:(0,l.t)("Upgrade Grouping Strategy"),help:(0,l._N)("If the project uses an old grouping strategy an update is possible.[linebreak]Doing so will cause new events to group differently.",{linebreak:(0,_.tZ)("br",{})}),disabled:!0,children:(0,_.tZ)(v.Z,{disabled:C,onConfirm:async()=>{(0,f.E3)((0,l.t)("Changing groupingâ€¦"));try{const e=await a.requestPromise("/projects/".concat(t.slug,"/").concat(s,"/"),{method:"PUT",data:F});(0,f.B8)(),i.Z.updateSuccess(e),r()}catch{(0,j.Z)((0,l.t)("Unable to upgrade config"))}},priority:c>=2?"danger":"primary",confirmText:(0,l.t)("Upgrade"),message:(0,_.BX)(o.Fragment,{children:[(0,_.tZ)(h.Z,{children:(0,_.tZ)("strong",{children:(0,l.t)("Upgrade Grouping Strategy")})}),(0,_.tZ)(h.Z,{children:(0,l.t)("You can upgrade the grouping strategy to the latest but this is an irreversible operation.")}),(0,_.BX)(h.Z,{children:[(0,_.tZ)("strong",{children:(0,l.t)("New Behavior")}),(0,_.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,b.Z)(p)}})]}),(0,_.tZ)(h.Z,{children:(0,_.tZ)(x.Z,{type:m,children:g})})]}),children:(0,_.tZ)("div",{children:(0,_.tZ)(Z.ZP,{disabled:!d||C,title:d?C?(0,l.t)("You are already on the latest version"):void 0:(0,l.t)("You do not have sufficient permissions to do this"),type:"button",priority:c>=2?"danger":"primary",children:(0,l.t)("Upgrade Grouping Strategy")})})})})})]}):null}C.displayName="UpgradeGrouping";const F=C;class P extends c.Z{constructor(...e){super(...e),(0,n.Z)(this,"handleSubmit",(e=>{i.Z.updateSuccess(e)}))}getTitle(){const{projectId:e}=this.props.params;return(0,p.Z)((0,l.t)("Issue Grouping"),e,!1)}getDefaultState(){return{...super.getDefaultState(),groupingConfigs:[]}}getEndpoints(){const{projectId:e,orgId:t}=this.props.params;return[["groupingConfigs","/projects/".concat(t,"/").concat(e,"/grouping-configs/")]]}renderBody(){const{groupingConfigs:e}=this.state,{organization:t,project:s,params:n}=this.props,{orgId:i,projectId:p}=n,c="/projects/".concat(i,"/").concat(p,"/"),f=new Set(t.access),x={additionalFieldProps:{organization:t,groupingConfigs:e},features:new Set(t.features),access:f,disabled:!f.has("project:write")};return(0,_.BX)(o.Fragment,{children:[(0,_.tZ)(m.Z,{title:(0,l.t)("Issue Grouping")}),(0,_.tZ)(h.Z,{children:(0,l._N)("All events have a fingerprint. Events with the same fingerprint are grouped together into an issue. To learn more about issue grouping, [link: read the docs].",{link:(0,_.tZ)(a.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/"})})}),(0,_.BX)(u.Z,{saveOnBlur:!0,allowUndo:!0,initialData:s,apiMethod:"PUT",apiEndpoint:c,onSubmitSuccess:this.handleSubmit,children:[(0,_.tZ)(g.Z,{...x,title:(0,l.t)("Fingerprint Rules"),fields:[d.fields.fingerprintingRules]}),(0,_.tZ)(g.Z,{...x,title:(0,l.t)("Stack Trace Rules"),fields:[d.fields.groupingEnhancements]}),(0,_.tZ)(r.Z,{features:["set-grouping-config"],organization:t,children:(0,_.tZ)(g.Z,{...x,title:(0,l.t)("Change defaults"),fields:[d.fields.groupingConfig,d.fields.secondaryGroupingConfig,d.fields.secondaryGroupingExpiry]})}),(0,_.tZ)(F,{groupingConfigs:null!=e?e:[],organization:t,projectId:n.projectId,project:s,api:this.api,onUpgrade:this.fetchData})]})]})}}const T=P}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectIssueGrouping_index_tsx.6f0deb66d301c3b5acc1f0e839a165ec.js.map